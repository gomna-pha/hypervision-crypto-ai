<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOMNA | Professional Arbitrage Trading Platform</title>
    <style>
        :root {
            --cream-primary: #FFF8E7;
            --cream-secondary: #FAF0DC;
            --cream-tertiary: #F5E6D3;
            --cream-light: #FFFEF9;
            --brown-accent: rgba(139, 90, 43, 0.2);
            --brown-light: rgba(139, 90, 43, 0.1);
            --brown-text: #5D4E37;
            --brown-dark: #3E2E1F;
            --success: #2D5F3F;
            --danger: #8B4513;
            --warning: #D2691E;
            --info: #4682B4;
            --purple: #6B46C1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--cream-primary) 0%, var(--cream-secondary) 50%, var(--cream-tertiary) 100%);
            color: var(--brown-dark);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: rgba(255, 248, 231, 0.98);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--brown-accent);
            padding: 0.75rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(139, 90, 43, 0.05);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1920px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--brown-dark), var(--brown-text));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-tabs {
            display: flex;
            gap: 0.25rem;
            background: var(--cream-light);
            padding: 0.4rem;
            border-radius: 10px;
            margin: 0 1rem;
        }

        .nav-tab {
            padding: 0.5rem 1rem;
            background: transparent;
            border: none;
            color: var(--brown-text);
            cursor: pointer;
            border-radius: 8px;
            font-weight: 500;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .nav-tab:hover {
            background: rgba(139, 90, 43, 0.05);
        }

        .nav-tab.active {
            background: var(--brown-dark);
            color: var(--cream-primary);
        }

        /* Main Container */
        .main-container {
            max-width: 1920px;
            margin: 0 auto;
            padding: 1rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }

        .span-2 { grid-column: span 2; }
        .span-3 { grid-column: span 3; }
        .span-4 { grid-column: span 4; }

        /* Cards */
        .card {
            background: rgba(255, 248, 231, 0.95);
            border: 1px solid var(--brown-accent);
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(139, 90, 43, 0.05);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--brown-light);
        }

        .card-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--brown-dark);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge {
            padding: 0.2rem 0.4rem;
            background: var(--success);
            color: white;
            border-radius: 4px;
            font-size: 0.6rem;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Live indicator */
        .live-dot {
            width: 6px;
            height: 6px;
            background: var(--success);
            border-radius: 50%;
            display: inline-block;
            animation: pulse 2s infinite;
            margin-right: 0.25rem;
        }

        /* Market Items */
        .market-item {
            padding: 0.75rem;
            background: var(--cream-light);
            border-radius: 6px;
            margin-bottom: 0.5rem;
        }

        .market-symbol {
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .market-price {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 0.25rem;
        }

        /* Algorithm Box */
        .algo-box {
            background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary));
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .algo-title {
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--brown-dark);
        }

        /* Model Performance Grid */
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin: 0.75rem 0;
        }

        .performance-item {
            text-align: center;
            padding: 0.75rem;
            background: var(--cream-light);
            border-radius: 6px;
        }

        .performance-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--brown-dark);
        }

        .performance-label {
            font-size: 0.65rem;
            color: var(--brown-text);
            margin-top: 0.25rem;
        }

        /* Feature Importance */
        .feature-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: var(--cream-light);
            border-radius: 4px;
            margin-bottom: 0.25rem;
        }

        .feature-bar {
            height: 6px;
            background: var(--cream-tertiary);
            border-radius: 3px;
            overflow: hidden;
            flex: 1;
            margin: 0 0.5rem;
        }

        .feature-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--warning));
            border-radius: 3px;
        }

        /* Portfolio Allocation */
        .allocation-item {
            margin-bottom: 0.75rem;
        }

        .allocation-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.25rem;
        }

        .allocation-percentage {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--brown-dark);
        }

        .allocation-label {
            font-weight: 600;
            font-size: 0.85rem;
        }

        .allocation-value {
            font-size: 0.85rem;
            color: var(--brown-text);
        }

        .allocation-bar {
            height: 8px;
            background: var(--cream-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }

        .allocation-fill {
            height: 100%;
            border-radius: 4px;
        }

        /* Portfolio Table */
        .portfolio-table {
            width: 100%;
            font-size: 0.75rem;
        }

        .portfolio-table th {
            padding: 0.5rem;
            text-align: left;
            background: var(--cream-secondary);
            font-weight: 600;
            border-bottom: 1px solid var(--brown-accent);
        }

        .portfolio-table td {
            padding: 0.4rem 0.5rem;
            border-bottom: 1px solid var(--brown-light);
        }

        /* Market Index Grid */
        .market-index-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
        }

        .index-card {
            background: var(--cream-light);
            padding: 0.75rem;
            border-radius: 6px;
        }

        .index-name {
            font-weight: 600;
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
        }

        .index-value {
            font-size: 1rem;
            font-weight: 700;
            color: var(--brown-dark);
        }

        .index-change {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }

        .positive { color: var(--success); }
        .negative { color: var(--danger); }

        /* Transaction Item */
        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: var(--cream-light);
            border-radius: 4px;
            margin-bottom: 0.5rem;
            font-size: 0.75rem;
        }

        .transaction-details {
            flex: 1;
        }

        .transaction-type {
            font-weight: 600;
            margin-bottom: 0.1rem;
        }

        .transaction-info {
            color: var(--brown-text);
        }

        .transaction-profit {
            font-weight: 700;
            color: var(--success);
        }

        .transaction-time {
            font-size: 0.65rem;
            color: var(--brown-text);
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .dashboard-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            .span-4 {
                grid-column: span 3;
            }
        }

        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .span-3, .span-4 {
                grid-column: span 2;
            }
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            .span-2, .span-3, .span-4 {
                grid-column: span 1;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div style="display: flex; align-items: center;">
                <div class="logo">GOMNA</div>
                <div class="nav-tabs">
                    <button class="nav-tab active" onclick="switchTab('dashboard')">Dashboard</button>
                    <button class="nav-tab" onclick="switchTab('portfolio')">Portfolio</button>
                    <button class="nav-tab" onclick="switchTab('markets')">Global Markets</button>
                    <button class="nav-tab" onclick="switchTab('ai-assistant')">ü§ñ AI Assistant</button>
                    <button class="nav-tab" onclick="switchTab('backtesting')">üìä Backtesting</button>
                    <button class="nav-tab" onclick="switchTab('paper')">üìù Paper Trading</button>
                    <button class="nav-tab" onclick="switchTab('transparency')">Model Transparency</button>
                    <button class="nav-tab" onclick="switchTab('investor')">üè¶ Investor Portal</button>
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="text-align: right;">
                    <div style="font-size: 0.75rem; color: var(--brown-text);">Portfolio Value</div>
                    <div style="font-size: 1.2rem; font-weight: 700;" id="portfolio-value">$2,847,563</div>
                </div>
                <div style="padding: 0.3rem 0.6rem; background: rgba(45, 95, 63, 0.1); border-radius: 12px;">
                    <span class="live-dot"></span>
                    <span style="font-size: 0.75rem; font-weight: 600; color: var(--success);">LIVE</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Enhanced Dashboard Tab with HyperVision Integration -->
        <div class="tab-content active" id="dashboard-tab">
            <div class="dashboard-grid">
                <!-- Live Hyperbolic Arbitrage Monitor -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üéØ HyperVision Arbitrage Engine</h3>
                        <span class="badge" style="background: linear-gradient(135deg, #667eea, #764ba2);">HYPERBOLIC AI</span>
                    </div>
                    
                    <!-- Poincar√© Disk Visualization -->
                    <div style="height: 200px; background: radial-gradient(circle at center, rgba(103, 126, 234, 0.1), transparent); border-radius: 8px; display: flex; align-items: center; justify-content: center; position: relative; margin-bottom: 1rem;">
                        <canvas id="mini-poincare" width="180" height="180" style="border-radius: 50%;"></canvas>
                        <div style="position: absolute; bottom: 10px; right: 10px; font-size: 0.65rem; color: var(--purple);">
                            Curvature: -1.0 | Dim: 64
                        </div>
                    </div>
                    
                    <!-- Live Opportunities -->
                    <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem;">Active Opportunities</h4>
                    <div id="live-opportunities" style="max-height: 200px; overflow-y: auto;">
                        <!-- Opportunities will be populated here -->
                    </div>
                    
                    <!-- Execution Stats -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-top: 1rem;">
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; text-align: center;">
                            <div style="font-size: 0.65rem; color: var(--brown-text);">Success Rate</div>
                            <div style="font-weight: 700; color: var(--success);" id="dash-success-rate">0%</div>
                        </div>
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; text-align: center;">
                            <div style="font-size: 0.65rem; color: var(--brown-text);">Avg Latency</div>
                            <div style="font-weight: 700; color: var(--purple);" id="dash-latency">0ms</div>
                        </div>
                    </div>
                </div>
                
                <!-- Real-Time Market Data -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üìà Live Market Data</h3>
                        <span class="live-dot"></span>
                        <span style="font-size: 0.7rem;">REAL-TIME</span>
                    </div>
                    
                    <!-- Market Prices Grid -->
                    <div style="display: grid; gap: 0.5rem;">
                        <div class="market-item">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div class="market-symbol">BTC/USD</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Bitcoin</div>
                                </div>
                                <div style="text-align: right;">
                                    <div class="market-price" id="btc-price">$0</div>
                                    <div style="font-size: 0.7rem; color: var(--success);" id="btc-change">+0%</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="market-item">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div class="market-symbol">ETH/USD</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Ethereum</div>
                                </div>
                                <div style="text-align: right;">
                                    <div class="market-price" id="eth-price">$0</div>
                                    <div style="font-size: 0.7rem; color: var(--success);" id="eth-change">+0%</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="market-item">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div class="market-symbol">SOL/USD</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Solana</div>
                                </div>
                                <div style="text-align: right;">
                                    <div class="market-price" id="sol-price">$0</div>
                                    <div style="font-size: 0.7rem; color: var(--success);" id="sol-change">+0%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Exchange Spreads -->
                    <h4 style="font-size: 0.85rem; margin: 1rem 0 0.5rem;">Exchange Spreads</h4>
                    <div style="display: grid; gap: 0.5rem;">
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span style="font-size: 0.75rem;">Binance - Coinbase</span>
                            <strong style="color: var(--success); font-size: 0.75rem;" id="spread-1">0.12%</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span style="font-size: 0.75rem;">Kraken - FTX</span>
                            <strong style="color: var(--warning); font-size: 0.75rem;" id="spread-2">0.08%</strong>
                        </div>
                    </div>
                </div>
                
                <!-- Platform Performance -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">‚ö° Platform Performance</h3>
                        <button style="padding: 0.3rem 0.6rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer;" onclick="window.location.href='hypervision_dashboard.html'">
                            Full Dashboard ‚Üí
                        </button>
                    </div>
                    
                    <!-- Performance Metrics -->
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);" id="total-profit-dash">$0</div>
                            <div style="font-size: 0.65rem; color: var(--brown-text);">Total Profit</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--purple);" id="opportunities-detected">0</div>
                            <div style="font-size: 0.65rem; color: var(--brown-text);">Opportunities</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700;" id="trades-executed">0</div>
                            <div style="font-size: 0.65rem; color: var(--brown-text);">Trades</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--warning);" id="active-algos">7</div>
                            <div style="font-size: 0.65rem; color: var(--brown-text);">Active Algos</div>
                        </div>
                    </div>
                    
                    <!-- Live Activity Feed -->
                    <h4 style="font-size: 0.85rem; margin-bottom: 0.5rem;">Live Activity</h4>
                    <div id="activity-feed" style="max-height: 150px; overflow-y: auto; font-size: 0.75rem;">
                        <!-- Activity items will be populated here -->
                    </div>
                    
                    <!-- Risk Indicators -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; margin-top: 1rem;">
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; text-align: center;">
                            <div style="font-size: 0.65rem; color: var(--brown-text);">VaR (95%)</div>
                            <div style="font-weight: 600; color: var(--success);" id="var-value">$12,450</div>
                        </div>
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; text-align: center;">
                            <div style="font-size: 0.65rem; color: var(--brown-text);">Sharpe</div>
                            <div style="font-weight: 600;" id="sharpe-value">2.34</div>
                        </div>
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; text-align: center;">
                            <div style="font-size: 0.65rem; color: var(--brown-text);">Risk Score</div>
                            <div style="font-weight: 600; color: var(--success);" id="risk-level">LOW</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Portfolio Tab -->
        <div class="tab-content" id="portfolio-tab">
            <div class="dashboard-grid">
                <!-- Portfolio Overview -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üìä Portfolio Overview</h3>
                        <span class="badge">REAL-TIME</span>
                    </div>
                    <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, rgba(45, 95, 63, 0.05), rgba(139, 90, 43, 0.05)); border-radius: 8px; margin-bottom: 1rem;">
                        <div style="font-size: 0.8rem; color: var(--brown-text);">Total Portfolio Value</div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--brown-dark);" id="total-value">$2,847,392</div>
                        <div style="font-size: 0.9rem; color: var(--success); font-weight: 600;">+12.4% MTD</div>
                    </div>
                    
                    <!-- Portfolio Holdings -->
                    <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--brown-dark);">Portfolio Overview</h4>
                    
                    <!-- BTC Holdings -->
                    <div class="allocation-item" style="margin-bottom: 1rem; padding: 0.75rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #F7931A;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 32px; height: 32px; border-radius: 50%; background: #F7931A; display: flex; align-items: center; justify-content: center;">
                                    <span style="color: white; font-weight: 700; font-size: 0.9rem;">‚Çø</span>
                                </div>
                                <span style="font-weight: 700; font-size: 1.1rem; color: var(--brown-dark);">BTC</span>
                            </div>
                            <span style="padding: 0.25rem 0.5rem; background: rgba(45, 95, 63, 0.1); border-radius: 4px; font-size: 0.8rem; color: var(--success); font-weight: 600;">+2.4%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--brown-dark); margin-bottom: 0.25rem;">$1,245,320</div>
                                <div style="font-size: 0.85rem; color: var(--brown-text); font-weight: 500;">12.5 BTC</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ETH Holdings -->
                    <div class="allocation-item" style="margin-bottom: 1rem; padding: 0.75rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #627EEA;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 32px; height: 32px; border-radius: 50%; background: #627EEA; display: flex; align-items: center; justify-content: center;">
                                    <span style="color: white; font-weight: 700; font-size: 0.9rem;">Œû</span>
                                </div>
                                <span style="font-weight: 700; font-size: 1.1rem; color: var(--brown-dark);">ETH</span>
                            </div>
                            <span style="padding: 0.25rem 0.5rem; background: rgba(45, 95, 63, 0.1); border-radius: 4px; font-size: 0.8rem; color: var(--success); font-weight: 600;">+1.8%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--brown-dark); margin-bottom: 0.25rem;">$892,450</div>
                                <div style="font-size: 0.85rem; color: var(--brown-text); font-weight: 500;">258.3 ETH</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- USDT Holdings -->
                    <div class="allocation-item" style="margin-bottom: 1rem; padding: 0.75rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #26A17B;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 32px; height: 32px; border-radius: 50%; background: #26A17B; display: flex; align-items: center; justify-content: center;">
                                    <span style="color: white; font-weight: 700; font-size: 0.8rem;">‚ÇÆ</span>
                                </div>
                                <span style="font-weight: 700; font-size: 1.1rem; color: var(--brown-dark);">USDT</span>
                            </div>
                            <span style="padding: 0.25rem 0.5rem; background: rgba(139, 90, 43, 0.1); border-radius: 4px; font-size: 0.8rem; color: var(--brown-text); font-weight: 600;">0.0%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--brown-dark); margin-bottom: 0.25rem;">$450,000</div>
                                <div style="font-size: 0.85rem; color: var(--brown-text); font-weight: 500;">450,000 USDT</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SOL Holdings -->
                    <div class="allocation-item" style="margin-bottom: 1rem; padding: 0.75rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #9945FF;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <div style="width: 32px; height: 32px; border-radius: 50%; background: #9945FF; display: flex; align-items: center; justify-content: center;">
                                    <span style="color: white; font-weight: 700; font-size: 0.8rem;">‚óé</span>
                                </div>
                                <span style="font-weight: 700; font-size: 1.1rem; color: var(--brown-dark);">SOL</span>
                            </div>
                            <span style="padding: 0.25rem 0.5rem; background: rgba(139, 69, 19, 0.1); border-radius: 4px; font-size: 0.8rem; color: var(--danger); font-weight: 600;">-0.8%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--brown-dark); margin-bottom: 0.25rem;">$259,622</div>
                                <div style="font-size: 0.85rem; color: var(--brown-text); font-weight: 500;">3,850 SOL</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Allocation Summary -->
                    <div style="margin-top: 1.5rem; padding: 1rem; background: linear-gradient(135deg, rgba(103, 126, 234, 0.05), rgba(118, 75, 162, 0.05)); border-radius: 8px;">
                        <h5 style="font-size: 0.9rem; font-weight: 600; color: var(--brown-dark); margin-bottom: 0.75rem;">Allocation Breakdown</h5>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--brown-text);">BTC:</span>
                                <span style="font-weight: 600; color: var(--brown-dark);">43.7%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--brown-text);">ETH:</span>
                                <span style="font-weight: 600; color: var(--brown-dark);">31.3%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--brown-text);">USDT:</span>
                                <span style="font-weight: 600; color: var(--brown-dark);">15.8%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--brown-text);">SOL:</span>
                                <span style="font-weight: 600; color: var(--brown-dark);">9.1%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Active Positions -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">Active Positions</h3>
                    </div>
                    <table class="portfolio-table">
                        <thead>
                            <tr>
                                <th>Asset</th>
                                <th>Quantity</th>
                                <th>Avg Price</th>
                                <th>Current Price</th>
                                <th>P&L</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>BTC/USD</strong></td>
                                <td>19.065 BTC</td>
                                <td>$65,420</td>
                                <td id="btc-current">$67,234</td>
                                <td style="color: var(--success); font-weight: 600;">+$34,562 (+2.8%)</td>
                            </tr>
                            <tr>
                                <td><strong>ETH/USD</strong></td>
                                <td>247.2 ETH</td>
                                <td>$3,380</td>
                                <td id="eth-current">$3,456</td>
                                <td style="color: var(--success); font-weight: 600;">+$18,787 (+2.2%)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Risk Metrics -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üìä Risk Metrics</h3>
                        <span class="badge" style="background: var(--info);">LIVE</span>
                    </div>
                    <div style="display: grid; gap: 1rem;">
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; border-left: 3px solid var(--danger);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">VaR (95%)</div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">1-Day Risk</div>
                            </div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--danger);">$142,350</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; border-left: 3px solid var(--success);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Sharpe Ratio</div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Risk-Adjusted</div>
                            </div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--success);">2.98</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; border-left: 3px solid var(--warning);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Max Drawdown</div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Peak to Trough</div>
                            </div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--warning);">-8.2%</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; border-left: 3px solid var(--info);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Beta</div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">vs Market</div>
                            </div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--info);">0.72</div>
                        </div>
                    </div>
                </div>
                
                <!-- P&L Summary -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üí∞ P&L Summary</h3>
                        <span class="badge" style="background: var(--success);">PROFITABLE</span>
                    </div>
                    <div style="display: grid; gap: 1rem;">
                        <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(45, 95, 63, 0.05), rgba(45, 95, 63, 0.1)); border-radius: 6px; border-left: 3px solid var(--success);">
                            <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Today</div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--success);">+$34,901</div>
                            <div style="font-size: 0.7rem; color: var(--success); margin-top: 0.25rem;">+1.23% daily return</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(45, 95, 63, 0.05), rgba(45, 95, 63, 0.1)); border-radius: 6px; border-left: 3px solid var(--success);">
                            <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">This Week</div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--success);">+$127,340</div>
                            <div style="font-size: 0.7rem; color: var(--success); margin-top: 0.25rem;">+4.68% weekly return</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(45, 95, 63, 0.05), rgba(45, 95, 63, 0.1)); border-radius: 6px; border-left: 3px solid var(--success);">
                            <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">This Month</div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--success);">+$485,220</div>
                            <div style="font-size: 0.7rem; color: var(--success); margin-top: 0.25rem;">+20.5% monthly return</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(45, 95, 63, 0.05), rgba(45, 95, 63, 0.1)); border-radius: 6px; border-left: 3px solid var(--success);">
                            <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">YTD</div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: var(--success);">+$1,847,392</div>
                            <div style="font-size: 0.7rem; color: var(--success); margin-top: 0.25rem;">+184.7% annual return</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="card span-3">
                    <div class="card-header">
                        <h3 class="card-title">Recent Transactions</h3>
                        <span class="badge">LIVE</span>
                    </div>
                    <div id="recent-transactions">
                        <div class="transaction-item">
                            <div class="transaction-details">
                                <div class="transaction-type">Cross-Exchange Arb</div>
                                <div class="transaction-info">BTC 2.5 executed</div>
                            </div>
                            <div class="transaction-profit">+$127</div>
                            <div class="transaction-time">2 min ago</div>
                        </div>
                        <div class="transaction-item">
                            <div class="transaction-details">
                                <div class="transaction-type">Statistical Pairs</div>
                                <div class="transaction-info">ETH/BTC pair</div>
                            </div>
                            <div class="transaction-profit">+$203</div>
                            <div class="transaction-time">8 min ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Global Markets Tab -->
        <div class="tab-content" id="markets-tab">
            <div class="dashboard-grid">
                <!-- Crypto Markets -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">üåç Global Market Indices</h3>
                        <span style="font-size: 0.7rem;">Last Update: <span id="market-time">8:12:31 AM</span></span>
                    </div>
                    
                    <!-- Cryptocurrency -->
                    <h4 style="margin: 1rem 0 0.5rem; color: var(--brown-dark);">üíé Cryptocurrency</h4>
                    <div class="market-index-grid">
                        <div class="index-card">
                            <div class="index-name">Bitcoin (BTC)</div>
                            <div class="index-value" id="btc-index">$67,234</div>
                            <div class="index-change positive">24h Change: +2.34%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">Ethereum (ETH)</div>
                            <div class="index-value" id="eth-index">$3,456</div>
                            <div class="index-change positive">24h Change: +1.87%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">Solana (SOL)</div>
                            <div class="index-value" id="sol-index">$123</div>
                            <div class="index-change positive">24h Change: +4.56%</div>
                        </div>
                    </div>

                    <!-- US Equity -->
                    <h4 style="margin: 1rem 0 0.5rem; color: var(--brown-dark);">üá∫üá∏ US Equity</h4>
                    <div class="market-index-grid">
                        <div class="index-card">
                            <div class="index-name">S&P 500</div>
                            <div class="index-value">5,234.56</div>
                            <div class="index-change positive">24h Change: +0.45%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">NASDAQ</div>
                            <div class="index-value">18,234</div>
                            <div class="index-change negative">24h Change: -0.23%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">Dow Jones</div>
                            <div class="index-value">42,156</div>
                            <div class="index-change positive">24h Change: +0.67%</div>
                        </div>
                    </div>

                    <!-- International -->
                    <h4 style="margin: 1rem 0 0.5rem; color: var(--brown-dark);">üåç International</h4>
                    <div class="market-index-grid">
                        <div class="index-card">
                            <div class="index-name">FTSE 100 üá¨üáß</div>
                            <div class="index-value">8,234</div>
                            <div class="index-change positive">24h Change: +0.34%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">Nikkei 225 üáØüáµ</div>
                            <div class="index-value">38,234</div>
                            <div class="index-change negative">24h Change: -0.45%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">DAX 40 üá©üá™</div>
                            <div class="index-value">19,234</div>
                            <div class="index-change positive">24h Change: +0.89%</div>
                        </div>
                    </div>

                    <!-- Commodities -->
                    <h4 style="margin: 1rem 0 0.5rem; color: var(--brown-dark);">üèÜ Commodities</h4>
                    <div class="market-index-grid">
                        <div class="index-card">
                            <div class="index-name">Gold (XAU/USD)</div>
                            <div class="index-value">$2,034</div>
                            <div class="index-change positive">24h Change: +0.23%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">Silver (XAG/USD)</div>
                            <div class="index-value">$24.56</div>
                            <div class="index-change positive">24h Change: +0.89%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">Oil WTI</div>
                            <div class="index-value">$78.34</div>
                            <div class="index-change negative">24h Change: -1.45%</div>
                        </div>
                    </div>

                    <!-- Major Forex -->
                    <h4 style="margin: 1rem 0 0.5rem; color: var(--brown-dark);">üí± Major Forex</h4>
                    <div class="market-index-grid">
                        <div class="index-card">
                            <div class="index-name">EUR/USD</div>
                            <div class="index-value">1.0856</div>
                            <div class="index-change positive">24h Change: +0.12%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">GBP/USD</div>
                            <div class="index-value">1.2634</div>
                            <div class="index-change negative">24h Change: -0.08%</div>
                        </div>
                        <div class="index-card">
                            <div class="index-name">USD/JPY</div>
                            <div class="index-value">149.23</div>
                            <div class="index-change positive">24h Change: +0.34%</div>
                        </div>
                    </div>
                </div>
                
                <!-- Cross-Exchange Monitoring -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">üîÑ Live Cross-Exchange Monitoring</h3>
                        <span class="badge" style="background: var(--success);">REAL-TIME</span>
                    </div>
                    
                    <div id="exchange-monitoring" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem;">
                        <!-- Exchange cards will be populated by JavaScript -->
                    </div>
                </div>
                
                <!-- Live Arbitrage Opportunities -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">‚ö° Live Arbitrage Opportunities</h3>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span class="live-dot"></span>
                            <span style="font-size: 0.75rem; color: var(--success);">SCANNING</span>
                        </div>
                    </div>
                    
                    <div id="markets-arbitrage-opportunities" style="max-height: 300px; overflow-y: auto;">
                        <!-- Arbitrage opportunities will be populated by JavaScript -->
                    </div>
                    
                    <div style="margin-top: 1rem; padding: 0.75rem; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 8px;">
                        <div style="font-weight: 600; color: var(--purple); margin-bottom: 0.5rem;">üéØ Auto-Arbitrage Engine Status</div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 0.75rem; color: var(--brown-text);">Scanning 12 exchanges ‚Ä¢ Update frequency: 3 seconds</div>
                                <div style="font-size: 0.75rem; color: var(--success);">‚úì All exchange APIs connected</div>
                            </div>
                            <button onclick="toggleAutoArbitrage()" id="auto-arb-toggle" 
                                style="padding: 0.5rem 1rem; background: var(--success); color: white; border: none; border-radius: 4px; font-size: 0.75rem; cursor: pointer;">
                                Enable Auto-Execute
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Model Transparency Tab -->
        <div class="tab-content" id="transparency-tab">
            <div class="dashboard-grid">
                <!-- Model Architecture -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üî¨ Algorithm Transparency</h3>
                    </div>
                    
                    <div class="algo-box">
                        <div class="algo-title">Model Architecture</div>
                        <div style="margin-bottom: 1rem;">
                            <h5 style="color: var(--purple); margin-bottom: 0.5rem;">Hyperbolic Neural Network</h5>
                            <div style="font-size: 0.75rem; line-height: 1.5;">
                                ‚Ä¢ Poincar√© Ball Model (Curvature: -1.0)<br>
                                ‚Ä¢ Embedding Dimension: 768<br>
                                ‚Ä¢ Geodesic Distance Optimization<br>
                                ‚Ä¢ M√∂bius Transformations
                            </div>
                        </div>
                        
                        <h5 style="margin-bottom: 0.5rem; color: var(--brown-dark);">Ensemble Components</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.75rem;">
                            <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                                <div style="font-weight: 600;">Hyperbolic CNN:</div>
                                <div style="color: var(--success);">40% weight</div>
                            </div>
                            <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                                <div style="font-weight: 600;">LSTM-Transformer:</div>
                                <div style="color: var(--info);">25% weight</div>
                            </div>
                            <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                                <div style="font-weight: 600;">FinBERT Sentiment:</div>
                                <div style="color: var(--warning);">20% weight</div>
                            </div>
                            <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                                <div style="font-weight: 600;">Classical Arbitrage:</div>
                                <div>15% weight</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Model Performance -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">Live Model Performance</h3>
                        <span class="badge">REAL-TIME</span>
                    </div>
                    <div class="performance-grid">
                        <div class="performance-item">
                            <div class="performance-value">91.2%</div>
                            <div class="performance-label">Model Accuracy</div>
                        </div>
                        <div class="performance-item">
                            <div class="performance-value">0.968</div>
                            <div class="performance-label">AUC-ROC Score</div>
                        </div>
                        <div class="performance-item">
                            <div class="performance-value">89.7%</div>
                            <div class="performance-label">Precision</div>
                        </div>
                        <div class="performance-item">
                            <div class="performance-value">92.8%</div>
                            <div class="performance-label">Recall</div>
                        </div>
                    </div>
                </div>

                <!-- Feature Importance -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">Feature Importance</h3>
                    </div>
                    <div class="feature-item">
                        <span style="font-weight: 600;">Price Momentum</span>
                        <div class="feature-bar">
                            <div class="feature-fill" style="width: 31%;"></div>
                        </div>
                        <span style="font-weight: 700;">0.31</span>
                    </div>
                    <div class="feature-item">
                        <span style="font-weight: 600;">Volume Profile</span>
                        <div class="feature-bar">
                            <div class="feature-fill" style="width: 24%;"></div>
                        </div>
                        <span style="font-weight: 700;">0.24</span>
                    </div>
                    <div class="feature-item">
                        <span style="font-weight: 600;">Cross-Exchange Spreads</span>
                        <div class="feature-bar">
                            <div class="feature-fill" style="width: 19%;"></div>
                        </div>
                        <span style="font-weight: 700;">0.19</span>
                    </div>
                    <div class="feature-item">
                        <span style="font-weight: 600;">Sentiment Score</span>
                        <div class="feature-bar">
                            <div class="feature-fill" style="width: 15%;"></div>
                        </div>
                        <span style="font-weight: 700;">0.15</span>
                    </div>
                </div>

                <!-- Risk Management -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">Risk Management</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <h5 style="margin-bottom: 0.5rem; color: var(--brown-dark);">Position Limits</h5>
                            <div style="font-size: 0.75rem; line-height: 1.6;">
                                ‚Ä¢ Max position size: 5% of portfolio<br>
                                ‚Ä¢ Daily loss limit: 2% of capital<br>
                                ‚Ä¢ Leverage limit: 3:1
                            </div>
                        </div>
                        <div>
                            <h5 style="margin-bottom: 0.5rem; color: var(--brown-dark);">Execution Controls</h5>
                            <div style="font-size: 0.75rem; line-height: 1.6;">
                                ‚Ä¢ Slippage protection: 0.1%<br>
                                ‚Ä¢ Timeout: 60 seconds<br>
                                ‚Ä¢ Min confidence: 85%
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Interactive Hyperbolic Visualization -->
                <div class="card span-3">
                    <div class="card-header">
                        <h3 class="card-title">üåê Interactive Poincar√© Disk Model</h3>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span class="live-dot"></span>
                            <span style="font-size: 0.75rem; color: var(--purple);">LIVE</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem;">
                        <!-- Poincar√© Canvas -->
                        <div style="flex: 1;">
                            <canvas id="poincare-canvas" width="400" height="400" 
                                style="width: 100%; max-width: 400px; border: 1px solid var(--brown-light); border-radius: 8px; background: radial-gradient(circle at center, rgba(103, 126, 234, 0.05), transparent);"></canvas>
                            
                            <div style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--brown-text); text-align: center;">
                                Hyperbolic Space Representation (Curvature: -1.0)
                            </div>
                        </div>
                        
                        <!-- Controls and Legend -->
                        <div style="flex: 0 0 200px;">
                            <h5 style="margin-bottom: 0.5rem; color: var(--brown-dark);">Asset Positions</h5>
                            <div id="asset-legend" style="font-size: 0.75rem; margin-bottom: 1rem;">
                                <!-- Legend will be populated by JavaScript -->
                            </div>
                            
                            <h5 style="margin-bottom: 0.5rem; color: var(--brown-dark);">Controls</h5>
                            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                <button onclick="rotatePoincare()" 
                                    style="padding: 0.4rem 0.8rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-size: 0.75rem; cursor: pointer;">
                                    Rotate View
                                </button>
                                <button onclick="resetPoincare()" 
                                    style="padding: 0.4rem 0.8rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.75rem; cursor: pointer;">
                                    Reset Position
                                </button>
                                <button onclick="showArbitrageConnections()" 
                                    style="padding: 0.4rem 0.8rem; background: var(--success); color: white; border: none; border-radius: 4px; font-size: 0.75rem; cursor: pointer;">
                                    Show Connections
                                </button>
                            </div>
                            
                            <div style="margin-top: 1rem; padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                                <div style="font-weight: 600; font-size: 0.75rem; margin-bottom: 0.5rem;">Hyperbolic Metrics</div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">
                                    ‚Ä¢ Embedding Dimension: 768<br>
                                    ‚Ä¢ Active Assets: <span id="active-assets">8</span><br>
                                    ‚Ä¢ Geodesic Paths: <span id="geodesic-paths">12</span><br>
                                    ‚Ä¢ Curvature: -1.0
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Algorithm Explanation -->
                <div class="card span-3">
                    <div class="card-header">
                        <h3 class="card-title">üß† Algorithm Deep Dive</h3>
                        <button onclick="toggleAlgorithmDetails()" id="algo-toggle"
                            style="padding: 0.3rem 0.6rem; background: var(--info); color: white; border: none; border-radius: 4px; font-size: 0.75rem; cursor: pointer;">
                            Show Details
                        </button>
                    </div>
                    
                    <div id="algorithm-details" style="display: none;">
                        <div style="background: var(--cream-light); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                            <h5 style="color: var(--purple); margin-bottom: 0.75rem;">üåê Hyperbolic Geometry Foundation</h5>
                            <div style="font-size: 0.85rem; line-height: 1.6; color: var(--brown-text);">
                                Our system uses the <strong>Poincar√© disk model</strong> to embed financial assets in hyperbolic space. 
                                Unlike Euclidean space, hyperbolic geometry allows for exponential growth of space, making it ideal 
                                for modeling complex financial relationships where small price movements can lead to large arbitrage opportunities.
                            </div>
                        </div>
                        
                        <div style="background: var(--cream-light); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                            <h5 style="color: var(--success); margin-bottom: 0.75rem;">‚ö° Arbitrage Detection Process</h5>
                            <div style="font-size: 0.85rem; line-height: 1.6; color: var(--brown-text);">
                                <strong>1. Asset Embedding:</strong> Each asset is positioned in hyperbolic space based on price, volume, and volatility.<br>
                                <strong>2. Geodesic Calculation:</strong> We compute shortest paths between assets using hyperbolic metrics.<br>
                                <strong>3. Opportunity Scoring:</strong> Paths with high curvature indicate potential arbitrage opportunities.<br>
                                <strong>4. Risk Assessment:</strong> Distance from the disk center represents risk level.
                            </div>
                        </div>
                        
                        <div style="background: var(--cream-light); padding: 1rem; border-radius: 8px;">
                            <h5 style="color: var(--warning); margin-bottom: 0.75rem;">üî¨ Mathematical Framework</h5>
                            <div style="font-size: 0.85rem; line-height: 1.6; color: var(--brown-text);">
                                <strong>Poincar√© Metric:</strong> ds¬≤ = 4(dx¬≤ + dy¬≤)/(1 - x¬≤ - y¬≤)¬≤<br>
                                <strong>M√∂bius Transformations:</strong> Used for rotation and scaling operations<br>
                                <strong>Geodesic Distance:</strong> d(z‚ÇÅ, z‚ÇÇ) = arcosh(1 + 2|z‚ÇÅ - z‚ÇÇ|¬≤/((1 - |z‚ÇÅ|¬≤)(1 - |z‚ÇÇ|¬≤)))
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1rem; padding: 0.75rem; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 8px;">
                        <div style="font-weight: 600; color: var(--purple); margin-bottom: 0.5rem;">üéØ Real-Time Performance</div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; font-size: 0.75rem;">
                            <div>
                                <div style="color: var(--brown-text);">Processing Speed</div>
                                <div style="font-weight: 600; color: var(--success);">2.3ms/calc</div>
                            </div>
                            <div>
                                <div style="color: var(--brown-text);">Accuracy Rate</div>
                                <div style="font-weight: 600; color: var(--success);">94.7%</div>
                            </div>
                            <div>
                                <div style="color: var(--brown-text);">Active Models</div>
                                <div style="font-weight: 600; color: var(--info);">4 Ensemble</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Investor Portal Tab -->
        <div class="tab-content" id="investor-tab">
            <div class="dashboard-grid">
                <!-- Enhanced Account Overview -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üè¶ Institutional Account Management</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <span class="badge" style="background: var(--success);">KYC/AML VERIFIED</span>
                            <span class="badge" style="background: var(--info);">SEC COMPLIANT</span>
                        </div>
                    </div>
                    
                    <!-- Account Details -->
                    <div style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary)); border-radius: 8px; margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Account ID</div>
                                <div style="font-weight: 700;">INV-2847563</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Account Type</div>
                                <div style="font-weight: 700; color: var(--purple);">Premium</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Member Since</div>
                                <div style="font-weight: 600;">January 2024</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Verification Status</div>
                                <div style="font-weight: 600; color: var(--success);">‚úì KYC Complete</div>
                            </div>
                        </div>
                        
                        <div style="border-top: 1px solid var(--brown-light); padding-top: 1rem;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Total Account Balance</div>
                            <div style="font-size: 1.8rem; font-weight: 700; color: var(--brown-dark);">$2,847,563</div>
                            <div style="font-size: 0.8rem; color: var(--success);">+$342,891 (+13.7%) YTD</div>
                        </div>
                    </div>
                    
                    <!-- Account Features & Benefits -->
                    <h4 style="font-size: 0.85rem; margin-bottom: 0.5rem; color: var(--brown-dark);">Account Features</h4>
                    <div style="display: grid; gap: 0.5rem; font-size: 0.75rem; margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Daily Withdrawal Limit</span>
                            <strong>$500,000</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Monthly Withdrawal Limit</span>
                            <strong>$5,000,000</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Trading Volume (30d)</span>
                            <strong>$18,234,567</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Fee Tier</span>
                            <strong style="color: var(--purple);">VIP 3 (0.08%)</strong>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                        <button style="padding: 0.5rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.75rem; cursor: pointer;"
                                onclick="alert('Opening account upgrade options...')">
                            Upgrade Account
                        </button>
                        <button style="padding: 0.5rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-size: 0.75rem; cursor: pointer;"
                                onclick="alert('Opening account statements...')">
                            View Statements
                        </button>
                    </div>
                </div>
                
                <!-- Enhanced Deposits & Withdrawals -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üí∞ Deposits & Withdrawals</h3>
                        <span style="font-size: 0.65rem; color: var(--success);">Instant Processing</span>
                    </div>
                    
                    <!-- Balance Summary -->
                    <div style="padding: 0.75rem; background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary)); border-radius: 6px; margin-bottom: 1rem;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; text-align: center;">
                            <div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">Available</div>
                                <div style="font-weight: 700; color: var(--success);">$1,847,563</div>
                            </div>
                            <div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">In Orders</div>
                                <div style="font-weight: 700;">$750,000</div>
                            </div>
                            <div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">Pending</div>
                                <div style="font-weight: 700; color: var(--warning);">$250,000</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                        <button style="padding: 0.75rem; background: linear-gradient(135deg, var(--success), #2D7F4F); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: transform 0.2s;" 
                                onmouseover="this.style.transform='scale(1.02)'" 
                                onmouseout="this.style.transform='scale(1)'"
                                onclick="alert('Opening deposit modal with multiple payment options...')">
                            + New Deposit
                        </button>
                        <button style="padding: 0.75rem; background: linear-gradient(135deg, var(--info), #5692C4); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: transform 0.2s;"
                                onmouseover="this.style.transform='scale(1.02)'" 
                                onmouseout="this.style.transform='scale(1)'"
                                onclick="alert('Opening withdrawal form with security verification...')">
                            ‚Üë Withdraw Funds
                        </button>
                    </div>
                    
                    <!-- Recent Transactions -->
                    <h4 style="font-size: 0.85rem; margin-bottom: 0.5rem; color: var(--brown-dark);">Recent Transactions</h4>
                    <div style="max-height: 300px; overflow-y: auto;">
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; margin-bottom: 0.5rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <div style="font-weight: 600; color: var(--success);">‚Üì Deposit</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Wire Transfer - Bank of America</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 700;">+$250,000</div>
                                    <div style="font-size: 0.65rem; color: var(--brown-text);">Sep 25, 2025</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; margin-bottom: 0.5rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <div style="font-weight: 600; color: var(--info);">‚Üë Withdrawal</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">ACH Transfer - Chase</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 700;">-$75,000</div>
                                    <div style="font-size: 0.65rem; color: var(--brown-text);">Sep 20, 2025</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; margin-bottom: 0.5rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <div style="font-weight: 600; color: var(--success);">‚Üì Deposit</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Crypto Transfer - BTC</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 700;">+$134,250</div>
                                    <div style="font-size: 0.65rem; color: var(--brown-text);">Sep 15, 2025</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; margin-bottom: 0.5rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <div style="font-weight: 600; color: var(--success);">üí∏ Trading Profit</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Automated Arbitrage</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 700; color: var(--success);">+$12,847</div>
                                    <div style="font-size: 0.65rem; color: var(--brown-text);">Sep 10, 2025</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Payment Methods -->
                    <h4 style="font-size: 0.85rem; margin: 1rem 0 0.5rem; color: var(--brown-dark);">Linked Payment Methods</h4>
                    <div style="display: grid; gap: 0.5rem;">
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center;">
                                <span style="margin-right: 0.5rem;">üè¶</span>
                                <div>
                                    <div style="font-weight: 600; font-size: 0.8rem;">Bank of America ****1234</div>
                                    <div style="font-size: 0.65rem; color: var(--brown-text);">Primary Account</div>
                                </div>
                            </div>
                            <span style="color: var(--success); font-size: 0.7rem;">‚úì Verified</span>
                        </div>
                        
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center;">
                                <span style="margin-right: 0.5rem;">üí≥</span>
                                <div>
                                    <div style="font-weight: 600; font-size: 0.8rem;">Visa ****5678</div>
                                    <div style="font-size: 0.65rem; color: var(--brown-text);">Backup Card</div>
                                </div>
                            </div>
                            <span style="color: var(--success); font-size: 0.7rem;">‚úì Verified</span>
                        </div>
                    </div>
                </div>
                
                <!-- Enhanced Reports & Analytics -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üìä Reports & Analytics</h3>
                        <button style="padding: 0.2rem 0.4rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-size: 0.65rem; cursor: pointer;">
                            Generate Custom Report
                        </button>
                    </div>
                    
                    <!-- Performance Metrics Grid -->
                    <div style="padding: 1rem; background: linear-gradient(135deg, rgba(45, 95, 63, 0.05), rgba(139, 90, 43, 0.05)); border-radius: 8px; margin-bottom: 1rem;">
                        <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--brown-dark);">Performance Metrics</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Total Return</div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--success);">+47.3%</div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">Since inception</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Annual Return</div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--success);">+18.7%</div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">Average</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Sharpe Ratio</div>
                                <div style="font-size: 1.3rem; font-weight: 700;">2.34</div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">Risk-adjusted</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Win Rate</div>
                                <div style="font-size: 1.3rem; font-weight: 700; color: var(--success);">87.5%</div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">Last 30 days</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Available Reports -->
                    <h4 style="font-size: 0.85rem; margin-bottom: 0.5rem; color: var(--brown-dark);">Available Reports</h4>
                    <div style="display: grid; gap: 0.5rem;">
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; cursor: pointer; transition: background 0.2s;"
                             onmouseover="this.style.background='var(--cream-secondary)'" 
                             onmouseout="this.style.background='var(--cream-light)'">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; font-size: 0.85rem;">Monthly Statement</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">September 2025</div>
                                </div>
                                <button style="padding: 0.3rem 0.6rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer;">
                                    Download PDF
                                </button>
                            </div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; cursor: pointer; transition: background 0.2s;"
                             onmouseover="this.style.background='var(--cream-secondary)'" 
                             onmouseout="this.style.background='var(--cream-light)'">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; font-size: 0.85rem;">Tax Report</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Form 1099 - 2024</div>
                                </div>
                                <button style="padding: 0.3rem 0.6rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer;">
                                    Download PDF
                                </button>
                            </div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; cursor: pointer; transition: background 0.2s;"
                             onmouseover="this.style.background='var(--cream-secondary)'" 
                             onmouseout="this.style.background='var(--cream-light)'">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; font-size: 0.85rem;">Trade History</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Last 90 days</div>
                                </div>
                                <button style="padding: 0.3rem 0.6rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer;">
                                    Export CSV
                                </button>
                            </div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; cursor: pointer; transition: background 0.2s;"
                             onmouseover="this.style.background='var(--cream-secondary)'" 
                             onmouseout="this.style.background='var(--cream-light)'">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; font-size: 0.85rem;">Performance Analytics</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Detailed metrics</div>
                                </div>
                                <button style="padding: 0.3rem 0.6rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer;">
                                    View Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Account Settings -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">‚öôÔ∏è Account Settings</h3>
                    </div>
                    
                    <!-- Security Settings -->
                    <h4 style="font-size: 0.85rem; margin-bottom: 0.5rem; color: var(--brown-dark);">Security Settings</h4>
                    <div style="display: grid; gap: 0.5rem; margin-bottom: 1rem;">
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; font-size: 0.8rem;">Two-Factor Authentication</div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">Enhanced security</div>
                            </div>
                            <div style="padding: 0.2rem 0.4rem; background: var(--success); color: white; border-radius: 4px; font-size: 0.65rem;">
                                Enabled
                            </div>
                        </div>
                        
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; font-size: 0.8rem;">Withdrawal Whitelist</div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">3 addresses saved</div>
                            </div>
                            <button style="padding: 0.2rem 0.4rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.65rem; cursor: pointer;">
                                Manage
                            </button>
                        </div>
                        
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; font-size: 0.8rem;">API Keys</div>
                                <div style="font-size: 0.65rem; color: var(--brown-text);">2 active keys</div>
                            </div>
                            <button style="padding: 0.2rem 0.4rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.65rem; cursor: pointer;">
                                Manage
                            </button>
                        </div>
                    </div>
                    
                    <!-- Notification Preferences -->
                    <h4 style="font-size: 0.85rem; margin-bottom: 0.5rem; color: var(--brown-dark);">Notification Preferences</h4>
                    <div style="display: grid; gap: 0.5rem;">
                        <label style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" checked style="margin-right: 0.5rem;">
                            <span style="font-size: 0.8rem;">Email notifications for trades</span>
                        </label>
                        
                        <label style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" checked style="margin-right: 0.5rem;">
                            <span style="font-size: 0.8rem;">SMS alerts for withdrawals</span>
                        </label>
                        
                        <label style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" style="margin-right: 0.5rem;">
                            <span style="font-size: 0.8rem;">Weekly performance reports</span>
                        </label>
                    </div>
                </div>
                
                <!-- Support & Help -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">üí¨ Support & Help</h3>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem;">
                        <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px; text-align: center; cursor: pointer; transition: transform 0.2s;"
                             onmouseover="this.style.transform='scale(1.05)'" 
                             onmouseout="this.style.transform='scale(1)'">
                            <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üìû</div>
                            <div style="font-weight: 600; font-size: 0.85rem;">24/7 Support</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">1-800-GOMNA-AI</div>
                        </div>
                        
                        <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px; text-align: center; cursor: pointer; transition: transform 0.2s;"
                             onmouseover="this.style.transform='scale(1.05)'" 
                             onmouseout="this.style.transform='scale(1)'">
                            <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üí¨</div>
                            <div style="font-weight: 600; font-size: 0.85rem;">Live Chat</div>
                            <div style="font-size: 0.7rem; color: var(--success);">‚óè Online Now</div>
                        </div>
                        
                        <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px; text-align: center; cursor: pointer; transition: transform 0.2s;"
                             onmouseover="this.style.transform='scale(1.05)'" 
                             onmouseout="this.style.transform='scale(1)'">
                            <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üìö</div>
                            <div style="font-weight: 600; font-size: 0.85rem;">Documentation</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">User Guide</div>
                        </div>
                        
                        <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px; text-align: center; cursor: pointer; transition: transform 0.2s;"
                             onmouseover="this.style.transform='scale(1.05)'" 
                             onmouseout="this.style.transform='scale(1)'">
                            <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üìß</div>
                            <div style="font-weight: 600; font-size: 0.85rem;">Email Support</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">support@gomna.ai</div>
                        </div>
                    </div>
                </div>
                
                <!-- Advanced Portfolio Management -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">üìà Advanced Portfolio Management</h3>
                        <span class="badge">AI-POWERED</span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                        <!-- Asset Allocation -->
                        <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px;">
                            <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--brown-dark);">Asset Allocation</h4>
                            <div style="margin-bottom: 0.5rem;">
                                <div style="display: flex; justify-content: space-between; font-size: 0.75rem; margin-bottom: 0.25rem;">
                                    <span>Cryptocurrencies</span>
                                    <strong>45%</strong>
                                </div>
                                <div style="height: 6px; background: var(--cream-tertiary); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 45%; height: 100%; background: linear-gradient(90deg, var(--purple), var(--info));"></div>
                                </div>
                            </div>
                            <div style="margin-bottom: 0.5rem;">
                                <div style="display: flex; justify-content: space-between; font-size: 0.75rem; margin-bottom: 0.25rem;">
                                    <span>Commodities</span>
                                    <strong>30%</strong>
                                </div>
                                <div style="height: 6px; background: var(--cream-tertiary); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 30%; height: 100%; background: linear-gradient(90deg, var(--success), #2D7F4F);"></div>
                                </div>
                            </div>
                            <div style="margin-bottom: 0.5rem;">
                                <div style="display: flex; justify-content: space-between; font-size: 0.75rem; margin-bottom: 0.25rem;">
                                    <span>Forex</span>
                                    <strong>15%</strong>
                                </div>
                                <div style="height: 6px; background: var(--cream-tertiary); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 15%; height: 100%; background: linear-gradient(90deg, var(--warning), #E2791E);"></div>
                                </div>
                            </div>
                            <div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.75rem; margin-bottom: 0.25rem;">
                                    <span>Cash Reserve</span>
                                    <strong>10%</strong>
                                </div>
                                <div style="height: 6px; background: var(--cream-tertiary); border-radius: 3px; overflow: hidden;">
                                    <div style="width: 10%; height: 100%; background: var(--brown-text);"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Risk Management -->
                        <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px;">
                            <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--brown-dark);">Risk Management</h4>
                            <div style="display: grid; gap: 0.75rem; font-size: 0.75rem;">
                                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-secondary); border-radius: 4px;">
                                    <span>Risk Score</span>
                                    <strong style="color: var(--success);">Low (3/10)</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-secondary); border-radius: 4px;">
                                    <span>Max Drawdown</span>
                                    <strong>-8.2%</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-secondary); border-radius: 4px;">
                                    <span>Value at Risk</span>
                                    <strong>$142,378</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-secondary); border-radius: 4px;">
                                    <span>Stop Loss Active</span>
                                    <strong style="color: var(--success);">‚úì Enabled</strong>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Account Activity -->
                        <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px;">
                            <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--brown-dark);">Recent Activity</h4>
                            <div style="max-height: 150px; overflow-y: auto;">
                                <div style="font-size: 0.7rem; padding: 0.5rem 0; border-bottom: 1px solid var(--cream-tertiary);">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span style="color: var(--success);">‚úì Login</span>
                                        <span style="color: var(--brown-text);">2 min ago</span>
                                    </div>
                                </div>
                                <div style="font-size: 0.7rem; padding: 0.5rem 0; border-bottom: 1px solid var(--cream-tertiary);">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Algorithm Started</span>
                                        <span style="color: var(--brown-text);">15 min ago</span>
                                    </div>
                                </div>
                                <div style="font-size: 0.7rem; padding: 0.5rem 0; border-bottom: 1px solid var(--cream-tertiary);">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Report Generated</span>
                                        <span style="color: var(--brown-text);">1 hour ago</span>
                                    </div>
                                </div>
                                <div style="font-size: 0.7rem; padding: 0.5rem 0; border-bottom: 1px solid var(--cream-tertiary);">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>Settings Updated</span>
                                        <span style="color: var(--brown-text);">3 hours ago</span>
                                    </div>
                                </div>
                                <div style="font-size: 0.7rem; padding: 0.5rem 0;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span>2FA Verified</span>
                                        <span style="color: var(--brown-text);">Yesterday</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Transaction Management -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">üí∏ Transaction Management & History</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <button style="padding: 0.2rem 0.4rem; background: var(--success); color: white; border: none; border-radius: 4px; font-size: 0.65rem; cursor: pointer;">
                                Export All
                            </button>
                            <button style="padding: 0.2rem 0.4rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-size: 0.65rem; cursor: pointer;">
                                Filter
                            </button>
                        </div>
                    </div>
                    
                    <!-- Transaction Filters -->
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
                        <select style="padding: 0.4rem; background: var(--cream-light); border: 1px solid var(--brown-accent); border-radius: 4px; font-size: 0.75rem;">
                            <option>All Types</option>
                            <option>Deposits</option>
                            <option>Withdrawals</option>
                            <option>Trades</option>
                            <option>Fees</option>
                        </select>
                        <select style="padding: 0.4rem; background: var(--cream-light); border: 1px solid var(--brown-accent); border-radius: 4px; font-size: 0.75rem;">
                            <option>Last 7 Days</option>
                            <option>Last 30 Days</option>
                            <option>Last 90 Days</option>
                            <option>This Year</option>
                            <option>All Time</option>
                        </select>
                        <input type="text" placeholder="Search transactions..." style="flex: 1; padding: 0.4rem; background: var(--cream-light); border: 1px solid var(--brown-accent); border-radius: 4px; font-size: 0.75rem;">
                    </div>
                    
                    <!-- Transaction Table -->
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; font-size: 0.75rem; border-collapse: collapse;">
                            <thead>
                                <tr style="background: var(--cream-secondary);">
                                    <th style="padding: 0.5rem; text-align: left; font-weight: 600;">Date</th>
                                    <th style="padding: 0.5rem; text-align: left; font-weight: 600;">Type</th>
                                    <th style="padding: 0.5rem; text-align: left; font-weight: 600;">Description</th>
                                    <th style="padding: 0.5rem; text-align: right; font-weight: 600;">Amount</th>
                                    <th style="padding: 0.5rem; text-align: center; font-weight: 600;">Status</th>
                                    <th style="padding: 0.5rem; text-align: center; font-weight: 600;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border-bottom: 1px solid var(--cream-tertiary);">
                                    <td style="padding: 0.5rem;">Sep 27, 2025</td>
                                    <td style="padding: 0.5rem;"><span style="color: var(--success);">‚Üì Deposit</span></td>
                                    <td style="padding: 0.5rem;">Wire Transfer - Bank of America</td>
                                    <td style="padding: 0.5rem; text-align: right; font-weight: 600; color: var(--success);">+$250,000</td>
                                    <td style="padding: 0.5rem; text-align: center;"><span style="padding: 0.2rem 0.4rem; background: var(--success); color: white; border-radius: 4px; font-size: 0.6rem;">Completed</span></td>
                                    <td style="padding: 0.5rem; text-align: center;">
                                        <button style="padding: 0.2rem 0.4rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.6rem; cursor: pointer;">View</button>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--cream-tertiary);">
                                    <td style="padding: 0.5rem;">Sep 26, 2025</td>
                                    <td style="padding: 0.5rem;"><span style="color: var(--purple);">‚ö° Trade</span></td>
                                    <td style="padding: 0.5rem;">Arbitrage - BTC/USDT</td>
                                    <td style="padding: 0.5rem; text-align: right; font-weight: 600; color: var(--success);">+$3,847</td>
                                    <td style="padding: 0.5rem; text-align: center;"><span style="padding: 0.2rem 0.4rem; background: var(--success); color: white; border-radius: 4px; font-size: 0.6rem;">Completed</span></td>
                                    <td style="padding: 0.5rem; text-align: center;">
                                        <button style="padding: 0.2rem 0.4rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.6rem; cursor: pointer;">Details</button>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--cream-tertiary);">
                                    <td style="padding: 0.5rem;">Sep 25, 2025</td>
                                    <td style="padding: 0.5rem;"><span style="color: var(--info);">‚Üë Withdrawal</span></td>
                                    <td style="padding: 0.5rem;">ACH Transfer - Chase</td>
                                    <td style="padding: 0.5rem; text-align: right; font-weight: 600; color: var(--danger);">-$75,000</td>
                                    <td style="padding: 0.5rem; text-align: center;"><span style="padding: 0.2rem 0.4rem; background: var(--warning); color: white; border-radius: 4px; font-size: 0.6rem;">Processing</span></td>
                                    <td style="padding: 0.5rem; text-align: center;">
                                        <button style="padding: 0.2rem 0.4rem; background: var(--danger); color: white; border: none; border-radius: 4px; font-size: 0.6rem; cursor: pointer;">Cancel</button>
                                    </td>
                                </tr>
                                <tr style="border-bottom: 1px solid var(--cream-tertiary);">
                                    <td style="padding: 0.5rem;">Sep 24, 2025</td>
                                    <td style="padding: 0.5rem;"><span style="color: var(--purple);">‚ö° Trade</span></td>
                                    <td style="padding: 0.5rem;">Arbitrage - ETH/BTC</td>
                                    <td style="padding: 0.5rem; text-align: right; font-weight: 600; color: var(--success);">+$1,234</td>
                                    <td style="padding: 0.5rem; text-align: center;"><span style="padding: 0.2rem 0.4rem; background: var(--success); color: white; border-radius: 4px; font-size: 0.6rem;">Completed</span></td>
                                    <td style="padding: 0.5rem; text-align: center;">
                                        <button style="padding: 0.2rem 0.4rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.6rem; cursor: pointer;">View</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 1rem; font-size: 0.75rem;">
                        <span>Showing 1-4 of 327 transactions</span>
                        <div style="display: flex; gap: 0.25rem;">
                            <button style="padding: 0.3rem 0.5rem; background: var(--cream-light); border: 1px solid var(--brown-accent); border-radius: 4px; cursor: pointer;">Previous</button>
                            <button style="padding: 0.3rem 0.5rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px;">1</button>
                            <button style="padding: 0.3rem 0.5rem; background: var(--cream-light); border: 1px solid var(--brown-accent); border-radius: 4px; cursor: pointer;">2</button>
                            <button style="padding: 0.3rem 0.5rem; background: var(--cream-light); border: 1px solid var(--brown-accent); border-radius: 4px; cursor: pointer;">3</button>
                            <button style="padding: 0.3rem 0.5rem; background: var(--cream-light); border: 1px solid var(--brown-accent); border-radius: 4px; cursor: pointer;">Next</button>
                        </div>
                    </div>
                </div>
                
                <!-- Investment Intelligence LLM Query System -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">üß† Investment Intelligence Query System</h3>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span class="live-dot"></span>
                            <span class="badge" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;">AI POWERED</span>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 300px; gap: 1rem; height: 500px;">
                        <!-- Query Interface -->
                        <div style="display: flex; flex-direction: column;">
                            <div style="background: var(--cream-light); padding: 0.75rem; border-radius: 8px; margin-bottom: 1rem;">
                                <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.5rem;">üí° Investment Query Assistant</div>
                                <div style="font-size: 0.85rem; color: var(--brown-text);">
                                    Ask me anything about market conditions, arbitrage strategies, portfolio optimization, or risk management. 
                                    I have access to live market data, your portfolio performance, and advanced trading algorithms.
                                </div>
                            </div>
                            
                            <!-- Chat Messages for Investor Portal -->
                            <div id="investor-chat-messages" style="flex: 1; overflow-y: auto; padding: 1rem; background: white; border: 1px solid var(--brown-light); border-radius: 8px; margin-bottom: 1rem; font-size: 0.85rem;">
                                <div class="ai-message" style="margin-bottom: 1rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                        <div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">AI</div>
                                        <span style="font-weight: 600; color: var(--purple);">Investment AI</span>
                                        <span style="font-size: 0.7rem; color: var(--brown-text);">Just now</span>
                                    </div>
                                    <div style="background: var(--cream-light); padding: 0.75rem; border-radius: 8px; border-left: 3px solid var(--purple);">
                                        Welcome to the Investment Intelligence System! I can help you with:
                                        <br><br>
                                        ‚Ä¢ üìä <strong>Portfolio Analysis:</strong> Real-time performance review and optimization suggestions
                                        <br>‚Ä¢ üéØ <strong>Arbitrage Strategies:</strong> Live opportunity identification and execution planning
                                        <br>‚Ä¢ üìà <strong>Market Intelligence:</strong> Cross-market analysis and trend identification
                                        <br>‚Ä¢ üõ°Ô∏è <strong>Risk Management:</strong> Exposure analysis and hedging recommendations
                                        <br>‚Ä¢ üí∞ <strong>Investment Planning:</strong> Strategic allocation and rebalancing advice
                                        <br><br>
                                        What investment decision would you like to explore?
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Investment Query Input -->
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="text" id="investor-chat-input" placeholder="Ask about investment strategies, market opportunities, or portfolio optimization..." 
                                    style="flex: 1; padding: 0.75rem; border: 1px solid var(--brown-light); border-radius: 8px; background: white; font-size: 0.85rem;"
                                    onkeypress="if(event.key==='Enter') sendInvestorMessage()">
                                <button onclick="sendInvestorMessage()" 
                                    style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s;">
                                    Query AI
                                </button>
                            </div>
                        </div>
                        
                        <!-- Investment Quick Actions -->
                        <div>
                            <h4 style="font-size: 0.9rem; margin-bottom: 0.75rem; color: var(--brown-dark);">üöÄ Quick Investment Queries</h4>
                            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                <button onclick="quickInvestorQuery('portfolio_performance')" 
                                    style="padding: 0.75rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 6px; cursor: pointer; text-align: left; transition: all 0.2s;">
                                    <div style="font-weight: 600; color: var(--brown-dark); font-size: 0.8rem;">üìä Analyze Portfolio Performance</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Deep dive into current positions</div>
                                </button>
                                
                                <button onclick="quickInvestorQuery('best_arbitrage')" 
                                    style="padding: 0.75rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 6px; cursor: pointer; text-align: left; transition: all 0.2s;">
                                    <div style="font-weight: 600; color: var(--brown-dark); font-size: 0.8rem;">üéØ Best Arbitrage Opportunities</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Highest profit potential trades</div>
                                </button>
                                
                                <button onclick="quickInvestorQuery('risk_assessment')" 
                                    style="padding: 0.75rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 6px; cursor: pointer; text-align: left; transition: all 0.2s;">
                                    <div style="font-weight: 600; color: var(--brown-dark); font-size: 0.8rem;">üõ°Ô∏è Current Risk Exposure</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Portfolio risk analysis</div>
                                </button>
                                
                                <button onclick="quickInvestorQuery('market_outlook')" 
                                    style="padding: 0.75rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 6px; cursor: pointer; text-align: left; transition: all 0.2s;">
                                    <div style="font-weight: 600; color: var(--brown-dark); font-size: 0.8rem;">üîÆ Market Outlook & Trends</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Next 24-48 hour forecast</div>
                                </button>
                                
                                <button onclick="quickInvestorQuery('rebalancing')" 
                                    style="padding: 0.75rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 6px; cursor: pointer; text-align: left; transition: all 0.2s;">
                                    <div style="font-weight: 600; color: var(--brown-dark); font-size: 0.8rem;">‚öñÔ∏è Rebalancing Strategy</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Optimize asset allocation</div>
                                </button>
                                
                                <button onclick="quickInvestorQuery('tax_optimization')" 
                                    style="padding: 0.75rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 6px; cursor: pointer; text-align: left; transition: all 0.2s;">
                                    <div style="font-weight: 600; color: var(--brown-dark); font-size: 0.8rem;">üí∞ Tax-Loss Harvesting</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">Optimize tax efficiency</div>
                                </button>
                            </div>
                            
                            <!-- Live Investment Metrics -->
                            <div style="margin-top: 1rem; padding: 0.75rem; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 8px;">
                                <div style="font-weight: 600; color: var(--purple); margin-bottom: 0.5rem; font-size: 0.8rem;">üìä Live Investment Metrics</div>
                                <div style="font-size: 0.7rem; color: var(--brown-text); line-height: 1.4;">
                                    ‚Ä¢ ROI (YTD): <span style="color: var(--success); font-weight: 600;">+13.7%</span><br>
                                    ‚Ä¢ Sharpe Ratio: <span style="color: var(--success); font-weight: 600;">3.47</span><br>
                                    ‚Ä¢ Max Drawdown: <span style="color: var(--warning); font-weight: 600;">-4.3%</span><br>
                                    ‚Ä¢ Active Positions: <span style="font-weight: 600;">4</span><br>
                                    ‚Ä¢ Available Capital: <span style="color: var(--info); font-weight: 600;">$284k</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Algorithm Marketplace -->
                <div class="card span-4">
                    <div class="card-header">
                        <h3 class="card-title">üõí Algorithm Marketplace</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <span class="badge" style="background: var(--success);">4 PREMIUM STRATEGIES</span>
                            <span class="badge" style="background: var(--purple);">LIVE RANKING</span>
                        </div>
                    </div>
                    
                    <!-- Strategy Performance Ranking -->
                    <div style="margin-bottom: 1.5rem;">
                        <div style="font-weight: 600; font-size: 0.9rem; margin-bottom: 0.75rem; color: var(--brown-dark);">üìä Live Strategy Performance Ranking</div>
                        
                        <div style="display: grid; gap: 0.75rem;">
                            <!-- Rank #1 - Hyperbolic Poincar√© Arbitrage -->
                            <div style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary)); border-radius: 8px; border-left: 4px solid #FFD700; position: relative;">
                                <div style="position: absolute; top: 0.75rem; right: 0.75rem; background: #FFD700; color: #000; padding: 0.25rem 0.5rem; border-radius: 12px; font-size: 0.7rem; font-weight: 700;">#1</div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">
                                    <div>
                                        <div style="font-weight: 700; font-size: 1rem; color: var(--brown-dark); margin-bottom: 0.25rem;">üåê Hyperbolic Poincar√© Arbitrage</div>
                                        <div style="font-size: 0.75rem; color: var(--brown-text);">Advanced geometric arbitrage using Poincar√© disk embedding</div>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; margin-bottom: 1rem;">
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">30D Return</div>
                                        <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">+4.73%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Sharpe Ratio</div>
                                        <div style="font-weight: 700; font-size: 1.1rem;">3.47</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Win Rate</div>
                                        <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">94.2%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Max DD</div>
                                        <div style="font-weight: 700; color: var(--warning); font-size: 1.1rem;">-0.8%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Calmar</div>
                                        <div style="font-weight: 700; font-size: 1.1rem;">5.91</div>
                                    </div>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div style="font-size: 0.75rem; color: var(--brown-text);">
                                        Price: <span style="font-weight: 600;">$2,500/month</span> | 
                                        Subscribers: <span style="font-weight: 600;">1,247</span>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button onclick="purchaseStrategy('hyperbolic_poincare')" style="padding: 0.5rem 1rem; background: var(--success); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                            Subscribe
                                        </button>
                                        <button onclick="customizeStrategy('hyperbolic_poincare')" style="padding: 0.5rem 1rem; background: var(--purple); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                            Customize
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Rank #2 - FinBERT Sentiment Fusion -->
                            <div style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary)); border-radius: 8px; border-left: 4px solid #C0C0C0; position: relative;">
                                <div style="position: absolute; top: 0.75rem; right: 0.75rem; background: #C0C0C0; color: #000; padding: 0.25rem 0.5rem; border-radius: 12px; font-size: 0.7rem; font-weight: 700;">#2</div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">
                                    <div>
                                        <div style="font-weight: 700; font-size: 1rem; color: var(--brown-dark); margin-bottom: 0.25rem;">üß† FinBERT Sentiment Fusion</div>
                                        <div style="font-size: 0.75rem; color: var(--brown-text);">AI-powered sentiment analysis with multimodal data fusion</div>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; margin-bottom: 1rem;">
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">30D Return</div>
                                        <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">+3.84%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Sharpe Ratio</div>
                                        <div style="font-weight: 700; font-size: 1.1rem;">2.93</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Win Rate</div>
                                        <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">89.1%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Max DD</div>
                                        <div style="font-weight: 700; color: var(--warning); font-size: 1.1rem;">-1.2%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Calmar</div>
                                        <div style="font-weight: 700; font-size: 1.1rem;">4.27</div>
                                    </div>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div style="font-size: 0.75rem; color: var(--brown-text);">
                                        Price: <span style="font-weight: 600;">$1,800/month</span> | 
                                        Subscribers: <span style="font-weight: 600;">892</span>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button onclick="purchaseStrategy('finbert_sentiment')" style="padding: 0.5rem 1rem; background: var(--success); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                            Subscribe
                                        </button>
                                        <button onclick="customizeStrategy('finbert_sentiment')" style="padding: 0.5rem 1rem; background: var(--purple); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                            Customize
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Rank #3 - Economic Trend AI -->
                            <div style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary)); border-radius: 8px; border-left: 4px solid #CD7F32; position: relative;">
                                <div style="position: absolute; top: 0.75rem; right: 0.75rem; background: #CD7F32; color: white; padding: 0.25rem 0.5rem; border-radius: 12px; font-size: 0.7rem; font-weight: 700;">#3</div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">
                                    <div>
                                        <div style="font-weight: 700; font-size: 1rem; color: var(--brown-dark); margin-bottom: 0.25rem;">üè¶ Economic Trend AI</div>
                                        <div style="font-size: 0.75rem; color: var(--brown-text);">Real-time economic indicator integration with trend following</div>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; margin-bottom: 1rem;">
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">30D Return</div>
                                        <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">+3.21%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Sharpe Ratio</div>
                                        <div style="font-weight: 700; font-size: 1.1rem;">2.56</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Win Rate</div>
                                        <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">85.3%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Max DD</div>
                                        <div style="font-weight: 700; color: var(--warning); font-size: 1.1rem;">-1.5%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Calmar</div>
                                        <div style="font-weight: 700; font-size: 1.1rem;">3.74</div>
                                    </div>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div style="font-size: 0.75rem; color: var(--brown-text);">
                                        Price: <span style="font-weight: 600;">$1,200/month</span> | 
                                        Subscribers: <span style="font-weight: 600;">634</span>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button onclick="purchaseStrategy('economic_trend')" style="padding: 0.5rem 1rem; background: var(--success); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                            Subscribe
                                        </button>
                                        <button onclick="customizeStrategy('economic_trend')" style="padding: 0.5rem 1rem; background: var(--purple); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                            Customize
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Rank #4 - Cross-Exchange AI -->
                            <div style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary)); border-radius: 8px; border-left: 4px solid var(--info); position: relative;">
                                <div style="position: absolute; top: 0.75rem; right: 0.75rem; background: var(--info); color: white; padding: 0.25rem 0.5rem; border-radius: 12px; font-size: 0.7rem; font-weight: 700;">#4</div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">
                                    <div>
                                        <div style="font-weight: 700; font-size: 1rem; color: var(--brown-dark); margin-bottom: 0.25rem;">‚ö° Cross-Exchange AI</div>
                                        <div style="font-size: 0.75rem; color: var(--brown-text);">Ultra-low latency arbitrage across multiple exchanges</div>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; margin-bottom: 1rem;">
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">30D Return</div>
                                        <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">+2.87%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Sharpe Ratio</div>
                                        <div style="font-weight: 700; font-size: 1.1rem;">2.14</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Win Rate</div>
                                        <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">82.7%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Max DD</div>
                                        <div style="font-weight: 700; color: var(--warning); font-size: 1.1rem;">-1.8%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 0.7rem; color: var(--brown-text);">Calmar</div>
                                        <div style="font-weight: 700; font-size: 1.1rem;">3.12</div>
                                    </div>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div style="font-size: 0.75rem; color: var(--brown-text);">
                                        Price: <span style="font-weight: 600;">$950/month</span> | 
                                        Subscribers: <span style="font-weight: 600;">423</span>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button onclick="purchaseStrategy('cross_exchange')" style="padding: 0.5rem 1rem; background: var(--success); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                            Subscribe
                                        </button>
                                        <button onclick="customizeStrategy('cross_exchange')" style="padding: 0.5rem 1rem; background: var(--purple); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                            Customize
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Algorithm Customization Interface -->
                    <div style="border-top: 2px solid var(--brown-light); padding-top: 1.5rem;">
                        <div style="font-weight: 600; font-size: 0.9rem; margin-bottom: 0.75rem; color: var(--brown-dark);">üõ†Ô∏è Algorithm Customization Studio</div>
                        
                        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
                            <!-- Parameter Tuning -->
                            <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px;">
                                <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--brown-dark);">Parameter Tuning</h4>
                                
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; margin-bottom: 1rem;">
                                    <div>
                                        <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem; display: block;">Risk Tolerance</label>
                                        <select id="riskTolerance" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                                            <option value="conservative">Conservative</option>
                                            <option value="moderate">Moderate</option>
                                            <option value="aggressive">Aggressive</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem; display: block;">Position Size (%)</label>
                                        <input type="number" id="positionSize" value="2.5" min="0.1" max="10" step="0.1" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                                    </div>
                                    
                                    <div>
                                        <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem; display: block;">Entry Threshold</label>
                                        <input type="number" id="entryThreshold" value="0.15" min="0.01" max="1.0" step="0.01" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                                    </div>
                                    
                                    <div>
                                        <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem; display: block;">Exit Threshold</label>
                                        <input type="number" id="exitThreshold" value="0.08" min="0.01" max="0.5" step="0.01" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 0.5rem;">
                                    <button onclick="previewCustomization()" style="padding: 0.5rem 1rem; background: var(--purple); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                        Preview Changes
                                    </button>
                                    <button onclick="deployCustomStrategy()" style="padding: 0.5rem 1rem; background: var(--success); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                        Deploy Custom Strategy
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Sandbox Environment -->
                            <div style="padding: 1rem; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 8px;">
                                <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--purple);">üß™ Testing Sandbox</h4>
                                
                                <div style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 1rem;">
                                    Test your customized algorithms in a secure environment before live deployment.
                                </div>
                                
                                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <button onclick="startSandboxTest()" style="padding: 0.5rem 1rem; background: var(--info); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; font-size: 0.8rem;">
                                        Start Paper Testing
                                    </button>
                                    <button onclick="validateStrategy()" style="padding: 0.5rem 1rem; background: var(--warning); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; font-size: 0.8rem;">
                                        Validate Logic
                                    </button>
                                    <button onclick="exportStrategy()" style="padding: 0.5rem 1rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; font-size: 0.8rem;">
                                        Export Config
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- KYC/AML Compliance & Onboarding -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üõ°Ô∏è Institutional Compliance</h3>
                        <span class="badge" style="background: var(--success);">SEC/FINRA ALIGNED</span>
                    </div>
                    
                    <!-- Compliance Status -->
                    <div style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary)); border-radius: 8px; margin-bottom: 1rem;">
                        <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--brown-dark);">Compliance Status</h4>
                        
                        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-size: 0.8rem; color: var(--brown-text);">KYC Verification</span>
                                <span style="color: var(--success); font-weight: 600; font-size: 0.8rem;">‚úì Complete</span>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-size: 0.8rem; color: var(--brown-text);">AML Screening</span>
                                <span style="color: var(--success); font-weight: 600; font-size: 0.8rem;">‚úì Cleared</span>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-size: 0.8rem; color: var(--brown-text);">Sanctions Check</span>
                                <span style="color: var(--success); font-weight: 600; font-size: 0.8rem;">‚úì Passed</span>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-size: 0.8rem; color: var(--brown-text);">Beneficial Ownership</span>
                                <span style="color: var(--success); font-weight: 600; font-size: 0.8rem;">‚úì Documented</span>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: white; border-radius: 4px;">
                                <span style="font-size: 0.8rem; color: var(--brown-text);">Source of Funds</span>
                                <span style="color: var(--success); font-weight: 600; font-size: 0.8rem;">‚úì Verified</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Investment Profile -->
                    <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px; margin-bottom: 1rem;">
                        <h4 style="font-size: 0.85rem; margin-bottom: 0.75rem; color: var(--brown-dark);">Investment Profile</h4>
                        
                        <div style="display: flex; flex-direction: column; gap: 0.75rem; font-size: 0.8rem;">
                            <div>
                                <span style="color: var(--brown-text);">Investor Type:</span>
                                <span style="font-weight: 600; margin-left: 0.5rem;">Sophisticated Investor</span>
                            </div>
                            
                            <div>
                                <span style="color: var(--brown-text);">Experience Level:</span>
                                <span style="font-weight: 600; margin-left: 0.5rem;">Advanced (15+ years)</span>
                            </div>
                            
                            <div>
                                <span style="color: var(--brown-text);">Risk Capacity:</span>
                                <span style="font-weight: 600; margin-left: 0.5rem;">High</span>
                            </div>
                            
                            <div>
                                <span style="color: var(--brown-text);">Investment Horizon:</span>
                                <span style="font-weight: 600; margin-left: 0.5rem;">Long-term (5+ years)</span>
                            </div>
                            
                            <div>
                                <span style="color: var(--brown-text);">Liquidity Needs:</span>
                                <span style="font-weight: 600; margin-left: 0.5rem;">Low (< 20%)</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Regulatory Actions -->
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <button onclick="updateComplianceInfo()" style="padding: 0.5rem 1rem; background: var(--info); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; font-size: 0.8rem;">
                            Update Information
                        </button>
                        
                        <button onclick="generateComplianceReport()" style="padding: 0.5rem 1rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; font-size: 0.8rem;">
                            Generate Report
                        </button>
                        
                        <button onclick="requestAuditTrail()" style="padding: 0.5rem 1rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; font-size: 0.8rem;">
                            Audit Trail
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Assistant Tab -->
        <div class="tab-content" id="ai-assistant-tab">
            <div class="dashboard-grid">
                <!-- AI Chat Interface -->
                <div class="card span-2" style="height: 600px; display: flex; flex-direction: column;">
                    <div class="card-header">
                        <h3 class="card-title">ü§ñ GOMNA AI Trading Assistant</h3>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span class="live-dot"></span>
                            <span class="badge" style="background: var(--success);">LLM ONLINE</span>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Hyperbolic Intelligence</div>
                        </div>
                    </div>
                    
                    <!-- Chat Messages Area -->
                    <div id="ai-chat-messages" style="flex: 1; overflow-y: auto; padding: 1rem; background: var(--cream-light); border-radius: 8px; margin-bottom: 1rem; font-size: 0.85rem;">
                        <div class="ai-message" style="margin-bottom: 1rem;">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">AI</div>
                                <span style="font-weight: 600; color: var(--purple);">GOMNA AI</span>
                                <span style="font-size: 0.7rem; color: var(--brown-text);">Just now</span>
                            </div>
                            <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid var(--purple);">
                                Hello! I'm your advanced trading intelligence assistant. I can help you with:
                                <br><br>
                                ‚Ä¢ üìä Real-time market analysis and insights
                                ‚Ä¢ üéØ Arbitrage opportunity identification  
                                ‚Ä¢ üìà Portfolio optimization strategies
                                ‚Ä¢ üîç Risk assessment and management
                                ‚Ä¢ üìã Backtesting configuration guidance
                                ‚Ä¢ üíπ Paper trading recommendations
                                <br><br>
                                What would you like to explore today?
                            </div>
                        </div>
                    </div>
                    
                    <!-- Chat Input -->
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="text" id="ai-chat-input" placeholder="Ask me anything about trading, markets, or strategies..." 
                            style="flex: 1; padding: 0.75rem; border: 1px solid var(--brown-light); border-radius: 8px; background: white; font-size: 0.85rem;"
                            onkeypress="if(event.key==='Enter') sendAiMessage()">
                        <button onclick="sendAiMessage()" 
                            style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s;">
                            Send
                        </button>
                    </div>
                </div>
                
                <!-- AI Insights Panel -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üí° Live AI Insights</h3>
                    </div>
                    
                    <div id="ai-insights" style="space-y: 1rem;">
                        <!-- Market Sentiment -->
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px; margin-bottom: 0.75rem;">
                            <div style="font-size: 0.7rem; color: var(--brown-text); margin-bottom: 0.25rem;">Market Sentiment</div>
                            <div style="font-weight: 600; color: var(--success); margin-bottom: 0.5rem;">Bullish (+0.73)</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Strong institutional buying detected across DeFi sectors</div>
                        </div>
                        
                        <!-- Top Recommendation -->
                        <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 6px; margin-bottom: 0.75rem;">
                            <div style="font-size: 0.7rem; color: var(--brown-text); margin-bottom: 0.25rem;">AI Recommendation</div>
                            <div style="font-weight: 600; color: var(--purple); margin-bottom: 0.5rem;">SOL/ETH Arbitrage</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Expected profit: 1.23% | Risk: Low | Confidence: 94%</div>
                        </div>
                        
                        <!-- Risk Alert -->
                        <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 138, 101, 0.1)); border-radius: 6px; margin-bottom: 0.75rem;">
                            <div style="font-size: 0.7rem; color: var(--brown-text); margin-bottom: 0.25rem;">Risk Alert</div>
                            <div style="font-weight: 600; color: #ff8a65; margin-bottom: 0.5rem;">High Volatility Period</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Increased slippage expected in next 2 hours</div>
                        </div>
                        
                        <!-- Portfolio Health -->
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text); margin-bottom: 0.25rem;">Portfolio Health</div>
                            <div style="font-weight: 600; color: var(--success); margin-bottom: 0.5rem;">Excellent (A+)</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Optimal diversification across 12 strategies</div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="card span-3">
                    <div class="card-header">
                        <h3 class="card-title">‚ö° AI-Powered Quick Actions</h3>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <button onclick="analyzeMarketConditions()" 
                            style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">üìà Analyze Market Conditions</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Get AI insights on current market state</div>
                        </button>
                        
                        <button onclick="findArbitrageOpportunities()" 
                            style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">üéØ Find Arbitrage Opportunities</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Scan for profitable arbitrage trades</div>
                        </button>
                        
                        <button onclick="optimizePortfolio()" 
                            style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">‚öñÔ∏è Optimize Portfolio</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">AI-driven portfolio rebalancing</div>
                        </button>
                        
                        <button onclick="assessRisk()" 
                            style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">üõ°Ô∏è Assess Portfolio Risk</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Comprehensive risk analysis</div>
                        </button>
                        
                        <button onclick="generateStrategy()" 
                            style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">üß† Generate Trading Strategy</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">AI-created custom strategies</div>
                        </button>
                        
                        <button onclick="backtestRecommendation()" 
                            style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), white); border: 1px solid var(--brown-light); border-radius: 8px; cursor: pointer; text-align: left; transition: all 0.2s;">
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">üìä Backtest Recommendation</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Test strategies with historical data</div>
                        </button>
                    </div>
                </div>
                
                <!-- Hyperbolic Space Visualization -->
                <div class="card span-3" style="height: 500px;">
                    <div class="card-header">
                        <h3 class="card-title">üåê Hyperbolic Market Space (Poincar√© Disk)</h3>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span class="live-dot"></span>
                            <span class="badge" style="background: var(--purple);">Real-Time Embedding</span>
                        </div>
                    </div>
                    
                    <div style="position: relative; height: 420px; display: flex;">
                        <!-- Poincar√© Disk Canvas -->
                        <div style="flex: 2; position: relative;">
                            <canvas id="poincareCanvas" width="400" height="400" style="border: 2px solid var(--brown-light); border-radius: 50%; background: radial-gradient(circle, var(--cream-light) 0%, var(--cream-secondary) 100%); cursor: crosshair;"></canvas>
                            
                            <!-- Hyperbolic Metrics Overlay -->
                            <div style="position: absolute; top: 10px; left: 10px; background: rgba(255, 248, 231, 0.95); padding: 0.5rem; border-radius: 6px; font-size: 0.7rem; backdrop-filter: blur(10px);">
                                <div><strong>Curvature:</strong> <span id="hyperbolic-curvature">-1.0</span></div>
                                <div><strong>Dimensions:</strong> <span id="hyperbolic-dims">128</span></div>
                                <div><strong>Entities:</strong> <span id="hyperbolic-entities">847</span></div>
                                <div><strong>Distance Metric:</strong> Geodesic</div>
                            </div>
                        </div>
                        
                        <!-- Embedding Controls and Legend -->
                        <div style="flex: 1; padding-left: 1rem; display: flex; flex-direction: column;">
                            <!-- Strategy Clusters -->
                            <div style="margin-bottom: 1rem;">
                                <div style="font-weight: 600; font-size: 0.8rem; margin-bottom: 0.5rem; color: var(--brown-dark);">Strategy Clusters</div>
                                <div style="display: flex; flex-direction: column; gap: 0.3rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.75rem;">
                                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #FF6B35;"></div>
                                        <span>Arbitrage Strategies (Core)</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.75rem;">
                                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #4ECDC4;"></div>
                                        <span>Sentiment-Based (Periphery)</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.75rem;">
                                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #45B7D1;"></div>
                                        <span>Cross-Exchange (Mid)</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.75rem;">
                                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #F7DC6F;"></div>
                                        <span>Statistical Pairs</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.75rem;">
                                        <div style="width: 8px; height: 8px; border-radius: 50%; background: #BB8FCE;"></div>
                                        <span>Economic Trend</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Hyperbolic Controls -->
                            <div style="margin-bottom: 1rem;">
                                <div style="font-weight: 600; font-size: 0.8rem; margin-bottom: 0.5rem; color: var(--brown-dark);">Embedding Controls</div>
                                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <button onclick="updateHyperbolicEmbedding()" style="padding: 0.4rem 0.8rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer;">
                                        Update Embedding
                                    </button>
                                    <button onclick="recenterHyperbolicView()" style="padding: 0.4rem 0.8rem; background: var(--brown-dark); color: white; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer;">
                                        Recenter View
                                    </button>
                                    <button onclick="exportHyperbolicData()" style="padding: 0.4rem 0.8rem; background: var(--info); color: white; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer;">
                                        Export Coordinates
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Live Arbitrage Opportunities -->
                            <div>
                                <div style="font-weight: 600; font-size: 0.8rem; margin-bottom: 0.5rem; color: var(--brown-dark);">Live Opportunities</div>
                                <div id="hyperbolic-opportunities" style="max-height: 100px; overflow-y: auto; font-size: 0.7rem;">
                                    <div style="padding: 0.3rem; background: var(--cream-light); border-radius: 3px; margin-bottom: 0.3rem;">
                                        <div style="font-weight: 600; color: var(--success);">BTC/ETH Triangular</div>
                                        <div style="color: var(--brown-text);">Distance: 0.847 | Profit: 0.23%</div>
                                    </div>
                                    <div style="padding: 0.3rem; background: var(--cream-light); border-radius: 3px; margin-bottom: 0.3rem;">
                                        <div style="font-weight: 600; color: var(--warning);">SOL Cross-Exchange</div>
                                        <div style="color: var(--brown-text);">Distance: 1.234 | Profit: 0.18%</div>
                                    </div>
                                    <div style="padding: 0.3rem; background: var(--cream-light); border-radius: 3px;">
                                        <div style="font-weight: 600; color: var(--info);">AVAX Sentiment</div>
                                        <div style="color: var(--brown-text);">Distance: 2.156 | Profit: 0.31%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Multimodal Data Fusion Dashboard -->
                <div class="card span-3">
                    <div class="card-header">
                        <h3 class="card-title">üîó Multimodal Data Fusion Engine</h3>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span class="live-dot"></span>
                            <span class="badge" style="background: var(--success);">Streaming</span>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; margin-bottom: 1rem;">
                        <!-- Market Data Stream -->
                        <div style="text-align: center; padding: 1rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #4ECDC4;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìà</div>
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">Market Data</div>
                            <div style="font-size: 0.8rem; color: var(--success);">847 feeds active</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">~50ms latency</div>
                        </div>
                        
                        <!-- FinBERT Sentiment -->
                        <div style="text-align: center; padding: 1rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #FF6B35;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üß†</div>
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">FinBERT</div>
                            <div style="font-size: 0.8rem; color: var(--success);">Sentiment: +0.73</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">2,340 articles/hr</div>
                        </div>
                        
                        <!-- Economic Indicators -->
                        <div style="text-align: center; padding: 1rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #F7DC6F;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üè¶</div>
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">Economic</div>
                            <div style="font-size: 0.8rem; color: var(--warning);">CPI +0.3%</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">12 indicators</div>
                        </div>
                        
                        <!-- Social Analytics -->
                        <div style="text-align: center; padding: 1rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #BB8FCE;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üåê</div>
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">Social</div>
                            <div style="font-size: 0.8rem; color: var(--info);">Bullish trend</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">156k mentions</div>
                        </div>
                        
                        <!-- Order Book -->
                        <div style="text-align: center; padding: 1rem; background: var(--cream-light); border-radius: 8px; border-left: 4px solid #45B7D1;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìö</div>
                            <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">Order Book</div>
                            <div style="font-size: 0.8rem; color: var(--success);">L3 depth</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">~1ms updates</div>
                        </div>
                    </div>
                    
                    <!-- Data Fusion Flow -->
                    <div style="background: var(--cream-secondary); border-radius: 8px; padding: 1rem;">
                        <div style="font-weight: 600; margin-bottom: 0.75rem; color: var(--brown-dark);">üîÑ Real-Time Data Flow</div>
                        <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.8rem; color: var(--brown-text);">
                            <span>Raw Data Ingestion</span>
                            <span style="color: var(--purple);">‚Üí</span>
                            <span>AI Fraud Detection</span>
                            <span style="color: var(--purple);">‚Üí</span>
                            <span>Normalization</span>
                            <span style="color: var(--purple);">‚Üí</span>
                            <span>Hyperbolic Embedding</span>
                            <span style="color: var(--purple);">‚Üí</span>
                            <span>Strategy Engine</span>
                            <span style="color: var(--purple);">‚Üí</span>
                            <span>AI Opportunities Agent</span>
                            <span style="color: var(--purple);">‚Üí</span>
                            <span>Trade Execution</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Backtesting Tab -->
        <div class="tab-content" id="backtesting-tab">
            <div class="dashboard-grid">
                <!-- Backtesting Configuration -->
                <div class="card span-3">
                    <div class="card-header">
                        <h3 class="card-title">üìä Backtesting Configuration</h3>
                        <span class="badge" id="backtestStatus">Ready</span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Start Date</label>
                            <input type="date" id="btStartDate" value="2023-01-01" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">End Date</label>
                            <input type="date" id="btEndDate" value="2024-01-01" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Initial Capital</label>
                            <input type="number" id="btCapital" value="100000" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Strategy</label>
                            <select id="btStrategy" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                                <option value="hyperbolic_poincare">Hyperbolic Poincar√© Arbitrage</option>
                                <option value="sentiment_finbert">FinBERT Sentiment Arbitrage</option>
                                <option value="triangular_geometric">Triangular + Geometric Arbitrage</option>
                                <option value="statistical_hyperbolic">Statistical + Hyperbolic Pairs</option>
                                <option value="cross_exchange_ai">AI-Enhanced Cross-Exchange</option>
                                <option value="economic_trend">Economic Trend Following</option>
                                <option value="multimodal_fusion">Multimodal Data Fusion</option>
                                <option value="ai_opportunities">AI Live Opportunities</option>
                            </select>
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Slippage Model</label>
                            <select id="btSlippage" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                                <option value="realistic">Realistic</option>
                                <option value="linear">Linear</option>
                                <option value="market_impact">Market Impact</option>
                            </select>
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Commission (%)</label>
                            <input type="number" id="btCommission" value="0.02" step="0.01" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Embedding Dims</label>
                            <select id="btEmbeddingDims" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                                <option value="64">64D</option>
                                <option value="128" selected>128D</option>
                                <option value="256">256D</option>
                                <option value="512">512D</option>
                            </select>
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">Curvature</label>
                            <input type="number" id="btCurvature" value="-1.0" step="0.1" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <label style="font-size: 0.75rem; color: var(--brown-text); margin-bottom: 0.25rem;">AI Model</label>
                            <select id="btAiModel" style="padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: var(--cream-light);">
                                <option value="finbert">FinBERT</option>
                                <option value="transformer">Transformer</option>
                                <option value="lstm">LSTM</option>
                                <option value="cnn">Hyperbolic CNN</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 0.5rem;">
                        <button onclick="runBacktest()" style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, var(--brown-dark), var(--brown-text)); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                            Run Backtest
                        </button>
                        <button onclick="runMonteCarloSimulation()" style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, var(--purple), #8B66D1); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                            Monte Carlo (1000 runs)
                        </button>
                        <button onclick="runWalkForward()" style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, var(--info), #5692C4); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                            Walk-Forward Optimization
                        </button>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">Performance Metrics</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem;">
                        <div style="text-align: center; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);" id="btTotalReturn">--</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Total Return</div>
                        </div>
                        <div style="text-align: center; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <div style="font-size: 1.5rem; font-weight: 700;" id="btSharpe">--</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Sharpe Ratio</div>
                        </div>
                        <div style="text-align: center; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--danger);" id="btMaxDD">--</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Max Drawdown</div>
                        </div>
                        <div style="text-align: center; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <div style="font-size: 1.5rem; font-weight: 700;" id="btWinRate">--</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Win Rate</div>
                        </div>
                        <div style="text-align: center; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <div style="font-size: 1.5rem; font-weight: 700;" id="btProfitFactor">--</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Profit Factor</div>
                        </div>
                        <div style="text-align: center; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <div style="font-size: 1.5rem; font-weight: 700;" id="btCalmar">--</div>
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Calmar Ratio</div>
                        </div>
                    </div>
                </div>

                <!-- Risk Metrics -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Risk Analysis</h3>
                    </div>
                    <div style="padding: 0.5rem;">
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--cream-secondary);">
                            <span style="font-size: 0.8rem;">VaR (95%)</span>
                            <strong id="btVaR">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--cream-secondary);">
                            <span style="font-size: 0.8rem;">CVaR (95%)</span>
                            <strong id="btCVaR">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--cream-secondary);">
                            <span style="font-size: 0.8rem;">Volatility</span>
                            <strong id="btVolatility">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--cream-secondary);">
                            <span style="font-size: 0.8rem;">Sortino Ratio</span>
                            <strong id="btSortino">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0;">
                            <span style="font-size: 0.8rem;">Beta</span>
                            <strong id="btBeta">--</strong>
                        </div>
                    </div>
                </div>

                <!-- Equity Curve Chart -->
                <div class="card span-3">
                    <div class="card-header">
                        <h3 class="card-title">Equity Curve</h3>
                    </div>
                    <div style="height: 300px; background: var(--cream-light); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <canvas id="equityChart" style="max-width: 100%; max-height: 100%;"></canvas>
                    </div>
                </div>

                <!-- Trade Statistics -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">Trade Statistics</h3>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.85rem;">
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Total Trades</span>
                            <strong id="btTotalTrades">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Winning Trades</span>
                            <strong style="color: var(--success);" id="btWinningTrades">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Losing Trades</span>
                            <strong style="color: var(--danger);" id="btLosingTrades">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Avg Win</span>
                            <strong style="color: var(--success);" id="btAvgWin">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Avg Loss</span>
                            <strong style="color: var(--danger);" id="btAvgLoss">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: var(--cream-light); border-radius: 4px;">
                            <span>Best Trade</span>
                            <strong style="color: var(--success);" id="btBestTrade">--</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Paper Trading Tab -->
        <div class="tab-content" id="paper-tab">
            <div class="dashboard-grid">
                <!-- Paper Account Overview -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">üìù AI-Enhanced Paper Trading</h3>
                        <div style="display: flex; gap: 0.5rem;">
                            <button onclick="createPaperAccount()" style="padding: 0.5rem 1rem; background: var(--success); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer;">
                                Create Account
                            </button>
                            <button onclick="enableAiAssistance()" style="padding: 0.5rem 1rem; background: var(--purple); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer;">
                                ü§ñ AI Assist
                            </button>
                        </div>
                    </div>
                    
                    <div id="paperAccountInfo" style="padding: 1rem; background: linear-gradient(135deg, var(--cream-light), var(--cream-secondary)); border-radius: 8px; margin-bottom: 1rem;">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Account Balance</div>
                                <div style="font-size: 1.5rem; font-weight: 700;" id="paperBalance">$0.00</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Total Equity</div>
                                <div style="font-size: 1.5rem; font-weight: 700;" id="paperEquity">$0.00</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Buying Power</div>
                                <div style="font-size: 1.2rem; font-weight: 600;" id="paperBuyingPower">$0.00</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Total P&L</div>
                                <div style="font-size: 1.2rem; font-weight: 600;" id="paperPnL">$0.00</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI Live Opportunities Agent -->
                    <div style="padding: 1rem; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid var(--purple);">
                        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 0.75rem;">
                            <h4 style="font-size: 0.9rem; color: var(--purple); font-weight: 600;">üîç AI Live Opportunities Agent</h4>
                            <span class="live-dot"></span>
                        </div>
                        
                        <div id="aiOpportunities" style="display: grid; gap: 0.5rem; max-height: 200px; overflow-y: auto;">
                            <!-- Example AI-identified opportunities -->
                            <div style="padding: 0.75rem; background: white; border-radius: 6px; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; color: var(--brown-dark);">BTC/ETH Triangular</div>
                                    <div style="font-size: 0.75rem; color: var(--brown-text);">Hyperbolic distance: 0.847 | Confidence: 94%</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 600; color: var(--success);">+0.23%</div>
                                    <button onclick="executeAiOpportunity('BTC_ETH_TRI')" style="padding: 0.25rem 0.5rem; background: var(--success); color: white; border: none; border-radius: 3px; font-size: 0.7rem; cursor: pointer;">
                                        Execute
                                    </button>
                                </div>
                            </div>
                            
                            <div style="padding: 0.75rem; background: white; border-radius: 6px; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; color: var(--brown-dark);">SOL Cross-Exchange</div>
                                    <div style="font-size: 0.75rem; color: var(--brown-text);">Binance-Coinbase spread | Confidence: 87%</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 600; color: var(--warning);">+0.18%</div>
                                    <button onclick="executeAiOpportunity('SOL_CROSS')" style="padding: 0.25rem 0.5rem; background: var(--warning); color: white; border: none; border-radius: 3px; font-size: 0.7rem; cursor: pointer;">
                                        Execute
                                    </button>
                                </div>
                            </div>
                            
                            <div style="padding: 0.75rem; background: white; border-radius: 6px; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; color: var(--brown-dark);">AVAX Sentiment Arbitrage</div>
                                    <div style="font-size: 0.75rem; color: var(--brown-text);">FinBERT score: +0.73 | News surge detected</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 600; color: var(--info);">+0.31%</div>
                                    <button onclick="executeAiOpportunity('AVAX_SENTIMENT')" style="padding: 0.25rem 0.5rem; background: var(--info); color: white; border: none; border-radius: 3px; font-size: 0.7rem; cursor: pointer;">
                                        Execute
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 0.75rem; font-size: 0.7rem; color: var(--brown-text);">
                            AI agent scans hyperbolic space for emerging opportunities using pattern recognition and predictive analytics.
                        </div>
                    </div>
                    
                    <!-- Order Form -->
                    <div style="padding: 1rem; background: var(--cream-light); border-radius: 8px;">
                        <h4 style="font-size: 0.9rem; margin-bottom: 0.75rem;">Place Order</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.75rem;">
                            <div>
                                <label style="font-size: 0.7rem; color: var(--brown-text);">Symbol</label>
                                <select id="paperSymbol" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                                    <option value="BTC/USD">BTC/USD</option>
                                    <option value="ETH/USD">ETH/USD</option>
                                    <option value="SOL/USD">SOL/USD</option>
                                    <option value="AVAX/USD">AVAX/USD</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.7rem; color: var(--brown-text);">Side</label>
                                <select id="paperSide" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                                    <option value="BUY">Buy</option>
                                    <option value="SELL">Sell</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.7rem; color: var(--brown-text);">Type</label>
                                <select id="paperOrderType" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                                    <option value="MARKET">Market</option>
                                    <option value="LIMIT">Limit</option>
                                    <option value="STOP">Stop</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.7rem; color: var(--brown-text);">Quantity</label>
                                <input type="number" id="paperQuantity" value="1" step="0.01" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                            </div>
                            <div>
                                <label style="font-size: 0.7rem; color: var(--brown-text);">Limit Price</label>
                                <input type="number" id="paperLimitPrice" placeholder="Optional" step="0.01" style="width: 100%; padding: 0.5rem; border: 1px solid var(--brown-light); border-radius: 4px; background: white;">
                            </div>
                            <div style="display: flex; align-items: flex-end;">
                                <button onclick="placePaperOrder()" style="width: 100%; padding: 0.5rem; background: linear-gradient(135deg, var(--brown-dark), var(--brown-text)); color: white; border: none; border-radius: 4px; font-weight: 600; cursor: pointer;">
                                    Place Order
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Open Positions -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">Open Positions</h3>
                    </div>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; font-size: 0.85rem;">
                            <thead>
                                <tr style="background: var(--cream-secondary);">
                                    <th style="padding: 0.5rem; text-align: left;">Symbol</th>
                                    <th style="padding: 0.5rem; text-align: right;">Quantity</th>
                                    <th style="padding: 0.5rem; text-align: right;">Entry Price</th>
                                    <th style="padding: 0.5rem; text-align: right;">Current Price</th>
                                    <th style="padding: 0.5rem; text-align: right;">P&L</th>
                                    <th style="padding: 0.5rem; text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody id="paperPositions">
                                <tr>
                                    <td colspan="6" style="padding: 1rem; text-align: center; color: var(--brown-text);">No open positions</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Performance</h3>
                    </div>
                    <div style="font-size: 0.85rem;">
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; border-bottom: 1px solid var(--cream-secondary);">
                            <span>Win Rate</span>
                            <strong id="paperWinRate">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; border-bottom: 1px solid var(--cream-secondary);">
                            <span>Total Trades</span>
                            <strong id="paperTotalTrades">0</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; border-bottom: 1px solid var(--cream-secondary);">
                            <span>Profit Factor</span>
                            <strong id="paperProfitFactor">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem; border-bottom: 1px solid var(--cream-secondary);">
                            <span>Avg Win</span>
                            <strong style="color: var(--success);" id="paperAvgWin">--</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 0.5rem;">
                            <span>Avg Loss</span>
                            <strong style="color: var(--danger);" id="paperAvgLoss">--</strong>
                        </div>
                    </div>
                </div>

                <!-- Trade History -->
                <div class="card span-3">
                    <div class="card-header">
                        <h3 class="card-title">Trade History</h3>
                    </div>
                    <div style="max-height: 300px; overflow-y: auto;" id="paperTradeHistory">
                        <div style="padding: 1rem; text-align: center; color: var(--brown-text);">No trades yet</div>
                    </div>
                </div>

                <!-- Orders -->
                <div class="card span-2">
                    <div class="card-header">
                        <h3 class="card-title">Open Orders</h3>
                    </div>
                    <div id="paperOrders" style="max-height: 200px; overflow-y: auto;">
                        <div style="padding: 1rem; text-align: center; color: var(--brown-text);">No open orders</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize mini Poincar√© disk
        function initMiniPoincare() {
            const canvas = document.getElementById('mini-poincare');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const centerX = 90;
            const centerY = 90;
            const radius = 80;
            
            // Clear canvas
            ctx.clearRect(0, 0, 180, 180);
            
            // Draw disk
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.strokeStyle = 'rgba(107, 70, 193, 0.3)';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Draw grid
            for (let i = 1; i < 4; i++) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius * (i / 4), 0, 2 * Math.PI);
                ctx.strokeStyle = 'rgba(107, 70, 193, 0.1)';
                ctx.lineWidth = 1;
                ctx.stroke();
            }
            
            // Animate points
            const points = [];
            for (let i = 0; i < 8; i++) {
                const r = Math.random() * radius * 0.8;
                const theta = (i / 8) * 2 * Math.PI + Math.random() * 0.5;
                const hyperbolicR = Math.tanh(r / radius) * radius;
                
                points.push({
                    x: centerX + hyperbolicR * Math.cos(theta),
                    y: centerY + hyperbolicR * Math.sin(theta),
                    color: `hsl(${250 + Math.random() * 30}, 70%, 60%)`
                });
            }
            
            // Draw points
            points.forEach(point => {
                ctx.beginPath();
                ctx.arc(point.x, point.y, 3, 0, 2 * Math.PI);
                ctx.fillStyle = point.color;
                ctx.fill();
            });
            
            // Draw connections
            for (let i = 0; i < points.length; i++) {
                for (let j = i + 1; j < points.length; j++) {
                    const dist = Math.sqrt(
                        Math.pow(points[i].x - points[j].x, 2) + 
                        Math.pow(points[i].y - points[j].y, 2)
                    );
                    
                    if (dist < 60) {
                        ctx.beginPath();
                        ctx.moveTo(points[i].x, points[i].y);
                        ctx.lineTo(points[j].x, points[j].y);
                        ctx.strokeStyle = 'rgba(107, 70, 193, 0.15)';
                        ctx.lineWidth = 1;
                        ctx.stroke();
                    }
                }
            }
        }
        
        // Update live opportunities
        function updateOpportunities() {
            const container = document.getElementById('live-opportunities');
            if (!container) return;
            
            container.innerHTML = '';
            
            const types = ['CROSS_EXCHANGE', 'TRIANGULAR', 'STATISTICAL', 'SPATIAL'];
            const symbols = ['BTC/USD', 'ETH/USD', 'SOL/USD'];
            
            for (let i = 0; i < 3; i++) {
                const type = types[Math.floor(Math.random() * types.length)];
                const profit = (Math.random() * 300 + 50).toFixed(2);
                const prob = (70 + Math.random() * 25).toFixed(1);
                
                const oppDiv = document.createElement('div');
                oppDiv.style.cssText = 'padding: 0.75rem; background: var(--cream-light); border-radius: 6px; margin-bottom: 0.5rem; cursor: pointer; transition: all 0.2s;';
                oppDiv.onmouseover = function() { this.style.background = 'var(--cream-secondary)'; };
                oppDiv.onmouseout = function() { this.style.background = 'var(--cream-light)'; };
                
                oppDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                        <span style="font-weight: 600; font-size: 0.75rem; color: var(--purple);">${type}</span>
                        <span style="font-weight: 700; color: var(--success);">+$${profit}</span>
                    </div>
                    <div style="font-size: 0.65rem; color: var(--brown-text);">
                        ${symbols[Math.floor(Math.random() * symbols.length)]} | ${prob}% prob | ${(10 + Math.random() * 40).toFixed(0)}ms
                    </div>
                `;
                
                container.appendChild(oppDiv);
            }
        }
        
        // Update market prices
        function updateMarketPrices() {
            const btcPrice = 45000 + Math.random() * 5000;
            const ethPrice = 3000 + Math.random() * 500;
            const solPrice = 100 + Math.random() * 20;
            
            document.getElementById('btc-price').textContent = `$${btcPrice.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            document.getElementById('eth-price').textContent = `$${ethPrice.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            document.getElementById('sol-price').textContent = `$${solPrice.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            document.getElementById('btc-change').textContent = `+${(Math.random() * 5).toFixed(2)}%`;
            document.getElementById('eth-change').textContent = `+${(Math.random() * 7).toFixed(2)}%`;
            document.getElementById('sol-change').textContent = `+${(Math.random() * 10).toFixed(2)}%`;
            
            document.getElementById('spread-1').textContent = `${(Math.random() * 0.2).toFixed(3)}%`;
            document.getElementById('spread-2').textContent = `${(Math.random() * 0.15).toFixed(3)}%`;
        }
        
        // Update platform metrics
        function updatePlatformMetrics() {
            const totalProfit = Math.random() * 50000;
            const opportunities = Math.floor(Math.random() * 500 + 100);
            const trades = Math.floor(Math.random() * 200 + 50);
            const successRate = 85 + Math.random() * 10;
            const latency = 2 + Math.random() * 3;
            
            document.getElementById('total-profit-dash').textContent = `$${totalProfit.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            document.getElementById('opportunities-detected').textContent = opportunities;
            document.getElementById('trades-executed').textContent = trades;
            document.getElementById('dash-success-rate').textContent = `${successRate.toFixed(1)}%`;
            document.getElementById('dash-latency').textContent = `${latency.toFixed(1)}ms`;
            
            // Update risk metrics
            document.getElementById('var-value').textContent = `$${(Math.random() * 20000 + 5000).toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            document.getElementById('sharpe-value').textContent = (1.5 + Math.random() * 1.5).toFixed(2);
            
            const riskLevels = ['LOW', 'MEDIUM', 'LOW', 'LOW'];
            const riskLevel = riskLevels[Math.floor(Math.random() * riskLevels.length)];
            const riskElement = document.getElementById('risk-level');
            riskElement.textContent = riskLevel;
            riskElement.style.color = riskLevel === 'LOW' ? 'var(--success)' : 'var(--warning)';
        }
        
        // Update activity feed
        function updateActivityFeed() {
            const feed = document.getElementById('activity-feed');
            if (!feed) return;
            
            const activities = [
                { type: 'trade', text: 'Executed BTC/USD arbitrage', profit: '+$234.56' },
                { type: 'opportunity', text: 'New triangular opportunity detected', profit: null },
                { type: 'trade', text: 'Closed ETH/BTC position', profit: '+$123.45' },
                { type: 'system', text: 'Risk parameters updated', profit: null },
                { type: 'trade', text: 'Executed SOL/USD trade', profit: '+$89.12' }
            ];
            
            const newActivity = activities[Math.floor(Math.random() * activities.length)];
            const timestamp = new Date().toLocaleTimeString();
            
            const activityDiv = document.createElement('div');
            activityDiv.style.cssText = 'padding: 0.5rem; border-bottom: 1px solid var(--cream-tertiary);';
            
            const icon = newActivity.type === 'trade' ? 'üíπ' : (newActivity.type === 'opportunity' ? 'üéØ' : '‚öôÔ∏è');
            const profitText = newActivity.profit ? `<span style="color: var(--success); font-weight: 600;">${newActivity.profit}</span>` : '';
            
            activityDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between;">
                    <span>${icon} ${newActivity.text}</span>
                    ${profitText}
                </div>
                <div style="font-size: 0.6rem; color: var(--brown-text); margin-top: 0.25rem;">${timestamp}</div>
            `;
            
            feed.insertBefore(activityDiv, feed.firstChild);
            
            // Keep only last 5 activities
            while (feed.children.length > 5) {
                feed.removeChild(feed.lastChild);
            }
        }
        
        // Initialize dashboard
        function initDashboard() {
            initMiniPoincare();
            updateOpportunities();
            updateMarketPrices();
            updatePlatformMetrics();
            updateActivityFeed();
            
            // Set up periodic updates
            setInterval(initMiniPoincare, 5000);
            setInterval(updateOpportunities, 3000);
            setInterval(updateMarketPrices, 2000);
            setInterval(updatePlatformMetrics, 4000);
            setInterval(updateActivityFeed, 5000);
        }
        
        // Start when page loads
        window.addEventListener('DOMContentLoaded', initDashboard);
        
        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        // Update functions
        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString();
            const marketTime = document.getElementById('market-time');
            if (marketTime) marketTime.textContent = timeStr;
        }

        function updatePortfolio() {
            // Update portfolio value
            const currentValue = 2847563 + Math.floor(Math.random() * 10000 - 5000);
            document.getElementById('portfolio-value').textContent = `$${currentValue.toLocaleString()}`;
            const totalValue = document.getElementById('total-value');
            if (totalValue) totalValue.textContent = `$${currentValue.toLocaleString()}`;
            
            // Update current prices
            const btcPrice = 67234 + Math.floor(Math.random() * 200 - 100);
            const ethPrice = 3456 + Math.floor(Math.random() * 20 - 10);
            
            const btcCurrent = document.getElementById('btc-current');
            const ethCurrent = document.getElementById('eth-current');
            const btcIndex = document.getElementById('btc-index');
            const ethIndex = document.getElementById('eth-index');
            const solIndex = document.getElementById('sol-index');
            
            if (btcCurrent) btcCurrent.textContent = `$${btcPrice.toLocaleString()}`;
            if (ethCurrent) ethCurrent.textContent = `$${ethPrice.toLocaleString()}`;
            if (btcIndex) btcIndex.textContent = `$${btcPrice.toLocaleString()}`;
            if (ethIndex) ethIndex.textContent = `$${ethPrice.toLocaleString()}`;
            if (solIndex) solIndex.textContent = `$${(123 + Math.random() * 5).toFixed(2)}`;
        }

        function addTransaction() {
            const types = ['Cross-Exchange Arb', 'Statistical Pairs', 'Triangular Arb'];
            const assets = ['BTC 1.5 executed', 'ETH/BTC pair', 'SOL 100 executed'];
            const profits = [127, 203, 95, 156, 284];
            
            const container = document.getElementById('recent-transactions');
            if (!container) return;
            
            const newTransaction = document.createElement('div');
            newTransaction.className = 'transaction-item';
            newTransaction.innerHTML = `
                <div class="transaction-details">
                    <div class="transaction-type">${types[Math.floor(Math.random() * types.length)]}</div>
                    <div class="transaction-info">${assets[Math.floor(Math.random() * assets.length)]}</div>
                </div>
                <div class="transaction-profit">+$${profits[Math.floor(Math.random() * profits.length)]}</div>
                <div class="transaction-time">just now</div>
            `;
            
            container.insertBefore(newTransaction, container.firstChild);
            
            // Keep only 5 transactions
            while (container.children.length > 5) {
                container.removeChild(container.lastChild);
            }
        }

        // Initialize updates
        setInterval(updateTime, 1000);
        setInterval(updatePortfolio, 3000);
        setInterval(addTransaction, 8000);

        // Initial calls
        updateTime();
        updatePortfolio();

        // ==================== BACKTESTING FUNCTIONS ====================
        
        async function runBacktest() {
            // Update status
            const statusBadge = document.getElementById('backtestStatus');
            statusBadge.textContent = 'Running...';
            statusBadge.style.background = 'var(--warning)';
            
            // Get configuration
            const config = {
                startDate: document.getElementById('btStartDate').value,
                endDate: document.getElementById('btEndDate').value,
                initialCapital: parseFloat(document.getElementById('btCapital').value),
                strategy: document.getElementById('btStrategy').value,
                slippage: document.getElementById('btSlippage').value,
                commission: parseFloat(document.getElementById('btCommission').value) / 100
            };
            
            // Simulate backtest (mock results for demo)
            setTimeout(() => {
                const results = {
                    totalReturn: 0.45 + Math.random() * 0.3,
                    sharpe: 2.3 + Math.random(),
                    maxDD: -(0.08 + Math.random() * 0.1),
                    winRate: 0.65 + Math.random() * 0.15,
                    profitFactor: 2.1 + Math.random(),
                    calmar: 3.5 + Math.random(),
                    var95: -(0.02 + Math.random() * 0.02),
                    cvar95: -(0.03 + Math.random() * 0.02),
                    volatility: 0.15 + Math.random() * 0.1,
                    sortino: 2.8 + Math.random(),
                    beta: 0.8 + Math.random() * 0.4,
                    totalTrades: Math.floor(500 + Math.random() * 500),
                    winningTrades: Math.floor(300 + Math.random() * 300),
                    losingTrades: Math.floor(100 + Math.random() * 200),
                    avgWin: 250 + Math.random() * 150,
                    avgLoss: -(100 + Math.random() * 50),
                    bestTrade: 1000 + Math.random() * 500
                };
                
                // Update UI
                document.getElementById('btTotalReturn').textContent = `${(results.totalReturn * 100).toFixed(2)}%`;
                document.getElementById('btSharpe').textContent = results.sharpe.toFixed(2);
                document.getElementById('btMaxDD').textContent = `${(results.maxDD * 100).toFixed(2)}%`;
                document.getElementById('btWinRate').textContent = `${(results.winRate * 100).toFixed(1)}%`;
                document.getElementById('btProfitFactor').textContent = results.profitFactor.toFixed(2);
                document.getElementById('btCalmar').textContent = results.calmar.toFixed(2);
                document.getElementById('btVaR').textContent = `${(results.var95 * 100).toFixed(2)}%`;
                document.getElementById('btCVaR').textContent = `${(results.cvar95 * 100).toFixed(2)}%`;
                document.getElementById('btVolatility').textContent = `${(results.volatility * 100).toFixed(1)}%`;
                document.getElementById('btSortino').textContent = results.sortino.toFixed(2);
                document.getElementById('btBeta').textContent = results.beta.toFixed(2);
                document.getElementById('btTotalTrades').textContent = results.totalTrades;
                document.getElementById('btWinningTrades').textContent = results.winningTrades;
                document.getElementById('btLosingTrades').textContent = results.losingTrades;
                document.getElementById('btAvgWin').textContent = `$${results.avgWin.toFixed(2)}`;
                document.getElementById('btAvgLoss').textContent = `$${results.avgLoss.toFixed(2)}`;
                document.getElementById('btBestTrade').textContent = `$${results.bestTrade.toFixed(2)}`;
                
                statusBadge.textContent = 'Complete';
                statusBadge.style.background = 'var(--success)';
                
                // Draw equity curve (simplified)
                drawEquityChart();
            }, 2000);
        }
        
        function runMonteCarloSimulation() {
            alert('Running 1000 Monte Carlo simulations...\nThis will test strategy robustness across different market conditions.');
        }
        
        function runWalkForward() {
            alert('Running Walk-Forward Optimization...\nThis will optimize parameters using rolling windows.');
        }
        
        function drawEquityChart() {
            const canvas = document.getElementById('equityChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.parentElement.offsetWidth - 40;
            canvas.height = 250;
            
            // Generate mock equity curve
            const points = 100;
            const data = [];
            let value = 100000;
            
            for (let i = 0; i < points; i++) {
                value *= (1 + (Math.random() - 0.45) * 0.02);
                data.push(value);
            }
            
            // Draw chart
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = 'var(--brown-dark)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const maxVal = Math.max(...data);
            const minVal = Math.min(...data);
            const range = maxVal - minVal;
            
            data.forEach((val, i) => {
                const x = (i / points) * canvas.width;
                const y = canvas.height - ((val - minVal) / range) * canvas.height;
                
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            
            ctx.stroke();
        }
        
        // ==================== PAPER TRADING FUNCTIONS ====================
        
        let paperAccount = null;
        let paperPositions = [];
        let paperOrders = [];
        let paperTrades = [];
        
        function createPaperAccount() {
            paperAccount = {
                id: 'paper_' + Date.now(),
                balance: 100000,
                equity: 100000,
                buyingPower: 200000,
                totalPnL: 0
            };
            
            updatePaperAccountDisplay();
            alert('Paper trading account created with $100,000 virtual capital!');
        }
        
        function updatePaperAccountDisplay() {
            if (!paperAccount) return;
            
            document.getElementById('paperBalance').textContent = 
                `$${paperAccount.balance.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            document.getElementById('paperEquity').textContent = 
                `$${paperAccount.equity.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            document.getElementById('paperBuyingPower').textContent = 
                `$${paperAccount.buyingPower.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            document.getElementById('paperPnL').textContent = 
                `$${paperAccount.totalPnL.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            
            // Update color based on P&L
            const pnlElement = document.getElementById('paperPnL');
            pnlElement.style.color = paperAccount.totalPnL >= 0 ? 'var(--success)' : 'var(--danger)';
        }
        
        function placePaperOrder() {
            if (!paperAccount) {
                alert('Please create a paper account first!');
                return;
            }
            
            const order = {
                id: 'order_' + Date.now(),
                symbol: document.getElementById('paperSymbol').value,
                side: document.getElementById('paperSide').value,
                type: document.getElementById('paperOrderType').value,
                quantity: parseFloat(document.getElementById('paperQuantity').value),
                limitPrice: parseFloat(document.getElementById('paperLimitPrice').value) || null,
                timestamp: new Date().toLocaleTimeString()
            };
            
            // Mock execution for market orders
            if (order.type === 'MARKET') {
                executePaperOrder(order);
            } else {
                paperOrders.push(order);
                updatePaperOrdersDisplay();
            }
        }
        
        function executePaperOrder(order) {
            // Mock prices
            const prices = {
                'BTC/USD': 50000 + Math.random() * 1000,
                'ETH/USD': 3000 + Math.random() * 100,
                'SOL/USD': 100 + Math.random() * 10,
                'AVAX/USD': 35 + Math.random() * 5
            };
            
            const price = prices[order.symbol] || 100;
            const cost = price * order.quantity;
            
            if (order.side === 'BUY') {
                if (cost > paperAccount.buyingPower) {
                    alert('Insufficient buying power!');
                    return;
                }
                
                // Add position
                const existingPos = paperPositions.find(p => p.symbol === order.symbol);
                if (existingPos) {
                    const totalQty = existingPos.quantity + order.quantity;
                    const totalCost = (existingPos.quantity * existingPos.entryPrice) + cost;
                    existingPos.quantity = totalQty;
                    existingPos.entryPrice = totalCost / totalQty;
                } else {
                    paperPositions.push({
                        symbol: order.symbol,
                        quantity: order.quantity,
                        entryPrice: price,
                        currentPrice: price
                    });
                }
                
                paperAccount.balance -= cost;
                paperAccount.buyingPower -= cost;
            } else {
                // Sell logic
                const position = paperPositions.find(p => p.symbol === order.symbol);
                if (!position || position.quantity < order.quantity) {
                    alert('Insufficient position to sell!');
                    return;
                }
                
                const profit = (price - position.entryPrice) * order.quantity;
                paperAccount.totalPnL += profit;
                paperAccount.balance += price * order.quantity;
                paperAccount.buyingPower += price * order.quantity;
                
                position.quantity -= order.quantity;
                if (position.quantity === 0) {
                    paperPositions = paperPositions.filter(p => p.symbol !== order.symbol);
                }
            }
            
            // Record trade
            paperTrades.push({
                ...order,
                fillPrice: price,
                pnl: order.side === 'SELL' ? (price - (paperPositions.find(p => p.symbol === order.symbol)?.entryPrice || price)) * order.quantity : 0
            });
            
            updatePaperAccountDisplay();
            updatePaperPositionsDisplay();
            updatePaperTradeHistory();
            updatePaperPerformance();
        }
        
        function updatePaperPositionsDisplay() {
            const tbody = document.getElementById('paperPositions');
            if (paperPositions.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="padding: 1rem; text-align: center; color: var(--brown-text);">No open positions</td></tr>';
                return;
            }
            
            tbody.innerHTML = paperPositions.map(pos => {
                const currentPrice = pos.currentPrice + (Math.random() - 0.5) * 10;
                const pnl = (currentPrice - pos.entryPrice) * pos.quantity;
                const pnlColor = pnl >= 0 ? 'var(--success)' : 'var(--danger)';
                
                return `
                    <tr>
                        <td style="padding: 0.5rem;">${pos.symbol}</td>
                        <td style="padding: 0.5rem; text-align: right;">${pos.quantity.toFixed(2)}</td>
                        <td style="padding: 0.5rem; text-align: right;">$${pos.entryPrice.toFixed(2)}</td>
                        <td style="padding: 0.5rem; text-align: right;">$${currentPrice.toFixed(2)}</td>
                        <td style="padding: 0.5rem; text-align: right; color: ${pnlColor};">$${pnl.toFixed(2)}</td>
                        <td style="padding: 0.5rem; text-align: center;">
                            <button onclick="closePaperPosition('${pos.symbol}')" style="padding: 0.25rem 0.5rem; background: var(--danger); color: white; border: none; border-radius: 4px; cursor: pointer;">Close</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function closePaperPosition(symbol) {
            const position = paperPositions.find(p => p.symbol === symbol);
            if (!position) return;
            
            // Create sell order
            const order = {
                id: 'order_' + Date.now(),
                symbol: symbol,
                side: 'SELL',
                type: 'MARKET',
                quantity: position.quantity,
                timestamp: new Date().toLocaleTimeString()
            };
            
            executePaperOrder(order);
        }
        
        function updatePaperOrdersDisplay() {
            const container = document.getElementById('paperOrders');
            if (paperOrders.length === 0) {
                container.innerHTML = '<div style="padding: 1rem; text-align: center; color: var(--brown-text);">No open orders</div>';
                return;
            }
            
            container.innerHTML = paperOrders.map(order => `
                <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; margin-bottom: 0.5rem;">
                    <div style="display: flex; justify-content: space-between;">
                        <span>${order.symbol} ${order.side}</span>
                        <span>${order.quantity} @ ${order.limitPrice || 'Market'}</span>
                    </div>
                </div>
            `).join('');
        }
        
        function updatePaperTradeHistory() {
            const container = document.getElementById('paperTradeHistory');
            if (paperTrades.length === 0) {
                container.innerHTML = '<div style="padding: 1rem; text-align: center; color: var(--brown-text);">No trades yet</div>';
                return;
            }
            
            container.innerHTML = paperTrades.slice(-10).reverse().map(trade => {
                const pnlColor = trade.pnl >= 0 ? 'var(--success)' : 'var(--danger)';
                return `
                    <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 4px; margin-bottom: 0.5rem;">
                        <div style="display: flex; justify-content: space-between;">
                            <div>
                                <strong>${trade.symbol}</strong> ${trade.side}
                                <div style="font-size: 0.7rem; color: var(--brown-text);">${trade.timestamp}</div>
                            </div>
                            <div style="text-align: right;">
                                <div>${trade.quantity} @ $${trade.fillPrice.toFixed(2)}</div>
                                <div style="font-size: 0.8rem; color: ${pnlColor};">P&L: $${trade.pnl.toFixed(2)}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function updatePaperPerformance() {
            const winningTrades = paperTrades.filter(t => t.pnl > 0);
            const losingTrades = paperTrades.filter(t => t.pnl < 0);
            const winRate = paperTrades.length > 0 ? (winningTrades.length / paperTrades.length * 100).toFixed(1) : '--';
            const avgWin = winningTrades.length > 0 ? winningTrades.reduce((sum, t) => sum + t.pnl, 0) / winningTrades.length : 0;
            const avgLoss = losingTrades.length > 0 ? Math.abs(losingTrades.reduce((sum, t) => sum + t.pnl, 0) / losingTrades.length) : 0;
            const profitFactor = avgLoss > 0 ? (avgWin / avgLoss).toFixed(2) : '--';
            
            document.getElementById('paperWinRate').textContent = winRate + '%';
            document.getElementById('paperTotalTrades').textContent = paperTrades.length;
            document.getElementById('paperProfitFactor').textContent = profitFactor;
            document.getElementById('paperAvgWin').textContent = `$${avgWin.toFixed(2)}`;
            document.getElementById('paperAvgLoss').textContent = `-$${avgLoss.toFixed(2)}`;
        }
        
        // Add CSS for real-time status indicator
        const realtimeStyles = document.createElement('style');
        realtimeStyles.innerHTML = `
            .ws-status-container {
                position: fixed;
                top: 70px;
                right: 20px;
                background: var(--cream-light);
                padding: 0.5rem 1rem;
                border-radius: 8px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                display: flex;
                align-items: center;
                gap: 0.5rem;
                z-index: 1000;
            }
            
            .ws-status-indicator {
                width: 10px;
                height: 10px;
                border-radius: 50%;
                background: #ccc;
                animation: pulse 2s infinite;
            }
            
            .ws-status-indicator.connected {
                background: #4CAF50;
            }
            
            .ws-status-indicator.disconnected {
                background: #f44336;
                animation: none;
            }
            
            @keyframes pulse {
                0% { opacity: 1; }
                50% { opacity: 0.5; }
                100% { opacity: 1; }
            }
            
            .price-update {
                animation: highlight 0.3s ease;
            }
            
            @keyframes highlight {
                0% { background-color: rgba(76, 175, 80, 0.2); }
                100% { background-color: transparent; }
            }
            
            .error-notification {
                position: fixed;
                top: 100px;
                right: 20px;
                background: #f44336;
                color: white;
                padding: 1rem;
                border-radius: 8px;
                z-index: 9999;
                animation: slideIn 0.3s ease;
            }
            
            @keyframes slideIn {
                from { transform: translateX(100%); }
                to { transform: translateX(0); }
            }
        `;
        document.head.appendChild(realtimeStyles);
        
        // Add WebSocket status indicator
        const statusContainer = document.createElement('div');
        statusContainer.className = 'ws-status-container';
        statusContainer.innerHTML = `
            <div class="ws-status-indicator" id="wsStatusIndicator"></div>
            <span id="wsStatus">Connecting...</span>
        `;
        document.body.appendChild(statusContainer);

        // ============ AI ASSISTANT FUNCTIONS ============
        
        // AI Assistant Chat Functions
        function sendAiMessage() {
            const input = document.getElementById('ai-chat-input');
            const message = input.value.trim();
            if (!message) return;
            
            // Add user message to chat
            addChatMessage('user', 'You', message);
            input.value = '';
            
            // Show typing indicator
            addTypingIndicator();
            
            // Simulate AI response (replace with actual API call)
            setTimeout(() => {
                removeTypingIndicator();
                const aiResponse = generateAiResponse(message);
                addChatMessage('ai', 'GOMNA AI', aiResponse);
            }, 1500);
        }
        
        function addChatMessage(type, sender, message) {
            const messagesContainer = document.getElementById('ai-chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `${type}-message`;
            messageDiv.style.marginBottom = '1rem';
            
            const timestamp = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            if (type === 'ai') {
                messageDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">AI</div>
                        <span style="font-weight: 600; color: var(--purple);">${sender}</span>
                        <span style="font-size: 0.7rem; color: var(--brown-text);">${timestamp}</span>
                    </div>
                    <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid var(--purple);">${message}</div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; justify-content: flex-end;">
                        <span style="font-size: 0.7rem; color: var(--brown-text);">${timestamp}</span>
                        <span style="font-weight: 600; color: var(--brown-dark);">${sender}</span>
                        <div style="width: 24px; height: 24px; border-radius: 50%; background: var(--brown-dark); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">U</div>
                    </div>
                    <div style="background: var(--brown-dark); color: white; padding: 0.75rem; border-radius: 8px; text-align: right;">${message}</div>
                `;
            }
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function addTypingIndicator() {
            const messagesContainer = document.getElementById('ai-chat-messages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.style.marginBottom = '1rem';
            typingDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">AI</div>
                    <span style="font-weight: 600; color: var(--purple);">GOMNA AI</span>
                    <span style="font-size: 0.7rem; color: var(--brown-text);">typing...</span>
                </div>
                <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid var(--purple);">
                    <div style="display: flex; gap: 4px;">
                        <div style="width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: pulse 1.5s infinite;"></div>
                        <div style="width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: pulse 1.5s infinite 0.5s;"></div>
                        <div style="width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: pulse 1.5s infinite 1s;"></div>
                    </div>
                </div>
            `;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        function generateAiResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            
            // Market analysis responses
            if (lowerMessage.includes('market') || lowerMessage.includes('analysis')) {
                return `üìà <strong>Market Analysis</strong><br><br>
                    Current market sentiment is <span style="color: var(--success); font-weight: 600;">bullish (+0.73)</span>. I'm detecting:
                    <br><br>
                    ‚Ä¢ Strong institutional inflows (+$2.4B in 24h)<br>
                    ‚Ä¢ Cross-chain arbitrage opportunities in DeFi<br>
                    ‚Ä¢ Reduced volatility in BTC/ETH pairs<br>
                    ‚Ä¢ High correlation breakdown between majors<br><br>
                    <strong>Recommendation:</strong> Focus on SOL-based arbitrage strategies with 94% confidence rating.`;
            }
            
            // Arbitrage responses
            if (lowerMessage.includes('arbitrage') || lowerMessage.includes('opportunity')) {
                return `üéØ <strong>Live Arbitrage Opportunities</strong><br><br>
                    I've identified <span style="color: var(--success); font-weight: 600;">3 high-probability trades</span>:
                    <br><br>
                    <strong>1. SOL/ETH Cross-Exchange</strong><br>
                    ‚Ä¢ Expected profit: 1.23%<br>
                    ‚Ä¢ Risk level: Low<br>
                    ‚Ä¢ Execution window: 4.2 minutes<br><br>
                    <strong>2. AVAX Triangular (Binance-Uniswap)</strong><br>
                    ‚Ä¢ Expected profit: 0.89%<br>
                    ‚Ä¢ Risk level: Medium<br>
                    ‚Ä¢ Gas optimization required<br><br>
                    Would you like me to set up auto-execution for any of these?`;
            }
            
            // Portfolio responses
            if (lowerMessage.includes('portfolio') || lowerMessage.includes('optimize')) {
                return `‚öñÔ∏è <strong>Portfolio Optimization</strong><br><br>
                    Your current portfolio shows <span style="color: var(--success); font-weight: 600;">excellent diversification (A+ rating)</span>.
                    <br><br>
                    <strong>Current allocation:</strong><br>
                    ‚Ä¢ Hyperbolic strategies: 45%<br>
                    ‚Ä¢ Statistical arbitrage: 28%<br>
                    ‚Ä¢ Cross-chain opportunities: 18%<br>
                    ‚Ä¢ Risk hedge positions: 9%<br><br>
                    <strong>AI Suggestion:</strong> Consider increasing cross-chain exposure by 3-5% based on current market inefficiencies.`;
            }
            
            // Risk assessment responses  
            if (lowerMessage.includes('risk') || lowerMessage.includes('danger')) {
                return `üõ°Ô∏è <strong>Risk Assessment</strong><br><br>
                    Current risk levels are <span style="color: var(--success); font-weight: 600;">within optimal parameters</span>.
                    <br><br>
                    <strong>Key metrics:</strong><br>
                    ‚Ä¢ VaR (95%): -2.1% (Excellent)<br>
                    ‚Ä¢ Sharpe ratio: 3.47 (Outstanding)<br>
                    ‚Ä¢ Max drawdown: 4.3% (Low)<br>
                    ‚Ä¢ Correlation risk: Minimal<br><br>
                    <strong>Alert:</strong> Volatility spike expected in 2 hours. Consider reducing position sizes temporarily.`;
            }
            
            // Strategy responses
            if (lowerMessage.includes('strategy') || lowerMessage.includes('generate')) {
                return `üß† <strong>Custom Strategy Generation</strong><br><br>
                    Based on current market conditions, I recommend a <span style="color: var(--purple); font-weight: 600;">Multi-Layer Hyperbolic Strategy</span>:
                    <br><br>
                    <strong>Layer 1:</strong> Poincar√© embedding detection<br>
                    <strong>Layer 2:</strong> Sentiment arbitrage overlay<br>
                    <strong>Layer 3:</strong> Cross-exchange execution<br><br>
                    <strong>Expected metrics:</strong><br>
                    ‚Ä¢ Annual return: 34.2%<br>
                    ‚Ä¢ Max drawdown: 5.1%<br>
                    ‚Ä¢ Win rate: 73.6%<br><br>
                    Would you like me to configure this for backtesting?`;
            }
            
            // Backtesting responses
            if (lowerMessage.includes('backtest') || lowerMessage.includes('test')) {
                return `üìä <strong>Backtesting Recommendation</strong><br><br>
                    For optimal results, I suggest testing with:
                    <br><br>
                    <strong>Timeframe:</strong> Last 18 months<br>
                    <strong>Capital:</strong> $100,000 initial<br>
                    <strong>Strategy:</strong> Hyperbolic arbitrage<br>
                    <strong>Slippage model:</strong> Realistic market impact<br><br>
                    <strong>Expected historical performance:</strong><br>
                    ‚Ä¢ Total return: +67.3%<br>
                    ‚Ä¢ Sharpe ratio: 2.89<br>
                    ‚Ä¢ Maximum drawdown: 8.2%<br><br>
                    Navigate to the üìä Backtesting tab to run this configuration.`;
            }
            
            // Default response
            return `ü§ñ <strong>How can I help you?</strong><br><br>
                I'm your advanced trading intelligence system. I can assist with:
                <br><br>
                ‚Ä¢ <strong>Real-time analysis</strong> of market conditions<br>
                ‚Ä¢ <strong>Arbitrage detection</strong> across multiple exchanges<br>
                ‚Ä¢ <strong>Portfolio optimization</strong> using AI algorithms<br>
                ‚Ä¢ <strong>Risk management</strong> and assessment<br>
                ‚Ä¢ <strong>Strategy development</strong> and backtesting<br>
                ‚Ä¢ <strong>Paper trading</strong> guidance and setup<br><br>
                Try asking: "Analyze current market conditions" or "Find arbitrage opportunities"`;
        }
        
        // AI Quick Action Functions
        function analyzeMarketConditions() {
            addChatMessage('ai', 'GOMNA AI', `üìà <strong>Real-Time Market Analysis</strong><br><br>
                <span style="color: var(--success); font-weight: 600;">Market Sentiment: Bullish (+0.73)</span><br><br>
                <strong>Key Indicators:</strong><br>
                ‚Ä¢ Fear & Greed Index: 67 (Greed)<br>
                ‚Ä¢ Institutional flow: +$2.4B (24h)<br>
                ‚Ä¢ DeFi TVL: $48.2B (+3.2%)<br>
                ‚Ä¢ Cross-chain bridge volume: +18%<br><br>
                <strong>Sector Performance:</strong><br>
                ‚Ä¢ Layer 1s: +4.2% (Leading)<br>
                ‚Ä¢ DeFi tokens: +2.8%<br>
                ‚Ä¢ Infrastructure: +1.9%<br>
                ‚Ä¢ Meme coins: -1.2%<br><br>
                <strong>AI Prediction:</strong> Expect continued upward momentum for next 6-12 hours.`);
        }
        
        function findArbitrageOpportunities() {
            addChatMessage('ai', 'GOMNA AI', `üéØ <strong>Live Arbitrage Scanner Results</strong><br><br>
                Found <span style="color: var(--success); font-weight: 600;">5 active opportunities</span>:
                <br><br>
                <strong>1. SOL/ETH Cross-Exchange</strong><br>
                Profit: 1.23% | Risk: Low | Confidence: 94%<br><br>
                <strong>2. AVAX Triangular Route</strong><br>
                Profit: 0.89% | Risk: Medium | Confidence: 87%<br><br>
                <strong>3. MATIC Bridge Arbitrage</strong><br>
                Profit: 0.67% | Risk: Low | Confidence: 92%<br><br>
                <strong>4. UNI Governance Premium</strong><br>
                Profit: 0.54% | Risk: High | Confidence: 76%<br><br>
                <strong>5. BTC Futures Contango</strong><br>
                Profit: 0.43% | Risk: Low | Confidence: 91%<br><br>
                Execute trades directly from the dashboard or set up auto-execution.`);
        }
        
        function optimizePortfolio() {
            addChatMessage('ai', 'GOMNA AI', `‚öñÔ∏è <strong>Portfolio Optimization Complete</strong><br><br>
                <span style="color: var(--success); font-weight: 600;">Current Rating: A+ (Excellent)</span><br><br>
                <strong>Recommended Rebalancing:</strong><br>
                ‚Ä¢ Increase cross-chain exposure: +3.2%<br>
                ‚Ä¢ Reduce correlated positions: -1.8%<br>
                ‚Ä¢ Add volatility hedges: +2.1%<br><br>
                <strong>Expected Impact:</strong><br>
                ‚Ä¢ Risk reduction: 12.3%<br>
                ‚Ä¢ Return improvement: +4.7%<br>
                ‚Ä¢ Sharpe ratio: 3.47 ‚Üí 3.62<br><br>
                <strong>AI Insight:</strong> Your diversification across 12 strategies is optimal. Minor adjustments could improve risk-adjusted returns by 8%.`);
        }
        
        function assessRisk() {
            addChatMessage('ai', 'GOMNA AI', `üõ°Ô∏è <strong>Comprehensive Risk Assessment</strong><br><br>
                <span style="color: var(--success); font-weight: 600;">Overall Risk Level: LOW-MODERATE</span><br><br>
                <strong>Risk Metrics:</strong><br>
                ‚Ä¢ Value at Risk (95%): -2.1%<br>
                ‚Ä¢ Expected Shortfall: -3.4%<br>
                ‚Ä¢ Maximum Drawdown: 4.3%<br>
                ‚Ä¢ Sharpe Ratio: 3.47<br>
                ‚Ä¢ Sortino Ratio: 4.21<br><br>
                <strong>Risk Factors:</strong><br>
                ‚Ä¢ ‚úÖ Correlation risk: Minimal<br>
                ‚Ä¢ ‚úÖ Liquidity risk: Low<br>
                ‚Ä¢ ‚ö†Ô∏è Volatility spike risk: Medium (next 2h)<br>
                ‚Ä¢ ‚úÖ Counterparty risk: Low<br><br>
                <strong>Recommendation:</strong> Maintain current position sizes. Consider temporary reduction during upcoming volatility window.`);
        }
        
        function generateStrategy() {
            addChatMessage('ai', 'GOMNA AI', `üß† <strong>AI Strategy Generation</strong><br><br>
                Generated: <span style="color: var(--purple); font-weight: 600;">"Adaptive Hyperbolic Momentum Strategy"</span><br><br>
                <strong>Strategy Components:</strong><br>
                ‚Ä¢ Poincar√© embedding for asset positioning<br>
                ‚Ä¢ Momentum overlay with volatility adjustment<br>
                ‚Ä¢ Cross-exchange execution optimization<br>
                ‚Ä¢ Dynamic risk management<br><br>
                <strong>Backtested Performance (18m):</strong><br>
                ‚Ä¢ Total Return: +84.2%<br>
                ‚Ä¢ Annual Sharpe: 3.1<br>
                ‚Ä¢ Max Drawdown: 6.7%<br>
                ‚Ä¢ Win Rate: 76.3%<br><br>
                <strong>Market Conditions:</strong> Optimal for trending markets with moderate volatility.<br><br>
                Ready to implement this strategy? I can configure it for paper trading first.`);
        }
        
        function backtestRecommendation() {
            addChatMessage('ai', 'GOMNA AI', `üìä <strong>Backtesting Setup Recommendation</strong><br><br>
                <strong>Optimal Configuration:</strong><br>
                ‚Ä¢ Period: Jan 2023 - Present<br>
                ‚Ä¢ Initial Capital: $100,000<br>
                ‚Ä¢ Strategy: Hyperbolic Arbitrage<br>
                ‚Ä¢ Commission: 0.02%<br>
                ‚Ä¢ Slippage: Realistic market impact<br><br>
                <strong>Expected Results:</strong><br>
                ‚Ä¢ Total Return: +67.3%<br>
                ‚Ä¢ Annual Return: +42.1%<br>
                ‚Ä¢ Sharpe Ratio: 2.89<br>
                ‚Ä¢ Max Drawdown: 8.2%<br>
                ‚Ä¢ Win Rate: 71.4%<br><br>
                Navigate to the üìä <strong>Backtesting</strong> tab to run this configuration with full historical analysis.`);
            
            // Auto-switch to backtesting tab after 2 seconds
            setTimeout(() => {
                switchTab('backtesting');
                addChatMessage('ai', 'GOMNA AI', `Switched to Backtesting tab. The recommended configuration has been pre-loaded for you.`);
            }, 2000);
        }

        document.body.appendChild(statusContainer);
    </script>
    
    <!-- Load Real-time Integration -->
    <script src="realtime_integration.js"></script>
    <!-- Advanced Hyperbolic Mathematics and AI Integration -->
    <script>
        // ============================================
        // HYPERBOLIC GEOMETRY & POINCAR√â DISK MATHEMATICS
        // ============================================
        
        class HyperbolicEmbedding {
            constructor(dimensions = 128, curvature = -1.0) {
                this.dimensions = dimensions;
                this.curvature = curvature;
                this.entities = new Map();
                this.canvas = document.getElementById('poincareCanvas');
                this.ctx = this.canvas ? this.canvas.getContext('2d') : null;
                this.entityCounter = 0;
                
                if (this.ctx) {
                    this.initializeVisualization();
                }
            }
            
            // Poincar√© disk distance calculation
            poincareDistance(point1, point2) {
                const [x1, y1] = point1;
                const [x2, y2] = point2;
                
                const norm1Sq = x1 * x1 + y1 * y1;
                const norm2Sq = x2 * x2 + y2 * y2;
                const dotProduct = x1 * x2 + y1 * y2;
                
                const numerator = Math.pow((x2 - x1), 2) + Math.pow((y2 - y1), 2);
                const denominator = (1 - norm1Sq) * (1 - norm2Sq);
                
                if (denominator <= 0) return Infinity;
                
                const distance = Math.acosh(1 + 2 * numerator / denominator);
                return Math.abs(this.curvature) * distance;
            }
            
            // Generate hyperbolic embedding for financial entity
            generateEmbedding(entityId, entityType, relationships = []) {
                // Simulate embedding generation based on entity type and relationships
                const radius = this.getRadiusForEntityType(entityType);
                const angle = (this.entityCounter * 2 * Math.PI) / 50; // Distribute entities
                
                const x = radius * Math.cos(angle);
                const y = radius * Math.sin(angle);
                
                // Ensure point is within Poincar√© disk (|z| < 1)
                const norm = Math.sqrt(x * x + y * y);
                const finalX = norm >= 1 ? x / (norm * 1.1) : x;
                const finalY = norm >= 1 ? y / (norm * 1.1) : y;
                
                const embedding = {
                    id: entityId,
                    type: entityType,
                    coordinates: [finalX, finalY],
                    relationships: relationships,
                    timestamp: Date.now()
                };
                
                this.entities.set(entityId, embedding);
                this.entityCounter++;
                
                return embedding;
            }
            
            // Determine radius based on entity type (core vs periphery)
            getRadiusForEntityType(entityType) {
                const typeRadii = {
                    'arbitrage_strategy': 0.2,      // Core strategies
                    'sentiment_strategy': 0.6,      // Periphery strategies
                    'cross_exchange': 0.4,          // Mid-level
                    'statistical_pairs': 0.5,      // Mid-periphery
                    'economic_trend': 0.7,          // Outer periphery
                    'btc': 0.15,                   // Central assets
                    'eth': 0.18,
                    'sol': 0.35,
                    'avax': 0.45
                };
                
                return typeRadii[entityType] || 0.5;
            }
            
            // Initialize Poincar√© disk visualization
            initializeVisualization() {
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                const radius = Math.min(centerX, centerY) - 10;
                
                // Clear canvas and draw Poincar√© disk boundary
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Draw disk boundary
                this.ctx.strokeStyle = '#8B5A2B';
                this.ctx.lineWidth = 2;
                this.ctx.beginPath();
                this.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                this.ctx.stroke();
                
                // Draw grid lines for hyperbolic geometry
                this.drawHyperbolicGrid(centerX, centerY, radius);
                
                // Generate sample entities and visualize
                this.generateSampleEntities();
                this.visualizeEntities();
            }
            
            // Draw hyperbolic grid lines
            drawHyperbolicGrid(centerX, centerY, radius) {
                this.ctx.strokeStyle = 'rgba(139, 90, 43, 0.2)';
                this.ctx.lineWidth = 1;
                
                // Draw radial lines
                for (let i = 0; i < 8; i++) {
                    const angle = (i * Math.PI) / 4;
                    this.ctx.beginPath();
                    this.ctx.moveTo(centerX, centerY);
                    this.ctx.lineTo(
                        centerX + radius * Math.cos(angle),
                        centerY + radius * Math.sin(angle)
                    );
                    this.ctx.stroke();
                }
                
                // Draw concentric circles (hyperbolic distance levels)
                for (let r = radius * 0.2; r < radius; r += radius * 0.2) {
                    this.ctx.beginPath();
                    this.ctx.arc(centerX, centerY, r, 0, 2 * Math.PI);
                    this.ctx.stroke();
                }
            }
            
            // Generate sample financial entities
            generateSampleEntities() {
                // Generate strategy entities
                this.generateEmbedding('arbitrage_btc_eth', 'arbitrage_strategy', ['btc', 'eth']);
                this.generateEmbedding('sentiment_finbert', 'sentiment_strategy', ['news', 'social']);
                this.generateEmbedding('cross_binance_coinbase', 'cross_exchange', ['binance', 'coinbase']);
                this.generateEmbedding('statistical_sol_avax', 'statistical_pairs', ['sol', 'avax']);
                this.generateEmbedding('economic_cpi_trend', 'economic_trend', ['cpi', 'fed']);
                
                // Generate asset entities
                this.generateEmbedding('btc_usd', 'btc', ['binance', 'coinbase', 'kraken']);
                this.generateEmbedding('eth_usd', 'eth', ['binance', 'coinbase', 'uniswap']);
                this.generateEmbedding('sol_usd', 'sol', ['binance', 'ftx', 'raydium']);
                this.generateEmbedding('avax_usd', 'avax', ['binance', 'trader_joe']);
            }
            
            // Visualize entities on Poincar√© disk
            visualizeEntities() {
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                const radius = Math.min(centerX, centerY) - 10;
                
                const colors = {
                    'arbitrage_strategy': '#FF6B35',
                    'sentiment_strategy': '#4ECDC4',
                    'cross_exchange': '#45B7D1',
                    'statistical_pairs': '#F7DC6F',
                    'economic_trend': '#BB8FCE',
                    'btc': '#F7931A',
                    'eth': '#627EEA',
                    'sol': '#14F195',
                    'avax': '#E84142'
                };
                
                this.entities.forEach((entity, id) => {
                    const [x, y] = entity.coordinates;
                    const screenX = centerX + x * radius;
                    const screenY = centerY + y * radius;
                    
                    // Draw entity point
                    this.ctx.fillStyle = colors[entity.type] || '#8B5A2B';
                    this.ctx.beginPath();
                    this.ctx.arc(screenX, screenY, 6, 0, 2 * Math.PI);
                    this.ctx.fill();
                    
                    // Draw entity label
                    this.ctx.fillStyle = '#3E2E1F';
                    this.ctx.font = '10px Inter';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillText(id.split('_')[0].toUpperCase(), screenX, screenY - 10);
                });
            }
            
            // Find arbitrage opportunities based on hyperbolic distances
            findArbitrageOpportunities() {
                const opportunities = [];
                const entities = Array.from(this.entities.values());
                
                for (let i = 0; i < entities.length; i++) {
                    for (let j = i + 1; j < entities.length; j++) {
                        const entity1 = entities[i];
                        const entity2 = entities[j];
                        
                        // Calculate hyperbolic distance
                        const distance = this.poincareDistance(entity1.coordinates, entity2.coordinates);
                        
                        // Opportunities arise from significant distances between related entities
                        if (distance > 0.5 && distance < 2.0 && this.areRelated(entity1, entity2)) {
                            const profit = this.estimateProfit(distance);
                            
                            opportunities.push({
                                entity1: entity1.id,
                                entity2: entity2.id,
                                distance: distance,
                                estimatedProfit: profit,
                                confidence: Math.min(95, 60 + (2.0 - distance) * 20),
                                type: this.getOpportunityType(entity1, entity2)
                            });
                        }
                    }
                }
                
                // Sort by estimated profit
                return opportunities.sort((a, b) => b.estimatedProfit - a.estimatedProfit);
            }
            
            // Check if two entities are related for arbitrage
            areRelated(entity1, entity2) {
                // Simple heuristic for related entities
                return entity1.relationships.some(rel => entity2.relationships.includes(rel)) ||
                       entity1.type.includes('strategy') || entity2.type.includes('strategy');
            }
            
            // Estimate profit based on hyperbolic distance
            estimateProfit(distance) {
                // Empirical formula: closer distances suggest higher arbitrage potential
                return Math.max(0.05, Math.min(0.5, (2.0 - distance) * 0.2));
            }
            
            // Determine opportunity type
            getOpportunityType(entity1, entity2) {
                if (entity1.type.includes('strategy') || entity2.type.includes('strategy')) {
                    return 'Strategy-Based';
                } else if (entity1.type === entity2.type) {
                    return 'Cross-Exchange';
                } else {
                    return 'Triangular';
                }
            }
        }
        
        // ============================================
        // AI LIVE OPPORTUNITIES AGENT
        // ============================================
        
        class AIOpportunitiesAgent {
            constructor() {
                this.hyperbolicEngine = new HyperbolicEmbedding();
                this.opportunities = [];
                this.isScanning = false;
                this.scanInterval = null;
            }
            
            // Start continuous scanning for opportunities
            startScanning() {
                if (this.isScanning) return;
                
                this.isScanning = true;
                console.log('üîç AI Live Opportunities Agent: Starting continuous scan...');
                
                // Initial scan
                this.scanForOpportunities();
                
                // Schedule periodic scans
                this.scanInterval = setInterval(() => {
                    this.scanForOpportunities();
                }, 5000); // Scan every 5 seconds
            }
            
            // Stop scanning
            stopScanning() {
                this.isScanning = false;
                if (this.scanInterval) {
                    clearInterval(this.scanInterval);
                    this.scanInterval = null;
                }
                console.log('üîç AI Live Opportunities Agent: Scanning stopped');
            }
            
            // Main opportunity scanning logic
            scanForOpportunities() {
                console.log('üîç Scanning for arbitrage opportunities...');
                
                // Update hyperbolic embeddings with latest market data
                this.updateEmbeddings();
                
                // Find opportunities using hyperbolic geometry
                const opportunities = this.hyperbolicEngine.findArbitrageOpportunities();
                
                // Apply AI filtering and ranking
                const enhancedOpportunities = this.applyAIFiltering(opportunities);
                
                // Update opportunities list
                this.opportunities = enhancedOpportunities;
                
                // Update UI
                this.updateOpportunitiesUI();
                
                console.log(`üéØ Found ${enhancedOpportunities.length} AI-enhanced opportunities`);
            }
            
            // Update embeddings based on latest market data
            updateEmbeddings() {
                // Simulate real-time market data updates
                const marketSentiment = Math.random() * 2 - 1; // -1 to +1
                const volatility = Math.random() * 0.5 + 0.1;   // 0.1 to 0.6
                
                // Update FinBERT sentiment embedding
                if (this.hyperbolicEngine.entities.has('sentiment_finbert')) {
                    const entity = this.hyperbolicEngine.entities.get('sentiment_finbert');
                    // Adjust position based on sentiment
                    entity.coordinates[0] += marketSentiment * 0.05;
                    entity.coordinates[1] += volatility * 0.03;
                    
                    // Keep within Poincar√© disk
                    const norm = Math.sqrt(entity.coordinates[0]**2 + entity.coordinates[1]**2);
                    if (norm >= 1) {
                        entity.coordinates[0] /= (norm * 1.1);
                        entity.coordinates[1] /= (norm * 1.1);
                    }
                }
                
                // Update visualization
                if (this.hyperbolicEngine.ctx) {
                    this.hyperbolicEngine.initializeVisualization();
                }
            }
            
            // Apply AI filtering and enhancement to opportunities
            applyAIFiltering(opportunities) {
                return opportunities.map(opp => {
                    // Enhance with AI-driven confidence scoring
                    opp.aiConfidence = this.calculateAIConfidence(opp);
                    
                    // Add AI-generated execution strategy
                    opp.executionStrategy = this.generateExecutionStrategy(opp);
                    
                    // Add risk assessment
                    opp.riskAssessment = this.assessRisk(opp);
                    
                    return opp;
                }).filter(opp => opp.aiConfidence > 70); // Only high-confidence opportunities
            }
            
            // Calculate AI-enhanced confidence score
            calculateAIConfidence(opportunity) {
                let confidence = opportunity.confidence;
                
                // Adjust based on market conditions
                const marketStability = Math.random(); // Simulated market stability
                confidence *= (0.8 + 0.4 * marketStability);
                
                // Adjust based on historical performance
                const historicalSuccess = 0.85; // Simulated historical success rate
                confidence *= historicalSuccess;
                
                return Math.min(99, Math.max(50, confidence));
            }
            
            // Generate AI-driven execution strategy
            generateExecutionStrategy(opportunity) {
                const strategies = [
                    'Gradual entry with 3-stage execution',
                    'Rapid execution within 50ms window',
                    'Split order across multiple exchanges',
                    'Market-making approach with limit orders'
                ];
                
                return strategies[Math.floor(Math.random() * strategies.length)];
            }
            
            // Assess risk using AI models
            assessRisk(opportunity) {
                const riskLevels = ['Low', 'Medium-Low', 'Medium', 'Medium-High', 'High'];
                const riskIndex = Math.floor((2 - opportunity.distance) * 2.5);
                return riskLevels[Math.max(0, Math.min(4, riskIndex))];
            }
            
            // Update UI with discovered opportunities
            updateOpportunitiesUI() {
                const container = document.getElementById('aiOpportunities');
                if (!container) return;
                
                container.innerHTML = '';
                
                this.opportunities.slice(0, 3).forEach(opp => {
                    const oppDiv = document.createElement('div');
                    oppDiv.style.cssText = `
                        padding: 0.75rem;
                        background: white;
                        border-radius: 6px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 0.5rem;
                    `;
                    
                    const profitColor = opp.estimatedProfit > 0.2 ? 'var(--success)' : 
                                       opp.estimatedProfit > 0.1 ? 'var(--warning)' : 'var(--info)';
                    
                    oppDiv.innerHTML = `
                        <div>
                            <div style="font-weight: 600; color: var(--brown-dark);">${opp.type} (${opp.entity1.split('_')[0].toUpperCase()}/${opp.entity2.split('_')[0].toUpperCase()})</div>
                            <div style="font-size: 0.75rem; color: var(--brown-text);">Distance: ${opp.distance.toFixed(3)} | AI Confidence: ${opp.aiConfidence.toFixed(0)}%</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: 600; color: ${profitColor};">+${(opp.estimatedProfit * 100).toFixed(2)}%</div>
                            <button onclick="executeAiOpportunity('${opp.entity1}_${opp.entity2}')" 
                                style="padding: 0.25rem 0.5rem; background: ${profitColor}; color: white; border: none; border-radius: 3px; font-size: 0.7rem; cursor: pointer;">
                                Execute
                            </button>
                        </div>
                    `;
                    
                    container.appendChild(oppDiv);
                });
                
                // Update hyperbolic opportunities display
                this.updateHyperbolicOpportunities();
            }
            
            // Update hyperbolic opportunities sidebar
            updateHyperbolicOpportunities() {
                const hyperbolicContainer = document.getElementById('hyperbolic-opportunities');
                if (!hyperbolicContainer) return;
                
                hyperbolicContainer.innerHTML = '';
                
                this.opportunities.slice(0, 3).forEach(opp => {
                    const oppDiv = document.createElement('div');
                    oppDiv.style.cssText = `
                        padding: 0.3rem;
                        background: var(--cream-light);
                        border-radius: 3px;
                        margin-bottom: 0.3rem;
                    `;
                    
                    const profitColor = opp.estimatedProfit > 0.2 ? 'var(--success)' : 
                                       opp.estimatedProfit > 0.1 ? 'var(--warning)' : 'var(--info)';
                    
                    oppDiv.innerHTML = `
                        <div style="font-weight: 600; color: ${profitColor};">${opp.type}</div>
                        <div style="color: var(--brown-text);">Distance: ${opp.distance.toFixed(3)} | Profit: ${(opp.estimatedProfit * 100).toFixed(2)}%</div>
                    `;
                    
                    hyperbolicContainer.appendChild(oppDiv);
                });
            }
        }
        
        // ============================================
        // LLM QUERY SYSTEM FOR INVESTORS
        // ============================================
        
        class LLMQuerySystem {
            constructor() {
                this.marketData = {};
                this.portfolioData = {};
                this.strategiesData = {};
                this.isOnline = true;
            }
            
            // Process investor queries with financial context
            async processQuery(query, context = 'general') {
                console.log(`ü§ñ LLM Processing query: "${query}" (Context: ${context})`);
                
                // Simulate LLM processing with financial intelligence
                const response = await this.generateFinancialResponse(query, context);
                
                return {
                    query: query,
                    response: response,
                    context: context,
                    timestamp: new Date().toISOString(),
                    confidence: 0.85 + Math.random() * 0.1
                };
            }
            
            // Generate contextual financial response
            async generateFinancialResponse(query, context) {
                // Simulate processing delay
                await new Promise(resolve => setTimeout(resolve, 800 + Math.random() * 1200));
                
                const queryLower = query.toLowerCase();
                
                // Context-aware responses
                if (queryLower.includes('market') || queryLower.includes('outlook')) {
                    return this.generateMarketAnalysis();
                } else if (queryLower.includes('portfolio') || queryLower.includes('allocation')) {
                    return this.generatePortfolioAdvice();
                } else if (queryLower.includes('risk') || queryLower.includes('volatility')) {
                    return this.generateRiskAnalysis();
                } else if (queryLower.includes('strategy') || queryLower.includes('arbitrage')) {
                    return this.generateStrategyExplanation();
                } else if (queryLower.includes('hyperbolic') || queryLower.includes('geometry')) {
                    return this.generateHyperbolicExplanation();
                } else {
                    return this.generateGeneralResponse(query);
                }
            }
            
            // Generate market analysis
            generateMarketAnalysis() {
                const analyses = [
                    `Based on current market microstructure analysis, I'm observing increased institutional flow into DeFi protocols, particularly around Ethereum Layer 2 solutions. The FinBERT sentiment analysis shows a bullish bias (+0.73) driven by regulatory clarity narratives. Key resistance levels to watch: BTC $98,500, ETH $3,800.`,
                    
                    `Current market conditions show a risk-on environment with the VIX declining to 16.2. Cross-exchange arbitrage opportunities are elevated due to increased retail participation creating price discrepancies. Our hyperbolic embedding model indicates SOL and AVAX are positioned for potential breakouts based on their geometric relationships.`,
                    
                    `The economic indicators suggest a hawkish Fed stance is being priced in, with the 10-year treasury yield stabilizing around 4.3%. This creates interesting arbitrage opportunities in interest rate-sensitive crypto assets. Our AI agent has identified 7 high-confidence opportunities in the next 24-48 hours.`
                ];
                
                return analyses[Math.floor(Math.random() * analyses.length)];
            }
            
            // Generate portfolio advice
            generatePortfolioAdvice() {
                const advice = [
                    `Your current portfolio shows excellent diversification across 4 strategy types. The Sharpe ratio of 3.47 indicates superior risk-adjusted returns. I recommend slightly reducing exposure to cross-exchange strategies (currently 35%) and increasing allocation to our top-performing Hyperbolic Poincar√© Arbitrage strategy, which has delivered 94.2% win rate this month.`,
                    
                    `Portfolio analysis reveals optimal capital utilization at 87%. The maximum drawdown of -0.8% is exceptionally low for crypto strategies. Consider rebalancing towards economic trend strategies given current macro conditions - CPI data next week could create significant arbitrage opportunities in rate-sensitive assets.`,
                    
                    `Based on your sophisticated investor profile and long-term horizon, the current allocation appears well-suited. However, I notice correlation clustering in your DeFi positions. The hyperbolic space analysis suggests adding some anti-correlated strategies to improve portfolio robustness during stress periods.`
                ];
                
                return advice[Math.floor(Math.random() * advice.length)];
            }
            
            // Generate risk analysis
            generateRiskAnalysis() {
                const analyses = [
                    `Current portfolio VaR (95% confidence, 1-day horizon) is $18,450, well within your risk tolerance. The strategies show low correlation during stress periods, providing natural diversification. Key risks to monitor: Exchange counterparty risk (3% allocation), smart contract risk in DeFi strategies (12% allocation), and regulatory changes affecting arbitrage activities.`,
                    
                    `Risk assessment shows your portfolio is resilient to market shocks. Stress testing against March 2020 and May 2022 scenarios indicates maximum losses of 4.3% and 6.7% respectively. The hyperbolic risk model suggests current volatility clustering is temporary, with a 78% probability of returning to normal conditions within 5-7 days.`,
                    
                    `The AI risk engine has detected elevated correlation in your cross-exchange positions during high volatility periods. This concentration risk can be mitigated by reducing position sizes during VIX > 25 environments. Current tail risk is minimal with beta-adjusted exposure at 0.67 relative to broader crypto markets.`
                ];
                
                return analyses[Math.floor(Math.random() * analyses.length)];
            }
            
            // Generate strategy explanation
            generateStrategyExplanation() {
                const explanations = [
                    `The Hyperbolic Poincar√© Arbitrage strategy leverages non-Euclidean geometry to identify market inefficiencies. By embedding assets and exchanges in hyperbolic space, we can detect arbitrage opportunities that traditional correlation-based models miss. The negative curvature of hyperbolic space naturally represents the hierarchical structure of financial markets, where central assets (like BTC) influence peripheral ones.`,
                    
                    `Our FinBERT Sentiment Fusion strategy combines transformer-based natural language processing with real-time market data. The model processes 2,340 articles per hour, extracting sentiment scores that are then integrated into the hyperbolic embedding space. This creates a multi-dimensional view of market psychology that traditional sentiment indicators cannot capture.`,
                    
                    `Economic Trend AI strategies integrate real-time macroeconomic indicators with our trading algorithms. When CPI data is released, for example, the system automatically adjusts position sizes and strategy parameters based on historical correlations and current market microstructure. This allows for dynamic adaptation to changing economic conditions.`
                ];
                
                return explanations[Math.floor(Math.random() * explanations.length)];
            }
            
            // Generate hyperbolic geometry explanation
            generateHyperbolicExplanation() {
                return `Hyperbolic geometry is crucial for financial modeling because markets exhibit hierarchical, scale-free properties that Euclidean space cannot properly represent. In the Poincar√© disk model, the distance between two points represents their relationship strength - closer points are more correlated. The boundary of the disk represents infinite distance, naturally modeling extreme market conditions. Our embedding algorithm uses Riemannian optimization to learn these representations, with the curvature parameter (-1.0) controlling the "hierarchy strength" of the market structure.`;
            }
            
            // Generate general response
            generateGeneralResponse(query) {
                return `I understand you're asking about "${query}". As your AI trading assistant, I have access to live market data, sentiment analysis, hyperbolic embeddings, and portfolio metrics. I can help you analyze market conditions, optimize strategies, assess risks, and understand our advanced mathematical models. Would you like me to focus on any particular aspect of your trading or investment objectives?`;
            }
        }
        
        // ============================================
        // GLOBAL INSTANCES AND INITIALIZATION
        // ============================================
        
        let globalAIAgent = null;
        let globalLLM = null;
        let globalHyperbolic = null;
        
        // Initialize AI systems when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize AI systems
            globalHyperbolic = new HyperbolicEmbedding();
            globalAIAgent = new AIOpportunitiesAgent();
            globalLLM = new LLMQuerySystem();
            
            // Start AI agent scanning
            globalAIAgent.startScanning();
            
            console.log('üöÄ GOMNA AI Professional Arbitrage Platform Loading...');
            console.log('üî• INSTITUTIONAL-GRADE HFT TRADING PLATFORM INITIALIZED');
            console.log('üß† Hyperbolic Intelligence Systems: ONLINE');
            console.log('ü§ñ AI Live Opportunities Agent: ACTIVE');
            console.log('üí¨ LLM Query System: READY');
        });
        
        // ============================================
        // UI INTERACTION FUNCTIONS
        // ============================================
        
        // Enhanced AI message sending
        async function sendAiMessage() {
            const input = document.getElementById('ai-chat-input');
            const messagesContainer = document.getElementById('ai-chat-messages');
            
            if (!input || !messagesContainer || !input.value.trim()) return;
            
            const userMessage = input.value.trim();
            input.value = '';
            
            // Add user message to chat
            const userMessageDiv = document.createElement('div');
            userMessageDiv.className = 'user-message';
            userMessageDiv.style.cssText = 'margin-bottom: 1rem;';
            userMessageDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; justify-content: flex-end;">
                    <span style="font-size: 0.7rem; color: var(--brown-text);">Just now</span>
                    <span style="font-weight: 600; color: var(--brown-dark);">You</span>
                    <div style="width: 24px; height: 24px; border-radius: 50%; background: var(--brown-dark); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">U</div>
                </div>
                <div style="background: var(--cream-secondary); padding: 0.75rem; border-radius: 8px; border-right: 3px solid var(--brown-dark); text-align: right;">
                    ${userMessage}
                </div>
            `;
            
            messagesContainer.appendChild(userMessageDiv);
            
            // Show typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">AI</div>
                    <span style="font-weight: 600; color: var(--purple);">GOMNA AI</span>
                    <span style="font-size: 0.7rem; color: var(--brown-text);">is typing...</span>
                </div>
            `;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            try {
                // Process query with LLM
                const result = await globalLLM.processQuery(userMessage);
                
                // Remove typing indicator
                typingDiv.remove();
                
                // Add AI response
                const aiMessageDiv = document.createElement('div');
                aiMessageDiv.className = 'ai-message';
                aiMessageDiv.style.cssText = 'margin-bottom: 1rem;';
                aiMessageDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">AI</div>
                        <span style="font-weight: 600; color: var(--purple);">GOMNA AI</span>
                        <span style="font-size: 0.7rem; color: var(--brown-text);">Just now</span>
                        <span style="font-size: 0.65rem; background: rgba(103, 126, 234, 0.1); color: var(--purple); padding: 0.1rem 0.3rem; border-radius: 8px;">Confidence: ${(result.confidence * 100).toFixed(0)}%</span>
                    </div>
                    <div style="background: white; padding: 0.75rem; border-radius: 8px; border-left: 3px solid var(--purple);">
                        ${result.response}
                    </div>
                `;
                
                messagesContainer.appendChild(aiMessageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                
            } catch (error) {
                console.error('Error processing AI message:', error);
                typingDiv.innerHTML = '<div style="color: var(--danger); font-size: 0.8rem;">Error processing request. Please try again.</div>';
            }
        }
        
        // Update hyperbolic embedding
        function updateHyperbolicEmbedding() {
            if (globalHyperbolic) {
                globalHyperbolic.initializeVisualization();
                console.log('üåê Hyperbolic embedding updated');
            }
        }
        
        // Recenter hyperbolic view
        function recenterHyperbolicView() {
            if (globalHyperbolic) {
                globalHyperbolic.initializeVisualization();
                console.log('üéØ Hyperbolic view recentered');
            }
        }
        
        // Export hyperbolic data
        function exportHyperbolicData() {
            if (globalHyperbolic) {
                const data = {
                    entities: Object.fromEntries(globalHyperbolic.entities),
                    dimensions: globalHyperbolic.dimensions,
                    curvature: globalHyperbolic.curvature,
                    timestamp: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `hyperbolic_coordinates_${Date.now()}.json`;
                a.click();
                
                URL.revokeObjectURL(url);
                console.log('üìÑ Hyperbolic coordinates exported');
            }
        }
        
        // Execute AI-identified opportunity
        function executeAiOpportunity(opportunityId) {
            console.log(`‚ö° Executing AI opportunity: ${opportunityId}`);
            
            // Find the opportunity
            const opportunity = globalAIAgent.opportunities.find(opp => 
                `${opp.entity1}_${opp.entity2}` === opportunityId
            );
            
            if (opportunity) {
                alert(`üöÄ Executing ${opportunity.type} opportunity!\n\n` +
                      `Entities: ${opportunity.entity1} ‚Üî ${opportunity.entity2}\n` +
                      `Expected Profit: +${(opportunity.estimatedProfit * 100).toFixed(2)}%\n` +
                      `AI Confidence: ${opportunity.aiConfidence.toFixed(0)}%\n` +
                      `Risk Level: ${opportunity.riskAssessment}\n` +
                      `Strategy: ${opportunity.executionStrategy}`);
            }
        }
        
        // Algorithm marketplace functions
        function purchaseStrategy(strategyId) {
            console.log(`üí≥ Purchasing strategy: ${strategyId}`);
            alert(`üõí Initiating purchase of ${strategyId} strategy...\n\nRedirecting to secure payment gateway with institutional-grade compliance.`);
        }
        
        function customizeStrategy(strategyId) {
            console.log(`üõ†Ô∏è Customizing strategy: ${strategyId}`);
            alert(`üîß Opening customization studio for ${strategyId}...\n\nYou can adjust parameters, risk settings, and integration options.`);
        }
        
        // Algorithm customization functions
        function previewCustomization() {
            const riskTolerance = document.getElementById('riskTolerance')?.value || 'moderate';
            const positionSize = document.getElementById('positionSize')?.value || '2.5';
            const entryThreshold = document.getElementById('entryThreshold')?.value || '0.15';
            const exitThreshold = document.getElementById('exitThreshold')?.value || '0.08';
            
            alert(`üìä Customization Preview:\n\n` +
                  `Risk Tolerance: ${riskTolerance}\n` +
                  `Position Size: ${positionSize}%\n` +
                  `Entry Threshold: ${entryThreshold}%\n` +
                  `Exit Threshold: ${exitThreshold}%\n\n` +
                  `Estimated Impact: +12% annual return, -23% volatility`);
        }
        
        function deployCustomStrategy() {
            alert('üöÄ Deploying custom strategy to paper trading environment...\n\nLive deployment will be available after successful 48-hour testing period.');
        }
        
        function startSandboxTest() {
            alert('üß™ Starting sandbox testing with $100K virtual capital...\n\nReal-time results will be available in the backtesting tab.');
        }
        
        function validateStrategy() {
            alert('‚úÖ Strategy validation complete!\n\n‚Ä¢ Logic integrity: PASSED\n‚Ä¢ Risk parameters: VALID\n‚Ä¢ Compliance check: APPROVED\n‚Ä¢ Performance projection: 15.7% annual return');
        }
        
        function exportStrategy() {
            alert('üìÑ Exporting strategy configuration...\n\nJSON and Python implementations will be downloaded.');
        }
        
        // Compliance functions
        function updateComplianceInfo() {
            alert('üõ°Ô∏è Opening compliance information update form...\n\nAll changes require identity reverification.');
        }
        
        function generateComplianceReport() {
            alert('üìã Generating institutional compliance report...\n\nReport will include KYC/AML status, transaction history, and regulatory adherence.');
        }
        
        function requestAuditTrail() {
            alert('üîç Preparing comprehensive audit trail...\n\nIncludes all trades, deposits, withdrawals, and system access logs.');
        }
    </script>
    
    <script>
        // Override mock functions with real-time data
        if (window.realtimeTrading) {
            // Replace mock backtest with real-time backtest
            window.runBacktest = function() {
                const config = {
                    initial_capital: parseFloat(document.getElementById('initialCapital').value),
                    risk_per_trade: parseFloat(document.getElementById('riskPerTrade').value) / 100,
                    symbols: ['BTC/USD', 'ETH/USD', 'SOL/USD'],
                    strategy_type: document.getElementById('strategyType').value
                };
                
                // Start real-time backtesting
                window.realtimeTrading.startRealtimeBacktest('default_strategy', config);
                
                // Show loading state
                document.getElementById('backtestStatus').textContent = 'Running...';
                document.getElementById('backtestStatus').className = 'status-running';
            };
            
            // Replace mock paper trading with real-time paper trading
            const originalPlaceOrder = window.placePaperOrder;
            window.placePaperOrder = function() {
                const symbol = document.getElementById('paperSymbol').value;
                const side = document.getElementById('paperSide').value;
                const orderType = document.getElementById('paperOrderType').value;
                const quantity = parseFloat(document.getElementById('paperQuantity').value);
                
                const order = {
                    symbol: symbol,
                    side: side,
                    type: orderType,
                    quantity: quantity,
                    timestamp: new Date().toISOString()
                };
                
                if (orderType === 'LIMIT') {
                    order.limit_price = parseFloat(document.getElementById('paperLimitPrice').value);
                }
                
                // Place order through WebSocket
                window.realtimeTrading.placePaperOrder('default_account', order);
            };
            
            // Create default paper trading account on load
            window.addEventListener('load', () => {
                window.realtimeTrading.createPaperTradingAccount({
                    account_id: 'default_account',
                    initial_balance: 100000,
                    leverage: 1
                });
            });
            
            // Update connection status
            window.realtimeTrading.on('connect', () => {
                document.getElementById('wsStatusIndicator').className = 'ws-status-indicator connected';
                document.getElementById('wsStatus').textContent = 'Connected';
            });
            
            window.realtimeTrading.on('disconnect', () => {
                document.getElementById('wsStatusIndicator').className = 'ws-status-indicator disconnected';
                document.getElementById('wsStatus').textContent = 'Disconnected';
            });
        }

        // ============ BACKTESTING FUNCTIONS ============
        
        function runBacktest() {
            // Get configuration values
            const startDate = document.getElementById('btStartDate').value;
            const endDate = document.getElementById('btEndDate').value;
            const capital = parseFloat(document.getElementById('btCapital').value);
            const strategy = document.getElementById('btStrategy').value;
            const slippage = document.getElementById('btSlippage').value;
            const commission = parseFloat(document.getElementById('btCommission').value) / 100;
            
            // Update status
            document.getElementById('backtestStatus').textContent = 'Running...';
            document.getElementById('backtestStatus').style.background = 'var(--warning)';
            
            // Simulate backtesting process
            setTimeout(() => {
                const results = simulateBacktest(startDate, endDate, capital, strategy, commission);
                displayBacktestResults(results);
                
                document.getElementById('backtestStatus').textContent = 'Complete';
                document.getElementById('backtestStatus').style.background = 'var(--success)';
            }, 3000);
        }
        
        function simulateBacktest(startDate, endDate, capital, strategy, commission) {
            // Simulate realistic backtesting results based on strategy
            const strategyMultipliers = {
                'hyperbolic': { return: 1.67, sharpe: 2.89, maxDD: 0.082, winRate: 0.714 },
                'sentiment': { return: 1.45, sharpe: 2.34, maxDD: 0.095, winRate: 0.683 },
                'triangular': { return: 1.23, sharpe: 3.12, maxDD: 0.067, winRate: 0.756 },
                'statistical': { return: 1.89, sharpe: 2.67, maxDD: 0.112, winRate: 0.692 },
                'cross_exchange': { return: 1.34, sharpe: 2.45, maxDD: 0.074, winRate: 0.738 }
            };
            
            const multiplier = strategyMultipliers[strategy] || strategyMultipliers['hyperbolic'];
            
            // Add some randomness
            const randomFactor = 0.9 + Math.random() * 0.2;
            
            const totalReturn = multiplier.return * randomFactor;
            const finalValue = capital * totalReturn;
            const profit = finalValue - capital;
            const profitPercent = ((totalReturn - 1) * 100);
            
            // Generate monthly returns
            const months = 18; // Approximate months between dates
            const monthlyReturns = [];
            for (let i = 0; i < months; i++) {
                const monthlyReturn = (Math.random() - 0.3) * 0.15; // -4.5% to 10.5% monthly
                monthlyReturns.push(monthlyReturn);
            }
            
            return {
                initialCapital: capital,
                finalValue: finalValue,
                totalReturn: profitPercent,
                profit: profit,
                sharpeRatio: multiplier.sharpe * randomFactor,
                maxDrawdown: multiplier.maxDD * randomFactor * 100,
                winRate: multiplier.winRate * randomFactor * 100,
                totalTrades: Math.floor(450 * randomFactor),
                avgTrade: profit / Math.floor(450 * randomFactor),
                monthlyReturns: monthlyReturns,
                strategy: strategy
            };
        }
        
        function displayBacktestResults(results) {
            // Update performance metrics
            const metricsContainer = document.querySelector('#backtesting-tab .dashboard-grid .card:nth-child(2)');
            if (metricsContainer) {
                const metricsHTML = `
                    <div class="card-header">
                        <h3 class="card-title">üìä Performance Metrics</h3>
                        <span class="badge" style="background: var(--success);">Completed</span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Total Return</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: ${results.totalReturn > 0 ? 'var(--success)' : 'var(--danger)'};">
                                ${results.totalReturn > 0 ? '+' : ''}${results.totalReturn.toFixed(2)}%
                            </div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Sharpe Ratio</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--info);">${results.sharpeRatio.toFixed(2)}</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Max Drawdown</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--danger);">-${results.maxDrawdown.toFixed(2)}%</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Win Rate</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);">${results.winRate.toFixed(1)}%</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Total Trades</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--brown-dark);">${results.totalTrades.toLocaleString()}</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Avg Trade P&L</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: ${results.avgTrade > 0 ? 'var(--success)' : 'var(--danger)'};">
                                $${results.avgTrade.toFixed(2)}
                            </div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Final Portfolio Value</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);">$${results.finalValue.toLocaleString()}</div>
                        </div>
                        
                        <div style="padding: 0.75rem; background: var(--cream-light); border-radius: 6px;">
                            <div style="font-size: 0.7rem; color: var(--brown-text);">Total Profit</div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: ${results.profit > 0 ? 'var(--success)' : 'var(--danger)'};">
                                ${results.profit > 0 ? '+' : ''}$${results.profit.toLocaleString()}
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1rem; padding: 0.75rem; background: linear-gradient(135deg, rgba(103, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 8px;">
                        <div style="font-weight: 600; color: var(--purple); margin-bottom: 0.5rem;">üéØ Strategy Performance: ${results.strategy.toUpperCase()}</div>
                        <div style="font-size: 0.85rem; color: var(--brown-text);">
                            This strategy showed ${results.totalReturn > 50 ? 'exceptional' : results.totalReturn > 20 ? 'strong' : 'moderate'} performance with 
                            ${results.sharpeRatio > 2.5 ? 'excellent' : results.sharpeRatio > 2 ? 'good' : 'acceptable'} risk-adjusted returns.
                        </div>
                    </div>
                `;
                metricsContainer.innerHTML = metricsHTML;
            }
        }
        
        function runMonteCarloSimulation() {
            document.getElementById('backtestStatus').textContent = 'Running Monte Carlo...';
            document.getElementById('backtestStatus').style.background = 'var(--warning)';
            
            setTimeout(() => {
                // Simulate Monte Carlo results
                const results = {
                    runs: 1000,
                    avgReturn: 42.3,
                    stdDev: 18.7,
                    bestCase: 127.8,
                    worstCase: -23.4,
                    probabilityProfit: 78.3
                };
                
                alert(`Monte Carlo Simulation Complete (${results.runs} runs):\n\n` +
                      `Average Return: ${results.avgReturn}%\n` +
                      `Standard Deviation: ${results.stdDev}%\n` +
                      `Best Case: +${results.bestCase}%\n` +
                      `Worst Case: ${results.worstCase}%\n` +
                      `Probability of Profit: ${results.probabilityProfit}%`);
                
                document.getElementById('backtestStatus').textContent = 'Monte Carlo Complete';
                document.getElementById('backtestStatus').style.background = 'var(--success)';
            }, 4000);
        }
        
        function runWalkForward() {
            document.getElementById('backtestStatus').textContent = 'Optimizing...';
            document.getElementById('backtestStatus').style.background = 'var(--warning)';
            
            setTimeout(() => {
                alert('Walk-Forward Optimization Complete:\n\n' +
                      'Optimal Parameters Found:\n' +
                      '‚Ä¢ Risk Factor: 2.3\n' +
                      '‚Ä¢ Position Size: 15%\n' +
                      '‚Ä¢ Rebalance Frequency: 7 days\n' +
                      '‚Ä¢ Stop Loss: 5.5%\n\n' +
                      'Out-of-Sample Performance:\n' +
                      'Return: +34.7% | Sharpe: 2.89');
                
                document.getElementById('backtestStatus').textContent = 'Optimization Complete';
                document.getElementById('backtestStatus').style.background = 'var(--success)';
            }, 5000);
        }

        // ============ PAPER TRADING FUNCTIONS ============
        
        let paperAccount = {
            balance: 0,
            equity: 0,
            buyingPower: 0,
            pnl: 0,
            positions: {},
            orders: [],
            tradeHistory: []
        };
        
        function createPaperAccount() {
            const initialBalance = 100000; // Default $100k paper account
            
            paperAccount = {
                balance: initialBalance,
                equity: initialBalance,
                buyingPower: initialBalance * 4, // 4x leverage
                pnl: 0,
                positions: {},
                orders: [],
                tradeHistory: []
            };
            
            updatePaperAccountDisplay();
            
            // Show success message
            alert('Paper Trading Account Created!\n\n' +
                  `Initial Balance: $${initialBalance.toLocaleString()}\n` +
                  `Buying Power: $${(initialBalance * 4).toLocaleString()}\n\n` +
                  'You can now start paper trading risk-free!');
        }
        
        function updatePaperAccountDisplay() {
            document.getElementById('paperBalance').textContent = `$${paperAccount.balance.toLocaleString()}`;
            document.getElementById('paperEquity').textContent = `$${paperAccount.equity.toLocaleString()}`;
            document.getElementById('paperBuyingPower').textContent = `$${paperAccount.buyingPower.toLocaleString()}`;
            document.getElementById('paperPnL').textContent = paperAccount.pnl >= 0 ? 
                `+$${paperAccount.pnl.toLocaleString()}` : 
                `-$${Math.abs(paperAccount.pnl).toLocaleString()}`;
            
            // Update PnL color
            const pnlElement = document.getElementById('paperPnL');
            pnlElement.style.color = paperAccount.pnl >= 0 ? 'var(--success)' : 'var(--danger)';
        }
        
        function placePaperOrder() {
            const symbol = document.getElementById('paperSymbol').value;
            const orderType = document.getElementById('paperOrderType').value;
            const side = document.getElementById('paperSide').value.toLowerCase();
            const quantity = parseFloat(document.getElementById('paperQuantity').value);
            const limitPrice = parseFloat(document.getElementById('paperLimitPrice').value);
            const price = (orderType === 'LIMIT' && limitPrice) ? limitPrice : getCurrentPrice(symbol);
            
            if (!quantity || quantity <= 0) {
                alert('Please enter a valid quantity');
                return;
            }
            
            // Create order
            const order = {
                id: 'PO' + Date.now(),
                symbol: symbol,
                side: side,
                quantity: quantity,
                orderType: orderType,
                price: price,
                status: 'filled', // Immediately fill paper orders
                timestamp: new Date(),
                pnl: 0
            };
            
            // Execute order
            executePaperOrder(order);
            
            // Clear form
            document.getElementById('paperQuantity').value = '1';
            document.getElementById('paperLimitPrice').value = '';
        }
        
        function executePaperOrder(order) {
            const orderValue = order.quantity * order.price;
            
            if (order.side === 'buy') {
                if (orderValue > paperAccount.buyingPower) {
                    alert('Insufficient buying power!');
                    return;
                }
                
                // Deduct from balance
                paperAccount.balance -= orderValue;
                paperAccount.buyingPower -= orderValue;
                
                // Add to positions
                if (!paperAccount.positions[order.symbol]) {
                    paperAccount.positions[order.symbol] = { quantity: 0, avgPrice: 0, pnl: 0 };
                }
                
                const position = paperAccount.positions[order.symbol];
                const totalQuantity = position.quantity + order.quantity;
                position.avgPrice = ((position.quantity * position.avgPrice) + (order.quantity * order.price)) / totalQuantity;
                position.quantity = totalQuantity;
                
            } else { // sell
                const position = paperAccount.positions[order.symbol];
                if (!position || position.quantity < order.quantity) {
                    alert('Insufficient position to sell!');
                    return;
                }
                
                // Calculate P&L
                const pnl = (order.price - position.avgPrice) * order.quantity;
                paperAccount.pnl += pnl;
                paperAccount.balance += orderValue;
                paperAccount.buyingPower += orderValue;
                
                // Update position
                position.quantity -= order.quantity;
                if (position.quantity === 0) {
                    delete paperAccount.positions[order.symbol];
                }
            }
            
            // Add to trade history
            paperAccount.tradeHistory.push(order);
            
            // Update displays
            updatePaperAccountDisplay();
            updatePositionsDisplay();
            
            // Show confirmation
            alert(`Paper Order Executed!\n\n` +
                  `${order.side.toUpperCase()} ${order.quantity} ${order.symbol}\n` +
                  `Price: $${order.price}\n` +
                  `Value: $${(order.quantity * order.price).toLocaleString()}`);
        }
        
        function getCurrentPrice(symbol) {
            // Simulate current prices
            const prices = {
                'BTC/USD': 67234 + Math.floor(Math.random() * 200 - 100),
                'ETH/USD': 3456 + Math.floor(Math.random() * 20 - 10),
                'SOL/USD': 198 + Math.floor(Math.random() * 10 - 5),
                'AVAX/USD': 89 + Math.floor(Math.random() * 5 - 2.5)
            };
            return prices[symbol] || 100;
        }
        
        function updatePositionsDisplay() {
            // Update positions in the UI if container exists
            const positionsContainer = document.getElementById('paper-positions');
            if (positionsContainer && Object.keys(paperAccount.positions).length > 0) {
                let positionsHTML = '<div style="font-weight: 600; margin-bottom: 0.5rem;">Current Positions:</div>';
                
                for (const [symbol, position] of Object.entries(paperAccount.positions)) {
                    const currentPrice = getCurrentPrice(symbol);
                    const marketValue = position.quantity * currentPrice;
                    const unrealizedPnL = (currentPrice - position.avgPrice) * position.quantity;
                    
                    positionsHTML += `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: var(--cream-light); border-radius: 4px; margin-bottom: 0.25rem;">
                            <div>
                                <div style="font-weight: 600;">${symbol}</div>
                                <div style="font-size: 0.75rem; color: var(--brown-text);">Qty: ${position.quantity} @ $${position.avgPrice.toFixed(2)}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 600;">$${marketValue.toLocaleString()}</div>
                                <div style="font-size: 0.75rem; color: ${unrealizedPnL >= 0 ? 'var(--success)' : 'var(--danger)'};">
                                    ${unrealizedPnL >= 0 ? '+' : ''}$${unrealizedPnL.toFixed(2)}
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                positionsContainer.innerHTML = positionsHTML;
            }
        }
        
        // ============ LIVE DATA & MARKET FUNCTIONS ============
        
        // Live market data simulation
        let liveMarketData = {
            'BTC/USD': { price: 67234, change: 2.34, volume: 2847563000, marketCap: 1320000000000 },
            'ETH/USD': { price: 3456, change: 1.87, volume: 1256789000, marketCap: 415000000000 },
            'SOL/USD': { price: 198, change: 4.56, volume: 345678000, marketCap: 95000000000 },
            'AVAX/USD': { price: 89, change: -1.23, volume: 156789000, marketCap: 37000000000 },
            'MATIC/USD': { price: 1.34, change: 3.45, volume: 89567000, marketCap: 13400000000 },
            'ADA/USD': { price: 0.67, change: -0.89, volume: 234567000, marketCap: 23500000000 },
            'DOT/USD': { price: 12.45, change: 2.13, volume: 145678000, marketCap: 17800000000 },
            'LINK/USD': { price: 23.67, change: 1.56, volume: 189234000, marketCap: 14200000000 }
        };
        
        // Exchange data for arbitrage opportunities
        let exchangeData = {
            'Binance': { fees: 0.1, liquidity: 'High', btc: 67234, eth: 3456, sol: 198 },
            'Coinbase': { fees: 0.5, liquidity: 'High', btc: 67189, eth: 3468, sol: 199.2 },
            'Kraken': { fees: 0.26, liquidity: 'Medium', btc: 67298, eth: 3445, sol: 197.8 },
            'Uniswap': { fees: 0.3, liquidity: 'Medium', btc: 67156, eth: 3471, sol: 198.9 },
            'Sushiswap': { fees: 0.25, liquidity: 'Low', btc: 67301, eth: 3439, sol: 197.1 }
        };
        
        // Portfolio data 
        let portfolioData = {
            totalValue: 2847563,
            dayChange: 342891,
            dayChangePercent: 13.7,
            positions: {
                'BTC': { amount: 19.05, value: 1281403, percentage: 45, avgPrice: 67250, pnl: 12456 },
                'ETH': { amount: 247.2, value: 854269, percentage: 30, avgPrice: 3460, pnl: 8934 },
                'SOL': { amount: 2156.7, value: 427134, percentage: 15, avgPrice: 199, pnl: 5678 },
                'Stablecoins': { amount: 284756, value: 284756, percentage: 10, avgPrice: 1, pnl: 0 }
            }
        };
        
        // Arbitrage opportunities data
        let arbitrageOpportunities = [
            { pair: 'SOL/ETH', exchanges: ['Uniswap', 'Binance'], profit: 1.23, risk: 'Low', confidence: 94, volume: 156789 },
            { pair: 'AVAX/USD', exchanges: ['Coinbase', 'Kraken'], profit: 0.89, risk: 'Medium', confidence: 87, volume: 234567 },
            { pair: 'MATIC/BTC', exchanges: ['Binance', 'Uniswap'], profit: 0.67, risk: 'Low', confidence: 92, volume: 345678 },
            { pair: 'ADA/SOL', exchanges: ['Kraken', 'Sushiswap'], profit: 0.54, risk: 'High', confidence: 76, volume: 123456 },
            { pair: 'BTC/USD', exchanges: ['Coinbase', 'Binance'], profit: 0.43, risk: 'Low', confidence: 91, volume: 987654 }
        ];
        
        function updateLiveMarketData() {
            // Update market prices with realistic fluctuations
            for (const symbol in liveMarketData) {
                const data = liveMarketData[symbol];
                const fluctuation = (Math.random() - 0.5) * 0.002; // ¬±0.1% fluctuation
                data.price *= (1 + fluctuation);
                data.change += fluctuation * 100;
                data.volume *= (0.98 + Math.random() * 0.04); // Volume changes
            }
            
            // Update exchange prices for arbitrage opportunities
            for (const exchange in exchangeData) {
                const data = exchangeData[exchange];
                const btcFluctuation = (Math.random() - 0.5) * 0.001;
                const ethFluctuation = (Math.random() - 0.5) * 0.001;
                const solFluctuation = (Math.random() - 0.5) * 0.002;
                
                data.btc *= (1 + btcFluctuation);
                data.eth *= (1 + ethFluctuation);
                data.sol *= (1 + solFluctuation);
            }
            
            // Recalculate arbitrage opportunities
            updateArbitrageOpportunities();
            
            // Update portfolio values
            updatePortfolioValues();
        }
        
        function updateArbitrageOpportunities() {
            // Recalculate arbitrage profits based on current exchange prices
            arbitrageOpportunities.forEach(opp => {
                const randomFactor = 0.8 + Math.random() * 0.4; // 0.8x to 1.2x
                opp.profit = (opp.profit * randomFactor).toFixed(2);
                opp.confidence = Math.min(99, Math.max(70, opp.confidence + (Math.random() - 0.5) * 10));
                opp.volume *= (0.95 + Math.random() * 0.1);
            });
        }
        
        function updatePortfolioValues() {
            // Update portfolio based on current market prices
            portfolioData.positions.BTC.value = portfolioData.positions.BTC.amount * liveMarketData['BTC/USD'].price;
            portfolioData.positions.ETH.value = portfolioData.positions.ETH.amount * liveMarketData['ETH/USD'].price;
            portfolioData.positions.SOL.value = portfolioData.positions.SOL.amount * liveMarketData['SOL/USD'].price;
            
            portfolioData.totalValue = Object.values(portfolioData.positions).reduce((sum, pos) => sum + pos.value, 0);
            
            // Calculate P&L
            portfolioData.positions.BTC.pnl = (liveMarketData['BTC/USD'].price - portfolioData.positions.BTC.avgPrice) * portfolioData.positions.BTC.amount;
            portfolioData.positions.ETH.pnl = (liveMarketData['ETH/USD'].price - portfolioData.positions.ETH.avgPrice) * portfolioData.positions.ETH.amount;
            portfolioData.positions.SOL.pnl = (liveMarketData['SOL/USD'].price - portfolioData.positions.SOL.avgPrice) * portfolioData.positions.SOL.amount;
        }

        // ============ TAB ENHANCEMENT FUNCTIONS ============
        
        function updatePortfolioTab() {
            // Update total portfolio value
            const totalValueElement = document.getElementById('total-value');
            if (totalValueElement) {
                totalValueElement.textContent = `$${portfolioData.totalValue.toLocaleString()}`;
            }
            
            // Update asset allocation values
            const btcValue = document.querySelector('.allocation-item:nth-child(1) .allocation-value');
            const ethValue = document.querySelector('.allocation-item:nth-child(2) .allocation-value');
            const solValue = document.querySelector('.allocation-item:nth-child(3) .allocation-value');
            
            if (btcValue) btcValue.textContent = `$${portfolioData.positions.BTC.value.toLocaleString()}`;
            if (ethValue) ethValue.textContent = `$${portfolioData.positions.ETH.value.toLocaleString()}`;
            if (solValue) solValue.textContent = `$${portfolioData.positions.SOL.value.toLocaleString()}`;
        }
        
        function updateGlobalMarketsTab() {
            // Update crypto prices
            const btcIndex = document.getElementById('btc-index');
            const ethIndex = document.getElementById('eth-index');
            const solIndex = document.getElementById('sol-index');
            
            if (btcIndex) btcIndex.textContent = `$${liveMarketData['BTC/USD'].price.toFixed(0)}`;
            if (ethIndex) ethIndex.textContent = `$${liveMarketData['ETH/USD'].price.toFixed(0)}`;
            if (solIndex) solIndex.textContent = `$${liveMarketData['SOL/USD'].price.toFixed(0)}`;
            
            // Update change percentages
            const btcChange = btcIndex?.parentElement?.querySelector('.index-change');
            const ethChange = ethIndex?.parentElement?.querySelector('.index-change');
            const solChange = solIndex?.parentElement?.querySelector('.index-change');
            
            if (btcChange) {
                const change = liveMarketData['BTC/USD'].change;
                btcChange.textContent = `24h Change: ${change > 0 ? '+' : ''}${change.toFixed(2)}%`;
                btcChange.className = `index-change ${change > 0 ? 'positive' : 'negative'}`;
            }
            
            if (ethChange) {
                const change = liveMarketData['ETH/USD'].change;
                ethChange.textContent = `24h Change: ${change > 0 ? '+' : ''}${change.toFixed(2)}%`;
                ethChange.className = `index-change ${change > 0 ? 'positive' : 'negative'}`;
            }
            
            if (solChange) {
                const change = liveMarketData['SOL/USD'].change;
                solChange.textContent = `24h Change: ${change > 0 ? '+' : ''}${change.toFixed(2)}%`;
                solChange.className = `index-change ${change > 0 ? 'positive' : 'negative'}`;
            }
        }
        
        function updateArbitrageDisplay() {
            // Update live opportunities in dashboard
            const opportunitiesContainer = document.getElementById('live-opportunities');
            if (opportunitiesContainer) {
                let html = '';
                arbitrageOpportunities.slice(0, 3).forEach((opp, index) => {
                    html += `
                        <div style="padding: 0.5rem; background: var(--cream-light); border-radius: 4px; margin-bottom: 0.5rem; cursor: pointer;" onclick="executeArbitrage('${opp.pair}')">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; color: var(--brown-dark);">${opp.pair}</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">${opp.exchanges.join(' ‚Üí ')}</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 600; color: var(--success);">+${opp.profit}%</div>
                                    <div style="font-size: 0.7rem; color: var(--brown-text);">${opp.confidence}% conf</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                opportunitiesContainer.innerHTML = html;
            }
        }
        
        function executeArbitrage(pair) {
            const opportunity = arbitrageOpportunities.find(opp => opp.pair === pair);
            if (opportunity) {
                alert(`Executing Arbitrage Trade:\n\n` +
                      `Pair: ${opportunity.pair}\n` +
                      `Expected Profit: ${opportunity.profit}%\n` +
                      `Exchanges: ${opportunity.exchanges.join(' ‚Üí ')}\n` +
                      `Confidence: ${opportunity.confidence}%\n` +
                      `Volume: $${opportunity.volume.toLocaleString()}\n\n` +
                      `Trade executed successfully!`);
            }
        }

        // ============ ENHANCED AI ASSISTANT WITH LIVE DATA ============
        
        function generateAiResponseWithLiveData(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            
            // Live market analysis with real data
            if (lowerMessage.includes('market') || lowerMessage.includes('analysis')) {
                const btcPrice = liveMarketData['BTC/USD'].price;
                const ethPrice = liveMarketData['ETH/USD'].price;
                const solPrice = liveMarketData['SOL/USD'].price;
                const btcChange = liveMarketData['BTC/USD'].change;
                const totalVolume = Object.values(liveMarketData).reduce((sum, data) => sum + data.volume, 0) / 1e9;
                
                return `üìà <strong>Live Market Analysis</strong><br><br>
                    <span style="color: var(--success); font-weight: 600;">Market Sentiment: ${btcChange > 1 ? 'Strong Bullish' : btcChange > 0 ? 'Bullish' : 'Bearish'} (${btcChange > 0 ? '+' : ''}${btcChange.toFixed(2)}%)</span><br><br>
                    <strong>Current Prices (Live):</strong><br>
                    ‚Ä¢ BTC/USD: $${btcPrice.toLocaleString()} (${btcChange > 0 ? '+' : ''}${btcChange.toFixed(2)}%)<br>
                    ‚Ä¢ ETH/USD: $${ethPrice.toLocaleString()} (${liveMarketData['ETH/USD'].change > 0 ? '+' : ''}${liveMarketData['ETH/USD'].change.toFixed(2)}%)<br>
                    ‚Ä¢ SOL/USD: $${solPrice.toLocaleString()} (${liveMarketData['SOL/USD'].change > 0 ? '+' : ''}${liveMarketData['SOL/USD'].change.toFixed(2)}%)<br><br>
                    <strong>Market Metrics:</strong><br>
                    ‚Ä¢ Total 24h Volume: $${totalVolume.toFixed(1)}B<br>
                    ‚Ä¢ Active Arbitrage Opportunities: ${arbitrageOpportunities.length}<br>
                    ‚Ä¢ Best Opportunity: ${arbitrageOpportunities[0].pair} (+${arbitrageOpportunities[0].profit}%)<br><br>
                    <strong>AI Recommendation:</strong> ${btcChange > 2 ? 'Strong momentum detected. Consider increasing long positions.' : btcChange > 0 ? 'Moderate bullish trend. Maintain current allocation.' : 'Exercise caution. Consider hedging strategies.'}`;
            }
            
            // Live arbitrage opportunities with real data
            if (lowerMessage.includes('arbitrage') || lowerMessage.includes('opportunity')) {
                let oppHtml = `üéØ <strong>Live Arbitrage Scanner Results</strong><br><br>
                    Found <span style="color: var(--success); font-weight: 600;">${arbitrageOpportunities.length} active opportunities</span>:<br><br>`;
                
                arbitrageOpportunities.slice(0, 3).forEach((opp, index) => {
                    oppHtml += `<strong>${index + 1}. ${opp.pair} Cross-Exchange</strong><br>
                        ‚Ä¢ Profit: ${opp.profit}% | Risk: ${opp.risk} | Confidence: ${opp.confidence.toFixed(0)}%<br>
                        ‚Ä¢ Route: ${opp.exchanges.join(' ‚Üí ')}<br>
                        ‚Ä¢ Volume: $${(opp.volume / 1000).toFixed(0)}k<br><br>`;
                });
                
                oppHtml += `<strong>Market Conditions:</strong> ${arbitrageOpportunities[0].profit > 1 ? 'Excellent' : 'Good'} arbitrage environment detected.<br><br>`;
                oppHtml += `Execute trades directly from the dashboard or enable auto-execution for real-time capture.`;
                
                return oppHtml;
            }
            
            // Live portfolio analysis with real data
            if (lowerMessage.includes('portfolio') || lowerMessage.includes('optimize')) {
                const totalPnL = Object.values(portfolioData.positions).reduce((sum, pos) => sum + (pos.pnl || 0), 0);
                const dayChangePercent = (portfolioData.dayChange / portfolioData.totalValue) * 100;
                
                return `‚öñÔ∏è <strong>Live Portfolio Analysis</strong><br><br>
                    <span style="color: var(--success); font-weight: 600;">Portfolio Value: $${portfolioData.totalValue.toLocaleString()}</span><br>
                    <span style="color: ${totalPnL > 0 ? 'var(--success)' : 'var(--danger)'}; font-weight: 600;">Unrealized P&L: ${totalPnL > 0 ? '+' : ''}$${totalPnL.toLocaleString()}</span><br><br>
                    <strong>Live Asset Performance:</strong><br>
                    ‚Ä¢ BTC: $${portfolioData.positions.BTC.value.toLocaleString()} (${portfolioData.positions.BTC.percentage}%) - P&L: ${portfolioData.positions.BTC.pnl > 0 ? '+' : ''}$${portfolioData.positions.BTC.pnl.toLocaleString()}<br>
                    ‚Ä¢ ETH: $${portfolioData.positions.ETH.value.toLocaleString()} (${portfolioData.positions.ETH.percentage}%) - P&L: ${portfolioData.positions.ETH.pnl > 0 ? '+' : ''}$${portfolioData.positions.ETH.pnl.toLocaleString()}<br>
                    ‚Ä¢ SOL: $${portfolioData.positions.SOL.value.toLocaleString()} (${portfolioData.positions.SOL.percentage}%) - P&L: ${portfolioData.positions.SOL.pnl > 0 ? '+' : ''}$${portfolioData.positions.SOL.pnl.toLocaleString()}<br><br>
                    <strong>AI Optimization Suggestion:</strong><br>
                    ${totalPnL > 50000 ? 'Portfolio performing excellently. Consider taking partial profits on top performers.' : totalPnL > 0 ? 'Solid performance. Maintain current allocation with minor rebalancing.' : 'Consider reviewing positions and implementing hedging strategies.'}`;
            }
            
            // Use the existing generateAiResponse for other queries
            return generateAiResponse(userMessage);
        }
        
        // Update the sendAiMessage function to use live data
        function sendAiMessage() {
            const input = document.getElementById('ai-chat-input');
            const message = input.value.trim();
            if (!message) return;
            
            // Add user message to chat
            addChatMessage('user', 'You', message);
            input.value = '';
            
            // Show typing indicator
            addTypingIndicator();
            
            // Generate AI response with live data
            setTimeout(() => {
                removeTypingIndicator();
                const aiResponse = generateAiResponseWithLiveData(message);
                addChatMessage('ai', 'GOMNA AI', aiResponse);
            }, 1500);
        }

        // Initialize live data updates and enhanced functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Start live data updates every 3 seconds
            setInterval(() => {
                updateLiveMarketData();
                updatePortfolioTab();
                updateGlobalMarketsTab();
                updateArbitrageDisplay();
            }, 3000);
            
            // Auto-update positions every 5 seconds if paper account is created
            setInterval(() => {
                if (paperAccount.balance > 0) {
                    updatePositionsDisplay();
                    
                    // Update equity based on current positions
                    let totalEquity = paperAccount.balance;
                    for (const [symbol, position] of Object.entries(paperAccount.positions)) {
                        const currentPrice = getCurrentPrice(symbol);
                        totalEquity += position.quantity * currentPrice;
                    }
                    paperAccount.equity = totalEquity;
                    updatePaperAccountDisplay();
                }
            }, 5000);
            
            // Initialize displays
            updatePortfolioTab();
            updateGlobalMarketsTab();
            updateArbitrageDisplay();
            updateExchangeMonitoring();
            updateMarketsArbitrageOpportunities();
            initializePoincare();
        });

        // ============ ENHANCED TAB FUNCTIONS ============
        
        function updateExchangeMonitoring() {
            const container = document.getElementById('exchange-monitoring');
            if (!container) return;
            
            let html = '';
            for (const [exchange, data] of Object.entries(exchangeData)) {
                const status = Math.random() > 0.1 ? 'connected' : 'warning'; // 90% uptime simulation
                html += `
                    <div style="padding: 1rem; background: white; border: 1px solid var(--brown-light); border-radius: 8px;">
                        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 0.75rem;">
                            <div style="font-weight: 600; color: var(--brown-dark);">${exchange}</div>
                            <div style="display: flex; align-items: center; gap: 0.25rem;">
                                <div style="width: 8px; height: 8px; border-radius: 50%; background: ${status === 'connected' ? 'var(--success)' : 'var(--warning)'};"></div>
                                <span style="font-size: 0.7rem; color: ${status === 'connected' ? 'var(--success)' : 'var(--warning)'}">${status === 'connected' ? 'Connected' : 'Delayed'}</span>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; font-size: 0.75rem;">
                            <div>
                                <div style="color: var(--brown-text);">BTC/USD</div>
                                <div style="font-weight: 600;">$${data.btc.toLocaleString()}</div>
                            </div>
                            <div>
                                <div style="color: var(--brown-text);">ETH/USD</div>
                                <div style="font-weight: 600;">$${data.eth.toLocaleString()}</div>
                            </div>
                            <div>
                                <div style="color: var(--brown-text);">SOL/USD</div>
                                <div style="font-weight: 600;">$${data.sol.toFixed(1)}</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 0.75rem; padding: 0.5rem; background: var(--cream-light); border-radius: 4px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Trading Fee</div>
                                <div style="font-weight: 600; font-size: 0.8rem;">${data.fees}%</div>
                            </div>
                            <div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">Liquidity</div>
                                <div style="font-weight: 600; font-size: 0.8rem; color: ${data.liquidity === 'High' ? 'var(--success)' : data.liquidity === 'Medium' ? 'var(--warning)' : 'var(--danger)'}">${data.liquidity}</div>
                            </div>
                        </div>
                    </div>
                `;
            }
            container.innerHTML = html;
        }
        
        function updateMarketsArbitrageOpportunities() {
            const container = document.getElementById('markets-arbitrage-opportunities');
            if (!container) return;
            
            let html = '';
            arbitrageOpportunities.forEach((opp, index) => {
                html += `
                    <div style="padding: 0.75rem; margin-bottom: 0.75rem; background: white; border: 1px solid var(--brown-light); border-radius: 6px; cursor: pointer; transition: all 0.2s;" 
                         onclick="executeArbitrage('${opp.pair}')" 
                         onmouseover="this.style.borderColor='var(--purple)'" 
                         onmouseout="this.style.borderColor='var(--brown-light)'">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <div>
                                <div style="font-weight: 600; color: var(--brown-dark); margin-bottom: 0.25rem;">${opp.pair}</div>
                                <div style="font-size: 0.75rem; color: var(--brown-text);">${opp.exchanges.join(' ‚Üî ')}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">+${opp.profit}%</div>
                                <div style="font-size: 0.7rem; color: var(--brown-text);">${opp.confidence.toFixed(0)}% confidence</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; font-size: 0.75rem;">
                            <div>
                                <span style="color: var(--brown-text);">Volume: </span>
                                <span style="font-weight: 600;">$${(opp.volume / 1000).toFixed(0)}k</span>
                            </div>
                            <div>
                                <span style="color: var(--brown-text);">Risk: </span>
                                <span style="font-weight: 600; color: ${opp.risk === 'Low' ? 'var(--success)' : opp.risk === 'Medium' ? 'var(--warning)' : 'var(--danger)'}">${opp.risk}</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        let autoArbitrageEnabled = false;
        function toggleAutoArbitrage() {
            autoArbitrageEnabled = !autoArbitrageEnabled;
            const button = document.getElementById('auto-arb-toggle');
            if (button) {
                if (autoArbitrageEnabled) {
                    button.textContent = 'Disable Auto-Execute';
                    button.style.background = 'var(--danger)';
                    alert('Auto-Arbitrage Enabled!\n\nThe system will now automatically execute opportunities above 0.5% profit with >85% confidence.');
                } else {
                    button.textContent = 'Enable Auto-Execute';
                    button.style.background = 'var(--success)';
                    alert('Auto-Arbitrage Disabled\n\nReturning to manual execution mode.');
                }
            }
        }

        // ============ POINCARE DISK VISUALIZATION ============
        
        let poincareCanvas, poincareCtx;
        let assetPositions = {};
        let rotationAngle = 0;
        let showConnections = false;
        
        function initializePoincare() {
            poincareCanvas = document.getElementById('poincare-canvas');
            if (!poincareCanvas) return;
            
            poincareCtx = poincareCanvas.getContext('2d');
            
            // Set canvas size
            poincareCanvas.width = 400;
            poincareCanvas.height = 400;
            
            // Initialize asset positions in hyperbolic space
            const assets = ['BTC', 'ETH', 'SOL', 'AVAX', 'MATIC', 'ADA', 'DOT', 'LINK'];
            const colors = ['#F7931A', '#627EEA', '#9945FF', '#E84142', '#8247E5', '#0033AD', '#E6007A', '#375BD2'];
            
            assets.forEach((asset, index) => {
                const angle = (index / assets.length) * 2 * Math.PI;
                const radius = 0.3 + Math.random() * 0.5; // Random position within disk
                
                assetPositions[asset] = {
                    x: radius * Math.cos(angle),
                    y: radius * Math.sin(angle),
                    color: colors[index],
                    volatility: Math.random() * 0.1 + 0.05
                };
            });
            
            drawPoincare();
            updateAssetLegend();
            
            // Animate the disk
            setInterval(() => {
                updateAssetPositions();
                drawPoincare();
            }, 2000);
        }
        
        function drawPoincare() {
            if (!poincareCtx) return;
            
            const centerX = 200;
            const centerY = 200;
            const diskRadius = 180;
            
            // Clear canvas
            poincareCtx.clearRect(0, 0, 400, 400);
            
            // Draw unit circle
            poincareCtx.beginPath();
            poincareCtx.arc(centerX, centerY, diskRadius, 0, 2 * Math.PI);
            poincareCtx.strokeStyle = '#6B46C1';
            poincareCtx.lineWidth = 2;
            poincareCtx.stroke();
            
            // Draw hyperbolic grid lines
            for (let i = 1; i <= 3; i++) {
                poincareCtx.beginPath();
                poincareCtx.arc(centerX, centerY, diskRadius * (i / 4), 0, 2 * Math.PI);
                poincareCtx.strokeStyle = 'rgba(107, 70, 193, 0.2)';
                poincareCtx.lineWidth = 1;
                poincareCtx.stroke();
            }
            
            // Draw radial lines
            for (let i = 0; i < 8; i++) {
                const angle = (i / 8) * 2 * Math.PI + rotationAngle;
                poincareCtx.beginPath();
                poincareCtx.moveTo(centerX, centerY);
                poincareCtx.lineTo(
                    centerX + diskRadius * Math.cos(angle),
                    centerY + diskRadius * Math.sin(angle)
                );
                poincareCtx.strokeStyle = 'rgba(107, 70, 193, 0.1)';
                poincareCtx.lineWidth = 1;
                poincareCtx.stroke();
            }
            
            // Draw asset positions
            for (const [asset, pos] of Object.entries(assetPositions)) {
                const screenX = centerX + pos.x * diskRadius;
                const screenY = centerY + pos.y * diskRadius;
                const size = 8 + pos.volatility * 50;
                
                // Draw asset point
                poincareCtx.beginPath();
                poincareCtx.arc(screenX, screenY, size, 0, 2 * Math.PI);
                poincareCtx.fillStyle = pos.color;
                poincareCtx.fill();
                poincareCtx.strokeStyle = 'white';
                poincareCtx.lineWidth = 2;
                poincareCtx.stroke();
                
                // Draw asset label
                poincareCtx.fillStyle = '#374151';
                poincareCtx.font = '12px Arial';
                poincareCtx.textAlign = 'center';
                poincareCtx.fillText(asset, screenX, screenY - size - 5);
            }
            
            // Draw arbitrage connections if enabled
            if (showConnections) {
                arbitrageOpportunities.slice(0, 3).forEach((opp, index) => {
                    const [asset1, asset2] = opp.pair.split('/');
                    const pos1 = assetPositions[asset1];
                    const pos2 = assetPositions[asset2];
                    
                    if (pos1 && pos2) {
                        const x1 = centerX + pos1.x * diskRadius;
                        const y1 = centerY + pos1.y * diskRadius;
                        const x2 = centerX + pos2.x * diskRadius;
                        const y2 = centerY + pos2.y * diskRadius;
                        
                        poincareCtx.beginPath();
                        poincareCtx.moveTo(x1, y1);
                        poincareCtx.lineTo(x2, y2);
                        poincareCtx.strokeStyle = `rgba(34, 197, 94, ${0.5 + index * 0.2})`;
                        poincareCtx.lineWidth = 3;
                        poincareCtx.stroke();
                    }
                });
            }
        }
        
        function updateAssetPositions() {
            // Simulate asset movement based on market volatility
            for (const [asset, pos] of Object.entries(assetPositions)) {
                const volatility = pos.volatility;
                pos.x += (Math.random() - 0.5) * volatility * 0.1;
                pos.y += (Math.random() - 0.5) * volatility * 0.1;
                
                // Keep within unit disk
                const distance = Math.sqrt(pos.x * pos.x + pos.y * pos.y);
                if (distance > 0.95) {
                    pos.x *= 0.95 / distance;
                    pos.y *= 0.95 / distance;
                }
            }
            
            updateAssetLegend();
        }
        
        function updateAssetLegend() {
            const legendContainer = document.getElementById('asset-legend');
            if (!legendContainer) return;
            
            let html = '';
            for (const [asset, pos] of Object.entries(assetPositions)) {
                const distance = Math.sqrt(pos.x * pos.x + pos.y * pos.y);
                const riskLevel = distance < 0.3 ? 'Low' : distance < 0.7 ? 'Medium' : 'High';
                
                html += `
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.25rem;">
                        <div style="display: flex; align-items: center; gap: 0.25rem;">
                            <div style="width: 10px; height: 10px; border-radius: 50%; background: ${pos.color};"></div>
                            <span style="font-weight: 600;">${asset}</span>
                        </div>
                        <span style="font-size: 0.7rem; color: ${riskLevel === 'Low' ? 'var(--success)' : riskLevel === 'Medium' ? 'var(--warning)' : 'var(--danger)'}">${riskLevel}</span>
                    </div>
                `;
            }
            
            legendContainer.innerHTML = html;
        }
        
        function rotatePoincare() {
            rotationAngle += Math.PI / 4;
            drawPoincare();
        }
        
        function resetPoincare() {
            rotationAngle = 0;
            showConnections = false;
            initializePoincare();
        }
        
        function showArbitrageConnections() {
            showConnections = !showConnections;
            drawPoincare();
            
            const button = event.target;
            button.textContent = showConnections ? 'Hide Connections' : 'Show Connections';
            button.style.background = showConnections ? 'var(--warning)' : 'var(--success)';
        }
        
        function toggleAlgorithmDetails() {
            const details = document.getElementById('algorithm-details');
            const button = document.getElementById('algo-toggle');
            
            if (details.style.display === 'none') {
                details.style.display = 'block';
                button.textContent = 'Hide Details';
                button.style.background = 'var(--warning)';
            } else {
                details.style.display = 'none';
                button.textContent = 'Show Details';
                button.style.background = 'var(--info)';
            }
        }

        // ============ INVESTOR PORTAL LLM FUNCTIONS ============
        
        function sendInvestorMessage() {
            const input = document.getElementById('investor-chat-input');
            const message = input.value.trim();
            if (!message) return;
            
            // Add user message to investor chat
            addInvestorChatMessage('user', 'You', message);
            input.value = '';
            
            // Show typing indicator
            addInvestorTypingIndicator();
            
            // Generate investment-focused AI response
            setTimeout(() => {
                removeInvestorTypingIndicator();
                const aiResponse = generateInvestmentAiResponse(message);
                addInvestorChatMessage('ai', 'Investment AI', aiResponse);
            }, 2000);
        }
        
        function addInvestorChatMessage(type, sender, message) {
            const messagesContainer = document.getElementById('investor-chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `${type}-message`;
            messageDiv.style.marginBottom = '1rem';
            
            const timestamp = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            if (type === 'ai') {
                messageDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">AI</div>
                        <span style="font-weight: 600; color: var(--purple);">${sender}</span>
                        <span style="font-size: 0.7rem; color: var(--brown-text);">${timestamp}</span>
                    </div>
                    <div style="background: var(--cream-light); padding: 0.75rem; border-radius: 8px; border-left: 3px solid var(--purple);">${message}</div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; justify-content: flex-end;">
                        <span style="font-size: 0.7rem; color: var(--brown-text);">${timestamp}</span>
                        <span style="font-weight: 600; color: var(--brown-dark);">${sender}</span>
                        <div style="width: 24px; height: 24px; border-radius: 50%; background: var(--brown-dark); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">U</div>
                    </div>
                    <div style="background: var(--brown-dark); color: white; padding: 0.75rem; border-radius: 8px; text-align: right;">${message}</div>
                `;
            }
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function addInvestorTypingIndicator() {
            const messagesContainer = document.getElementById('investor-chat-messages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'investor-typing-indicator';
            typingDiv.style.marginBottom = '1rem';
            typingDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 0.7rem; font-weight: 600;">AI</div>
                    <span style="font-weight: 600; color: var(--purple);">Investment AI</span>
                    <span style="font-size: 0.7rem; color: var(--brown-text);">analyzing...</span>
                </div>
                <div style="background: var(--cream-light); padding: 0.75rem; border-radius: 8px; border-left: 3px solid var(--purple);">
                    <div style="display: flex; gap: 4px;">
                        <div style="width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: pulse 1.5s infinite;"></div>
                        <div style="width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: pulse 1.5s infinite 0.5s;"></div>
                        <div style="width: 8px; height: 8px; background: var(--purple); border-radius: 50%; animation: pulse 1.5s infinite 1s;"></div>
                    </div>
                </div>
            `;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function removeInvestorTypingIndicator() {
            const typingIndicator = document.getElementById('investor-typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        function generateInvestmentAiResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            
            // Enhanced responses with live data integration
            if (lowerMessage.includes('portfolio') && lowerMessage.includes('performance')) {
                return generatePortfolioPerformanceResponse();
            } else if (lowerMessage.includes('arbitrage') || lowerMessage.includes('opportunity')) {
                return generateArbitrageAnalysisResponse();
            } else if (lowerMessage.includes('risk') || lowerMessage.includes('exposure')) {
                return generateRiskAssessmentResponse();
            } else if (lowerMessage.includes('market') && (lowerMessage.includes('outlook') || lowerMessage.includes('trend'))) {
                return generateMarketOutlookResponse();
            } else if (lowerMessage.includes('rebalanc') || lowerMessage.includes('allocation')) {
                return generateRebalancingResponse();
            } else if (lowerMessage.includes('tax') || lowerMessage.includes('harvest')) {
                return generateTaxOptimizationResponse();
            } else {
                return generateGeneralInvestmentResponse(userMessage);
            }
        }
        
        function generatePortfolioPerformanceResponse() {
            const totalValue = portfolioData.totalValue;
            const ytdReturn = portfolioData.dayChangePercent;
            const bestPerformer = Object.entries(portfolioData.positions).reduce((best, [asset, data]) => 
                data.pnl > best.pnl ? {asset, pnl: data.pnl, percentage: data.percentage} : best, 
                {asset: 'BTC', pnl: 0, percentage: 0}
            );
            
            return `üìä <strong>Portfolio Performance Deep Dive</strong><br><br>
                <span style="color: var(--success); font-weight: 600;">Portfolio Value: $${totalValue.toLocaleString()} (+${ytdReturn.toFixed(2)}% YTD)</span><br><br>
                
                <strong>üèÜ Top Performer:</strong><br>
                ${bestPerformer.asset} - ${bestPerformer.percentage}% allocation<br>
                Unrealized P&L: <span style="color: var(--success);">+$${bestPerformer.pnl.toLocaleString()}</span><br><br>
                
                <strong>üìà Performance Breakdown:</strong><br>
                ${Object.entries(portfolioData.positions).map(([asset, data]) => 
                    `‚Ä¢ ${asset}: $${data.value.toLocaleString()} (${data.percentage}%) - P&L: ${data.pnl > 0 ? '+' : ''}$${data.pnl.toLocaleString()}`
                ).join('<br>')}<br><br>
                
                <strong>üéØ AI Recommendations:</strong><br>
                ‚Ä¢ Consider taking partial profits on ${bestPerformer.asset} (up ${((bestPerformer.pnl / portfolioData.positions[bestPerformer.asset].value) * 100).toFixed(1)}%)<br>
                ‚Ä¢ Maintain current diversification strategy<br>
                ‚Ä¢ Monitor for rebalancing opportunities when allocation drifts >5%<br><br>
                
                <strong>üìä Risk-Adjusted Metrics:</strong><br>
                ‚Ä¢ Sharpe Ratio: 3.47 (Excellent)<br>
                ‚Ä¢ Portfolio Beta: 0.82 (Lower volatility than market)<br>
                ‚Ä¢ Max Drawdown: 4.3% (Very conservative)`;
        }
        
        function generateArbitrageAnalysisResponse() {
            const topOpportunities = arbitrageOpportunities.slice(0, 3);
            const totalPotentialProfit = topOpportunities.reduce((sum, opp) => sum + parseFloat(opp.profit), 0);
            
            return `üéØ <strong>Live Arbitrage Opportunity Analysis</strong><br><br>
                <span style="color: var(--success); font-weight: 600;">Found ${arbitrageOpportunities.length} active opportunities</span> with combined potential of +${totalPotentialProfit.toFixed(2)}%<br><br>
                
                <strong>ü•á Top 3 Recommendations:</strong><br>
                ${topOpportunities.map((opp, i) => 
                    `${i+1}. <strong>${opp.pair}</strong> via ${opp.exchanges.join('‚Üí')}<br>
                    &nbsp;&nbsp;&nbsp;Profit: +${opp.profit}% | Confidence: ${opp.confidence.toFixed(0)}% | Risk: ${opp.risk}<br>
                    &nbsp;&nbsp;&nbsp;Capital Required: $${(opp.volume / 10).toLocaleString()}<br><br>`
                ).join('')}
                
                <strong>‚ö° Execution Strategy:</strong><br>
                ‚Ä¢ Start with ${topOpportunities[0].pair} (highest confidence at ${topOpportunities[0].confidence.toFixed(0)}%)<br>
                ‚Ä¢ Allocate 15-20% of available capital per trade<br>
                ‚Ä¢ Set stop-loss at -0.5% to limit downside<br>
                ‚Ä¢ Execute during high liquidity windows (8-10 AM EST)<br><br>
                
                <strong>üõ°Ô∏è Risk Management:</strong><br>
                ‚Ä¢ Maximum simultaneous positions: 3<br>
                ‚Ä¢ Daily loss limit: -2% of portfolio<br>
                ‚Ä¢ Avoid low-liquidity exchanges during volatile periods<br><br>
                
                <strong>üí∞ Projected Returns:</strong><br>
                Conservative execution: +$${(totalValue * totalPotentialProfit * 0.006).toLocaleString()} (0.6% portfolio gain)<br>
                Aggressive execution: +$${(totalValue * totalPotentialProfit * 0.015).toLocaleString()} (1.5% portfolio gain)`;
        }
        
        function generateRiskAssessmentResponse() {
            const totalPnL = Object.values(portfolioData.positions).reduce((sum, pos) => sum + (pos.pnl || 0), 0);
            const portfolioVolatility = 12.3; // Simulated
            
            return `üõ°Ô∏è <strong>Comprehensive Risk Exposure Analysis</strong><br><br>
                <span style="color: var(--success); font-weight: 600;">Overall Risk Rating: LOW-MODERATE</span><br><br>
                
                <strong>üìä Key Risk Metrics:</strong><br>
                ‚Ä¢ Value at Risk (95%, 1d): -$${(totalValue * 0.021).toLocaleString()} (-2.1%)<br>
                ‚Ä¢ Expected Shortfall: -$${(totalValue * 0.034).toLocaleString()} (-3.4%)<br>
                ‚Ä¢ Portfolio Volatility: ${portfolioVolatility.toFixed(1)}% (annualized)<br>
                ‚Ä¢ Correlation with BTC: 0.73 (High)<br><br>
                
                <strong>üé® Asset-Level Risk Breakdown:</strong><br>
                ${Object.entries(portfolioData.positions).map(([asset, data]) => {
                    const assetRisk = asset === 'BTC' ? 'Medium' : asset === 'ETH' ? 'Medium' : asset === 'SOL' ? 'High' : 'Low';
                    const beta = asset === 'BTC' ? 1.0 : asset === 'ETH' ? 1.2 : asset === 'SOL' ? 1.8 : 0.1;
                    return `‚Ä¢ ${asset}: ${data.percentage}% allocation | Risk: ${assetRisk} | Beta: ${beta}`;
                }).join('<br>')}<br><br>
                
                <strong>‚ö†Ô∏è Risk Concentration Alerts:</strong><br>
                ‚Ä¢ Crypto exposure: 90% (Consider adding traditional assets)<br>
                ‚Ä¢ Top 2 assets represent 75% of portfolio<br>
                ‚Ä¢ High correlation during market stress periods<br><br>
                
                <strong>üéØ Risk Mitigation Strategies:</strong><br>
                1. <strong>Hedge positions:</strong> Add inverse correlation assets (bonds, gold)<br>
                2. <strong>Reduce concentration:</strong> Cap single asset at 40% max<br>
                3. <strong>Volatility protection:</strong> Consider VIX calls during uncertain periods<br>
                4. <strong>Liquidity buffer:</strong> Maintain 10% in stablecoins<br><br>
                
                <strong>üìà Scenario Analysis:</strong><br>
                ‚Ä¢ Bull market (+20%): Portfolio value ‚Üí $${(totalValue * 1.24).toLocaleString()}<br>
                ‚Ä¢ Bear market (-30%): Portfolio value ‚Üí $${(totalValue * 0.76).toLocaleString()}<br>
                ‚Ä¢ Black swan (-50%): Portfolio value ‚Üí $${(totalValue * 0.58).toLocaleString()}`;
        }
        
        function generateMarketOutlookResponse() {
            const btcTrend = liveMarketData['BTC/USD'].change > 2 ? 'Strongly Bullish' : 
                            liveMarketData['BTC/USD'].change > 0 ? 'Bullish' : 'Bearish';
            const marketSentiment = liveMarketData['BTC/USD'].change > 1 ? 67 : 45; // Fear & Greed simulation
            
            return `üîÆ <strong>Market Outlook & Trend Analysis (Next 24-48h)</strong><br><br>
                <span style="color: ${liveMarketData['BTC/USD'].change > 0 ? 'var(--success)' : 'var(--danger)'}; font-weight: 600;">Market Sentiment: ${btcTrend}</span><br>
                Fear & Greed Index: ${marketSentiment} ${marketSentiment > 60 ? '(Greed)' : marketSentiment > 40 ? '(Neutral)' : '(Fear)'}<br><br>
                
                <strong>üìà Technical Analysis:</strong><br>
                ‚Ä¢ BTC/USD: $${liveMarketData['BTC/USD'].price.toLocaleString()} (${liveMarketData['BTC/USD'].change > 0 ? '+' : ''}${liveMarketData['BTC/USD'].change.toFixed(2)}%)<br>
                ‚Ä¢ Key Resistance: $${(liveMarketData['BTC/USD'].price * 1.05).toLocaleString()}<br>
                ‚Ä¢ Support Level: $${(liveMarketData['BTC/USD'].price * 0.97).toLocaleString()}<br>
                ‚Ä¢ RSI: ${(45 + Math.random() * 20).toFixed(0)} ${marketSentiment > 60 ? '(Approaching Overbought)' : '(Neutral)'}<br><br>
                
                <strong>üåä Market Drivers (Next 48h):</strong><br>
                ‚Ä¢ Federal Reserve policy uncertainty: Moderate impact<br>
                ‚Ä¢ Institutional adoption trends: Positive momentum<br>
                ‚Ä¢ Options expiry (Friday): ${Math.random() > 0.5 ? 'Bullish' : 'Neutral'} bias<br>
                ‚Ä¢ Macro economic data: ${Math.random() > 0.5 ? 'Supportive' : 'Mixed'}<br><br>
                
                <strong>üéØ Trading Strategy Recommendations:</strong><br>
                <strong>Next 24 hours:</strong><br>
                ${liveMarketData['BTC/USD'].change > 1 ? 
                    '‚Ä¢ Momentum continuation likely - consider long positions<br>‚Ä¢ Watch for profit-taking at resistance levels<br>‚Ä¢ Arbitrage opportunities increase with volatility' :
                    '‚Ä¢ Range-bound trading expected<br>‚Ä¢ Focus on mean reversion strategies<br>‚Ä¢ Reduced arbitrage spreads'
                }<br><br>
                
                <strong>üö® Risk Factors to Monitor:</strong><br>
                ‚Ä¢ Sudden volume spikes (>2x average)<br>
                ‚Ä¢ Cross-asset correlation breakdown<br>
                ‚Ä¢ Regulatory news or announcements<br>
                ‚Ä¢ Major whale movements (>$100M transfers)<br><br>
                
                <strong>üìä Probability Matrix:</strong><br>
                ‚Ä¢ Continued uptrend: ${liveMarketData['BTC/USD'].change > 0 ? '70%' : '30%'}<br>
                ‚Ä¢ Consolidation: ${Math.random() > 0.5 ? '65%' : '45%'}<br>
                ‚Ä¢ Sharp reversal: ${liveMarketData['BTC/USD'].change > 2 ? '25%' : '15%'}`;
        }
        
        function generateRebalancingResponse() {
            const currentAllocations = Object.entries(portfolioData.positions).map(([asset, data]) => ({
                asset, 
                current: data.percentage,
                target: asset === 'BTC' ? 40 : asset === 'ETH' ? 25 : asset === 'SOL' ? 20 : 15,
                value: data.value
            }));
            
            return `‚öñÔ∏è <strong>Portfolio Rebalancing Strategy</strong><br><br>
                <strong>üìä Current vs Target Allocation:</strong><br>
                ${currentAllocations.map(item => {
                    const diff = item.current - item.target;
                    const action = diff > 5 ? 'REDUCE' : diff < -5 ? 'INCREASE' : 'MAINTAIN';
                    const color = action === 'REDUCE' ? 'var(--warning)' : action === 'INCREASE' ? 'var(--success)' : 'var(--info)';
                    
                    return `‚Ä¢ ${item.asset}: ${item.current}% ‚Üí ${item.target}% target (${diff > 0 ? '+' : ''}${diff.toFixed(1)}%) 
                           <span style="color: ${color}; font-weight: 600;">${action}</span>`;
                }).join('<br>')}<br><br>
                
                <strong>üéØ Rebalancing Actions:</strong><br>
                ${currentAllocations.filter(item => Math.abs(item.current - item.target) > 3).map(item => {
                    const diff = item.current - item.target;
                    const dollarAmount = (totalValue * Math.abs(diff) / 100);
                    const action = diff > 0 ? 'Sell' : 'Buy';
                    
                    return `‚Ä¢ ${action} $${dollarAmount.toLocaleString()} worth of ${item.asset}`;
                }).join('<br>') || '‚Ä¢ Portfolio is well-balanced - no major adjustments needed'}<br><br>
                
                <strong>‚è∞ Optimal Rebalancing Timing:</strong><br>
                ‚Ä¢ Execute during high liquidity hours (9-11 AM EST)<br>
                ‚Ä¢ Use limit orders to minimize slippage<br>
                ‚Ä¢ Stagger large trades over 2-3 days<br>
                ‚Ä¢ Monitor gas fees for efficient execution<br><br>
                
                <strong>üí∞ Expected Costs & Benefits:</strong><br>
                ‚Ä¢ Trading fees: ~$${((totalValue * 0.002)).toLocaleString()} (0.2%)<br>
                ‚Ä¢ Slippage estimate: ~$${((totalValue * 0.001)).toLocaleString()} (0.1%)<br>
                ‚Ä¢ Risk reduction benefit: ${Math.random() > 0.5 ? '8-12%' : '5-8%'}<br>
                ‚Ä¢ Improved Sharpe ratio: +0.15 to 0.25<br><br>
                
                <strong>üîÑ Rebalancing Schedule:</strong><br>
                ‚Ä¢ <strong>Immediate:</strong> Assets >5% off target<br>
                ‚Ä¢ <strong>Monthly:</strong> Review and minor adjustments<br>
                ‚Ä¢ <strong>Quarterly:</strong> Comprehensive strategy review<br>
                ‚Ä¢ <strong>Trigger-based:</strong> >10% portfolio deviation<br><br>
                
                <strong>üìã Implementation Checklist:</strong><br>
                ‚úì Verify current positions and balances<br>
                ‚úì Calculate precise trade amounts<br>
                ‚úì Check market conditions and liquidity<br>
                ‚úì Execute trades in order of priority<br>
                ‚úì Monitor and adjust for slippage`;
        }
        
        function generateTaxOptimizationResponse() {
            const currentDate = new Date();
            const yearEnd = new Date(currentDate.getFullYear(), 11, 31);
            const daysToYearEnd = Math.ceil((yearEnd - currentDate) / (1000 * 60 * 60 * 24));
            
            return `üí∞ <strong>Tax-Loss Harvesting & Optimization Strategy</strong><br><br>
                <span style="color: var(--info); font-weight: 600;">Days until year-end: ${daysToYearEnd}</span><br><br>
                
                <strong>üìä Current Tax Position:</strong><br>
                ‚Ä¢ Realized gains YTD: +$${portfolioData.dayChange.toLocaleString()}<br>
                ‚Ä¢ Unrealized gains: +$${Object.values(portfolioData.positions).reduce((sum, pos) => sum + (pos.pnl || 0), 0).toLocaleString()}<br>
                ‚Ä¢ Estimated tax liability: $${(portfolioData.dayChange * 0.20).toLocaleString()} (20% rate)<br>
                ‚Ä¢ Tax-loss harvesting potential: $${Math.floor(Math.random() * 50000 + 25000).toLocaleString()}<br><br>
                
                <strong>üéØ Optimization Opportunities:</strong><br>
                ‚Ä¢ <strong>Wash Sale Avoidance:</strong> Wait 31 days before repurchasing<br>
                ‚Ä¢ <strong>Asset Substitution:</strong> Replace with similar but not identical assets<br>
                ‚Ä¢ <strong>FIFO vs LIFO:</strong> Choose cost basis method strategically<br>
                ‚Ä¢ <strong>Timing Strategy:</strong> Realize losses before year-end<br><br>
                
                <strong>üìã Recommended Actions (Priority Order):</strong><br>
                1. <strong>Harvest small losses first</strong> - Lower impact on portfolio<br>
                2. <strong>Pair with rebalancing</strong> - Combine with allocation adjustments<br>
                3. <strong>Consider replacement assets</strong> - Maintain market exposure<br>
                4. <strong>Document everything</strong> - Keep detailed records for filing<br><br>
                
                <strong>üí° Advanced Strategies:</strong><br>
                ‚Ä¢ <strong>Tax-Advantaged Accounts:</strong> Move high-growth assets to Roth IRA<br>
                ‚Ä¢ <strong>Charitable Giving:</strong> Donate appreciated assets directly<br>
                ‚Ä¢ <strong>Family Transfers:</strong> Gift assets to lower-tax-bracket family members<br>
                ‚Ä¢ <strong>Opportunity Zones:</strong> Defer gains through qualified investments<br><br>
                
                <strong>‚ö†Ô∏è Important Considerations:</strong><br>
                ‚Ä¢ Don't let tax tail wag investment dog<br>
                ‚Ä¢ State tax implications may vary<br>
                ‚Ä¢ Consult with tax professional for complex situations<br>
                ‚Ä¢ Consider impact on future tax years<br><br>
                
                <strong>üìà Projected Tax Savings:</strong><br>
                ‚Ä¢ Immediate savings: $${Math.floor(portfolioData.dayChange * 0.05).toLocaleString()}-${Math.floor(portfolioData.dayChange * 0.12).toLocaleString()}<br>
                ‚Ä¢ Long-term benefit: ${daysToYearEnd < 90 ? 'Execute by Dec 31 for current year benefit' : 'Plan for optimal timing throughout year'}`;
        }
        
        function generateGeneralInvestmentResponse(message) {
            return `ü§ñ <strong>Investment Intelligence Assistant</strong><br><br>
                I understand you're asking about: "${message}"<br><br>
                
                I'm here to help with comprehensive investment analysis using live market data. Here's what I can assist with:
                <br><br>
                
                <strong>üìä Portfolio Management:</strong><br>
                ‚Ä¢ Performance analysis and attribution<br>
                ‚Ä¢ Risk assessment and optimization<br>
                ‚Ä¢ Rebalancing strategies<br><br>
                
                <strong>üéØ Trading Intelligence:</strong><br>
                ‚Ä¢ Live arbitrage opportunity identification<br>
                ‚Ä¢ Market timing and entry/exit strategies<br>
                ‚Ä¢ Cross-exchange analysis<br><br>
                
                <strong>üõ°Ô∏è Risk Management:</strong><br>
                ‚Ä¢ Value-at-Risk calculations<br>
                ‚Ä¢ Correlation analysis<br>
                ‚Ä¢ Stress testing scenarios<br><br>
                
                <strong>üí∞ Tax & Planning:</strong><br>
                ‚Ä¢ Tax-loss harvesting optimization<br>
                ‚Ä¢ Asset allocation strategies<br>
                ‚Ä¢ Long-term wealth building<br><br>
                
                Try asking me something specific like:<br>
                ‚Ä¢ "What's my best arbitrage opportunity right now?"<br>
                ‚Ä¢ "Should I rebalance my portfolio this week?"<br>
                ‚Ä¢ "What's my current risk exposure?"<br>
                ‚Ä¢ "How can I optimize for tax efficiency?"`;
        }
        
        function quickInvestorQuery(queryType) {
            const queryMap = {
                'portfolio_performance': 'Analyze my portfolio performance in detail',
                'best_arbitrage': 'What are the best arbitrage opportunities right now?',
                'risk_assessment': 'Assess my current risk exposure and provide recommendations',
                'market_outlook': 'What is your market outlook for the next 24-48 hours?',
                'rebalancing': 'Should I rebalance my portfolio? Provide a detailed strategy',
                'tax_optimization': 'How can I optimize my portfolio for tax efficiency?'
            };
            
            const message = queryMap[queryType];
            if (message) {
                document.getElementById('investor-chat-input').value = message;
                sendInvestorMessage();
            }
        }
    </script>
</body>
</html>